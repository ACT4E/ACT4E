%%%%%%%%%%%%%%%%%%%%
% Abbreviations for prf
%
\newcommand{\prf}{\expandafter\prftree[r]{\raisebox{3pt}{}}}
\newcommand{\prfdouble}{\expandafter\prftree[double]}
\newcommand{\prfcomma}{\expandafter\prftree[r]{\raisebox{3pt}{,}}}
\newcommand{\prfperiod}{\expandafter\prftree[r]{\raisebox{3pt}{.}}}
\newcommand{\prfsemi}{\expandafter\prftree[r]{\raisebox{3pt}{;}}}
\newcommand{\prfdoublecomma}{\expandafter\prftree[double][r]{\raisebox{3pt}{,}}}
\newcommand{\prfdoubleperiod}{\expandafter\prftree[double][r]{\raisebox{3pt}{.}}}



\newcommand{\gear}[5]{%
\begin{tikzpicture}
\draw[ultra thick]
\foreach \i in {1,...,#1} {%
  [rotate=(\i-1)*360/#1]  (0:#2)  arc (0:#4:#2) {[rounded corners=1.5pt]
             -- (#4+#5:#3)  arc (#4+#5:360/#1-#5:#3)} --  (360/#1:#2)
};\end{tikzpicture}}

\newsavebox{\chaptergear}
\savebox{\chaptergear}{%
  \raisebox{-1pt}{\maxsizebox{2.8mm}{!}{\gear{12}{0.5}{0.4}{10}{2}}}\!\!
}


\newcommand{\sectionexercises}[1]{%
    \section{\texorpdfstring{\usebox{\chaptergear}}{Code exercises -} #1}
}

%\newcommand{\Fop}{^{\F{*}}\!\!\!}

\newcommand{\RposgenBel}{\R{\posgenBel}}
\newcommand{\FposgenAel}{\F{\posgenAel}}
\newcommand{\FposgenBel}{\F{\posgenBel}}
\newcommand{\FposgenAelop}{\F{\posgenAel^*}\!\!}
\newcommand{\FposgenBelop}{\F{\posgenBel^*}\!\!}
\newcommand{\FposgenCelop}{\F{\posgenCel^*}\!\!}

\newcommand{\lens}[6]{\begin{pmatrix} #1\\ #4\end{pmatrix}\colon \begin{pmatrix} #2\\ #5\end{pmatrix} \leftrightarrows \begin{pmatrix} #3\\ #6\end{pmatrix}}
\newcommand{\lensa}{\lens{\pbacka}{\setlensam}{\setlensbm}{\pforwa}{\setlensap}{\setlensbp}}
\newcommand{\lensb}{\lens{\pbackb}{\setlensbm}{\setlenscm}{\pforwb}{\setlensbp}{\setlenscp}}
\newcommand{\lenscd}{\lens{\pbackb}{\setlenscm}{\setlensdm}{\pforwb}{\setlenscp}{\setlensdp}}
\newcommand{\lensinterf}[2]{\begin{pmatrix}#1 \\ #2\end{pmatrix}}

\newcommand{\funcnameT}[1]{\funcnamestyle{#1()}\xspace}

\newcommand{\funcname}[1]{\funcnamestyle{\detokenize{#1}()}\xspace}
%:example: \funcname{funcname}
\newcommand{\fieldname}[1]{\fieldnamestyle{#1}\xspace} % Field
%:example: \fieldname{field}
\newcommand{\classname}[1]{\classnamestyle{#1}\xspace} %
%:example: \classname{Class}


\DeclareMathSymbol{\shortminus}{\mathbin}{AMSa}{"39}
\newcommand{\shortplus}{{{+}}} % TODO: need a short plus
\newcommand{\minusone}{{{\shortminus}}\kern1pt1}
\newcommand{\plusone}{\shortplus1}


\makeatletter
\DeclareRobustCommand{\shortto}{%
    \mathrel{\mathpalette\short@to\relax}%
}

\newcommand{\short@to}[2]{%
    \mkern2mu
    \clipbox{{.4\width} 0 0 0}{$\m@th#1\vphantom{+}{\shortrightarrow}$}%
}
\makeatother


\makeatletter



\newcommand{\opensetbracket}{{\ColorIfNowBlack{formulasetcolor}{\mathbf{\{}}}}
\newcommand{\closesetbracket}{{\ColorIfNowBlack{formulasetcolor}{\mathbf{\}}}}}

% \newcommand{\opensetbracket}{{\ColorIfNowBlack{formulasetcolor}{A}}}
% \newcommand{\closesetbracket}{{\ColorIfNowBlack{formulasetcolor}{B}}}


\newcommand{\cleft}[2][.]{%
    \begingroup\colorlet{savedleftcolor}{.}%
    \color{#1}\mathopen{}\left#2\color{savedleftcolor}%
}
\newcommand{\cright}[2][.]{%
    \color{#1}\right#2\mathclose{}\endgroup%
}



\DeclareRobustCommand{\@makelists}[4]{%
    #1%
    \foreach \entry [count=\xi]  in {#4}{
        \ifnum\xi = 1\else#2\linebreak[0]\fi%
        {{\entry}}%
    }%
    #3%
}
\newcommand{\smallspace}{\mspace{4mu}}
\newcommand{\commaspace}{{,\smallspace}}
\DeclareRobustCommand{\makeset}[1]{%
    \@makelists{\opensetbracket}{\commaspace}{\closesetbracket}{#1}%
}
\DeclareRobustCommand{\makesetnocolor}[1]{%
    \@makelists{\{}{\commaspace}{\}}{#1}%
}
\DeclareRobustCommand{\tupp}[1]{%
    \@makelists{\langle}{\commaspace}{\rangle}{#1}%
}

% \newcommand{\tup}[1]{\left\langle#1\right\rangle}
%:example: $\tup{\posA, \posAleq}$

\DeclareRobustCommand{\tup}[1]{%
        \@makelists{\mathopen{}\left\langle}{\commaspace}{\right\rangle\mathclose{}}{#1}%
}

\DeclareRobustCommand{\makecprod}[1]{%
    \@makelists{}{\cprod}{}{#1}%
}

\DeclareRobustCommand{\makecartprod}[1]{%
    \@makelists{}{\cartprod}{}{#1}%
}

\DeclareRobustCommand{\maketupconcat}[1]{%
    \@makelists{}{\tupconcat}{}{#1}%
}

\DeclareRobustCommand{\maketypedlist}[2]{%
    \makelist{#1}_{#2}%
}

\DeclareRobustCommand{\makesetBig}[1]{%
    \@makelists{{\mathopen{}\color{formulasetcolor}\mathbf{\Big\{}}}{\commaspace}{{\color{formulasetcolor}\mathbf{\Big\}}\mathclose{}}}{#1}%
}

\DeclareRobustCommand{\makesett}[1]{%
    \@makelists{\cleft[formulasetcolor]{\{}}{\commaspace}{\cright[formulasetcolor]{\}}}{#1}%
}

\DeclareRobustCommand{\makelist}[1]{%
    \@makelists{[}{\commaspace}{]}{#1}%
}

\DeclareRobustCommand{\cObj}[1]{%
    \@makelists{\fatstart}{\commaspace}{\fatend}{#1}%
}

% \newcommand{\tuplefunaword{Tuple}}
\makeatother

\newcommand{\elprime}{\styleelements{'}}


\newcommand{\currydish}{\text{curry}}
\newcommand{\casserole}{\text{casserole}}
\newcommand{\beef}{\text{beef}}
\newcommand{\chicken}{\text{chicken}}

\newcommand{\alphubel}{\textcolor{violet}{ALPHUBEL}}
\newcommand{\bernina}{\textcolor{blue}{BERNINA}}
\newcommand{\someday}{\textcolor{black}{SOMEDAY}}
\DeclarePairedDelimiter\mypars{\lparen}{\rparen}
\newcommand{\pars}[1]{\mypars*{#1}}
\newcommand{\parsL}[1]{\Big(#1\Big)}
\newcommand{\parslight}[1]{\cleft[lightgray]{(}#1\cright[lightgray]{)}}


\edef\BlackColor{\csname\string\color@.\endcsname}

\makeatletter
\newcommand{\@CurrentColor}{}% Make sure we are not using an existing macro
\DeclareRobustCommand{\ColorIfNowBlack}[2]{%
    \edef\@CurrentColor{\csname\string\color@.\endcsname}% Get current color
    \IfStrEq{\@CurrentColor}{\BlackColor}{%
        {\color{#1}#2}% current color IS black
    }{%
        #2% current color is NOT black
    }%
}
\makeatother

% \newcommand{\raisebigsymbol}[1]{\raisebox{0.08em}{#1}} % used to raise x or + for use with capital letters
\newcommand{\raisebigsymbol}[1]{#1} % used to
% \newcommand{\boldplus}{\mathbin{\raisebigsymbol{\textbf{+}}}}
% \newcommand{\boldtimes}{\mathbin{\raisebigsymbol{\textbf{×}}}}
% \newcommand{\raisedtextplus}{\mathbin{\raisebigsymbol{+}}}
% \newcommand{\raisedtexttimes}{\mathbin{\raisebigsymbol{×}}}
\newcommand{\boldplus}{\mathbin{\textbf{+}}}
\newcommand{\boldtimes}{\mathbin{\textbf{×}}}
\newcommand{\raisedtextplus}{\mathbin{\textbf{+}}}
\newcommand{\raisedtexttimes}{\mathbin{\textbf{×}}}
\newcommand{\rrangleSAFE}{\texorpdfstring{\rrangle}{<<}}
\newcommand{\llangleSAFE}{\texorpdfstring{\llangle}{>>}}
