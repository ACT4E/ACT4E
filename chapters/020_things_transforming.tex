% !TEX root = ../ACT4E-full.tex


\section{Interfaces and transformations}


\todo[inline]{Gives more examples before getting to the definition. Give more examples
with different conventions for the arrow direction.}

In engineering design, one creates \emph{systems} out of \emph{components}. Each component has a reason to be in there. We will show how category theory can help in formalizing the chains of causality that underlie a certain design.

We will need to reason at the level of abstraction where we consider the ``function'', or ``functionality'', which each component provides, and the ``requirements'' that are needed to provide the function.

We will start with a simple example of the functioning principle of an electric car.

In an electric car, there is a battery, a store of the electric energy resource. We can see the production of motion as the chain of two transformations:

\begin{itemize}
    \item The \motor transmutes the \electricpower into \rotationalmotion.
    \item The \rotationalmotion is converted into \translationalmotion by the \wheels and their friction with the road.
\end{itemize}

We see that there are two types of things in this example:
\begin{enumerate}
    \item The ``transmuters'': the \motor and \wheels.
    \item The ``transmuted'': the \electricpower, the \rotationalmotion, the \translationalmotion.
\end{enumerate}

For a first qualitative description of the scenario, we might choose to just keep track of what is transmuted into what. We can draw a diagram in which each resource is a point (\cref{fig:e1}).

\begin{figure}[h!]
    \centering
    \includesag{30_dpcatfig_e1}
    \caption{Resources in the electric car example. \label{fig:e1} }
\end{figure}



Now, we can draw arrows between two points if there is a transmuter between them.

We choose the direction of the arrow such that
\begin{equation}
    \label{eq:arrow1}
    \transmuted{X} \stackrel{\transmuter{transmuter}}{\longrightarrow} \transmuted{Y}
\end{equation}
means that ``using \textsf{transmuter}, having $\transmuted{Y}$ is sufficient to produce $\transmuted{X}$''.

\begin{remark}[Are we going the wrong direction?]
    The chosen direction
    for the arrows is completely the opposite of what you would expect if you thought about
    ``input and outputs''. There is a good reason to use this convention, though it will
    be apparent only a few chapters later. In the meantime, it is a good exercise
    to liberate your mind about the preconception of what an arrow means; in category theory
    there will be categories where the arrows represent much more abstract concepts than input/output.
\end{remark}

Another way to write \cref{eq:arrow1} would be as follows:
\begin{equation}
    \transmuter{transmuter} \colon \transmuted{X} \to \transmuted{Y}.
\end{equation}
This is now to you something syntactically familiar; when we study the categories of sets and functions between sets we will see that in that context the familiar meaning is also the correct meaning.

With these conventions, we can describe the two transmuters as these arrows:
%
\begin{align}
    \motor&:  \rotationalmotion \rightarrow \electricpower, \\
    \wheels&: \translationalmotion \rightarrow \rotationalmotion.
\end{align}
%
We can put these arrows in the diagrams, and obtain
the following (\cref{fig:e2}).
% In this simple setting, we can identify the key systems and subsystems: car, engine, axle, wheels, and road.

% \AC{we don't refer to these subsystems later}


% We can identify the functionality/resources of interest as:~\textsf{electric} \textsf{power}, \textsf{rotational} \textsf{motion}, and~\textsf{translational} \textsf{motion}. Note that each of these quantities plays a dual role. For example, the \textsf{rotational motion} is something which is produced by the motor, so it is a functionality for the motor, while it is a resource for axle/wheels, because they need it to provide~$\mathsf{translational}\ \mathsf{motion}$.


% Furthermore, we can draw an arrow between two resources if we can obtain one from the other. In the example, we have described how \textsf{electric power} becomes \textsf{rotational motion}, described by the \textsf{engine} arrow, and how \textsf{rotational motion} becomes \textsf{translational motion}, described by the \textsf{wheel} arrow (\cref{fig:e2}).

\begin{figure}[h!]
    \centering
    \includesag{30_dpcatfig_e2}
    \caption{Transmuters are arrows between resources. \label{fig:e2}}
\end{figure}

In this representation, the arrows are the components of the system.
We will learn how to compose these arrows according to the rules of category theory.
The basic rule will be \emph{composition}.
If we use the semantics that an arrow from resource~$X$ to resource~$Y$ means ``having~$Y$ is
enough to obtain~$X$'', then, since~$Y$ is enough for~$Y$ per definition, we can add a self-loop for each
resource. We will call the self-loops \emph{identities} (\cref{fig:e3}).

\begin{figure}[h!]
    \centering
    \includesag{30_dpcatfig_e3}
    \caption{System components and identities. \label{fig:e3}}
\end{figure}

Furthermore, we might consider the idea of composition of arrows.
Suppose that we know that
\begin{equation*}
    \transmuted{X} \stackrel{\transmuter{a}}{\longrightarrow} \transmuted{Y}
    \qquad \text{and} \qquad
    \transmuted{Y} \stackrel{\transmuter{b}}{\longrightarrow} \transmuted{Z},
\end{equation*}
that is, using a $b$ we can get a $\transmuted{Y}$ from a $\transmuted{Z}$, and using an $\transmuter{a}$ we can get a $\transmuted{X}$ from a $\transmuted{Y}$,
then we conclude that using and $\transmuter{a}$ and a $\transmuter{b}$ we can get an $\transmuted{X}$ from a $\transmuted{Z}$.

In our example, if the arrows \wheels  and \motor exist, then also the arrow ``\wheels then \motor'' exists~(\cref{fig:e4}).

\begin{figure}[h!]
    \centering
    \includesag{30_dpcatfig_e4}
    \caption{Composition of system components. \label{fig:e4}}
\end{figure}

So far, we have drawn only one arrow between two points, but we can draw as many as we want.
If we want to distinguish between different brands of motors, we would just draw
one arrow for each model. For example,~\cref{fig:e4bis} shows two models of
motors (\transmuter{motor A}, and \transmuter{motor B}) and two models of wheels
(\transmuter{wheels U} and \transmuter{wheels V}).


\begin{figure}[h!]
    \centering
    \includesag{20_wheel_motor_options}
    \caption{Multiple models for wheels and motors. \label{fig:e4bis}}
\end{figure}

The figure implies now the existence of \emph{four} composed
arrows: ``\transmuter{wheels U} then \transmuter{motor A}'',
``\transmuter{wheels U} then \transmuter{motor B}'',
``\transmuter{wheels V} then \transmuter{motor A}'', and
``\transmuter{wheels V} then \transmuter{motor B}'', all going from \translationalmotion to \electricpower;


A ``category`` is an abstract mathematical structure that captures the properties
of these systems of points and arrows and the logic of composition.

The basic terminology is that the points are called \textbf{objects},
and the arrows are called \textbf{morphisms}.

In our example, the \motor and the \wheels are the morphisms, and \electricpower, \rotationalmotion,
\translationalmotion are the objects.

Many things can be defined as categories and we will see many examples in this book.

We are now just biding our time before introducing the formal definition of category.
At first sight it will be intimidating: there are four parts to the definition, two axioms to define.
Moreover, it is quite a bit technical and it takes half a page to write.


\section{Formal definition of category}

The following is the formal definition.

\let\oldmora\mora
\renewcommand{\mora}{{\colTransmuter \oldmora}}
\let\oldmorb\morb
\renewcommand{\morb}{{\colTransmuter \oldmorb}}
\let\oldmorc\morc
\renewcommand{\morc}{{\colTransmuter \oldmorc}}
\let\oldObja\Obja
\renewcommand{\Obja}{{\colTransmuted \oldObja}}
\let\oldObjb\Objb
\renewcommand{\Objb}{{\colTransmuted \oldObjb}}
\let\oldObjc\Objc
\renewcommand{\Objc}{{\colTransmuted \oldObjc}}
\let\oldObjd\Objd
\renewcommand{\Objd}{{\colTransmuted \oldObjd}}

\let\oldOb\Ob
\renewcommand{\Ob}{{\colTransmuted \oldOb}}

\let\oldHom\Hom
\renewcommand{\Hom}{{\colTransmuter \oldHom}}


\begin{ctdefinition}[Category]
    \label{def:categorymain}
    A \emph{\iindex{category}}~\CatC is specified by four components:
%vthe
%category's \emph{objects}, the category's \emph{morphisms},
%the \emph{identities} and the \emph{composition operations}. More precisely,
%a category consists of:
    \begin{compactenum}
        \item \textbf{Objects}: a collection\footnotemark~$\ObC$, whose elements are called \emph{objects}.
        \item \textbf{Morphisms}: for every pair of objects~$\Obja,\Objb\in \ObC$, there is a set~${ \HomC}({\Obja,\Objb})$, elements of which are called
        \emph{morphisms} from~$\Obja$ to~$ \Objb$. The set is called the ``hom-set from $\Obja$ to $\Objb$''.
        \item \textbf{Identity morphisms}: for each object~$ \Obja$, there is
        an element~$\id_{\Obja} \in \HomC({\Obja,\Obja}) $ which is called \emph{the identity
        morphism of~$\Obja$}.
        \item \textbf{Composition rules}: given any morphism~$ { \mora} \in  \HomC(\Obja,\Objb)$ and any morphism~${ \morb} \in \HomC(\Objb, \Objc)$, there exists a morphism~$\mora \then \morb$ in $\HomC(\Obja,\Objc)$ which is the \emph{composition of~$ \mora$ and~$ \morb$}.
    \end{compactenum}

    Furthermore, the constituents are required to satisfy the following conditions:
    \begin{compactenum}
        \item \emph{Unitality}: for any \iindex{morphism}~$\mora\in\HomC(\Obja,\Objb)$,
        \begin{equation}
            \id_\Obja \then \mora= \mora = \mora \then \id_\Objb.
        \end{equation}
        \item \emph{Associativity}: for~$\mora\in \HomC(\Obja,\Objb)$,~$\morb\in \HomC(\Objb,\Objc)$, and~$\morc\in \HomC(\Objc,\Objd)$,
        \begin{equation}
        (\mora\then \morb)
            \then \morc= \mora \then (\morb \then \morc).
        \end{equation}
    \end{compactenum}
\end{ctdefinition}
\footnotetext{A ``collection'' is something which may be thought of as a set, but may be ``too large" to technically be a set in the formal sense. This distinction is necessary in order to avoid such issues as Russel's paradox.}


% \begin{remark}
% The set of morphisms~$\CatC(X,Y)$ is sometimes denoted $\HomC(X,Y)$ and called the ``hom-set from $X$ to $Y$''. The ``Hom'' comes from the word ``homomorphism''.
% \end{remark}

\begin{remark}[Are we sure we are not going in the wrong direction?]
    We denote composition of morphisms in a somewhat unusual way--sometimes preferred by category-theorists and computer scientists--namely in \emph{diagrammatic order}.

    That is, given~$\mora \colon \Obja\to \Objb$ and~$\morb \colon \Objb \to \Objc$, we denote their composite by~$(\mora\then \morb)\colon \Obja\to \Objc$, pronounced ``$\mora$ then~$\morb$''. This is in contrast to the more typical notation for composition, namely~$\morb\after \mora$, or simply~$\morb \mora$, which reads as ``$\morb$ after~$\mora$''. The notation~$\mora \then \morb$ is sometimes called \emph{infix notation}.

    We promise, at some point it will be clear what are the advantages of seemingly doing everything
    in the wrong direction.
\end{remark}

Note that we may save some ink when drawing diagrams of morphisms:
\begin{compactitem}
    \item We do not need to draw the identity arrows from one object to itself, because, by \cref{def:categorymain}, they always exist.
%However, we will see how there might be multiple such loops.
    \item  Given arrows~$\Obja \to \Objb$ and~$\Objb \to \Objc$, we do not need to draw their composition because, by \cref{def:categorymain}, this composition is guaranteed to exist.
\end{compactitem}

With these conventions, we can just draw the arrows \motor and \wheels in the diagram, and the rest of the diagram is implied (\cref{fig:e5}).

\begin{figure}[h!]
    \centering
    \includesag{30_dpcatfig_e5}
    \caption{Electric car example. The grey arrows are implied by the properties
    of a category.\label{fig:e5}}
\end{figure}

In particular, the electric car example corresponds to the category~\CatC specified by
\begin{compactitem}
    \item \emph{Objects:} $\ObC=\{\electricpower,\rotationalmotion,\translationalmotion\}$.
    \item \emph{Morphisms}: The system components are the morphisms. For instance, we have \motor, \wheels, and the morphism $\wheels \then \motor$, implied by the properties of the category.
\end{compactitem}

We can slightly expand this example by noting the reverse transformations. In an electric car
it is possible to regenerate power; that is, we can obtain \rotationalmotion of the \wheels from
\translationalmotion (via the morphism \move), and then convert the \rotationalmotion into \electricpower (via the morphism \dynamo)~(\cref{fig:e6},~\cref{fig:e6-together}).

\begin{figure}[h!]
    \centering
    \includesag{30_dpcatfig_e6}
    \caption{Electric power can be produced from motion. \label{fig:e6}}
\end{figure}

\begin{figure}[h!]
    \centering
    \includesag{30_dpcatfig_e7}
    \caption{Electric car example: forward and backward transformations.\label{fig:e6-together}}
\end{figure}
Given the semantics of the arrows in a category, all compositions of arrows exist, even if they are not drawn
explicitly. For example, we can consider the composition~$\wheels \then \motor \then \dynamo \then \move$, which
converts \translationalmotion into \rotationalmotion, into \electricpower, then back to
\rotationalmotion and \translationalmotion. Note that this is an arrow that has the same head and tail as the identity arrow on \translationalmotion~(\cref{fig:e8}). However, these two arrows are not necessarily the same. In this example we are representing physical systems, so we would in fact not expect them to be the same, since there will be some losses during the many conversions.

\begin{figure}[h!]
    \centering
    \includesag{30_dpcatfig_e8}
    \caption{There can be multiple morphisms from an object to itself.\label{fig:e8}}
\end{figure}

The directionality of the arrows is also important. While the convention of
which resource is the tail and which the head is just a typographic convention,
it might be the case that we know how to convert one resource into another, but
not vice versa. \cref{fig:e10} shows an example of a diagram that describes a process which is definitely
not invertible.

\begin{figure}[h!]
    \centering
    \includesag{30_dpcatfig_e10}
    \caption{An example of a process which is not invertible. \label{fig:e10}}
\end{figure}


\section{Currency categories}
\label{sec:currency_cat}
In this section, we introduce a kind of category for describing currency exchangers. Our idea is to model currencies as objects of a category, and morphisms will describe ways of exchanging between those currencies, \text{e.g.}, as offered by a currency exchange service.

We start with a set~\CatC of labels for all the currencies we wish to consider, \text{i.e.}:
\begin{equation*}
    \CatC = \{ \EUR, \USD, \CHF, \SGD, ... \}.
\end{equation*}
For each currency~$\transmuted{c} \in \CatC$ we define an object~$\reals \times \{\transmuted{c}\}$ which represents possible amounts of the given currency~$\transmuted{c}$ (we will ignore the issue of rounding currencies to an accuracy of two decimals places, and we allow negative amounts). The currency label keeps track of which ``units'' we are using.

Now consider two such objects, say~$\reals \times \{\USD\}$ and~$\reals \times \{\EUR\}$. How can we describe the process of changing an amount of USD to an amount of EUR? We model this using two numbers: an exchange rate~$a$ and a commission~$b$ for the transaction. Given an amount~$x \in \reals$ of USD, we define a morphism (a currency exchanger) as:
\begin{equation*}
    E_{a,b} \colon \reals \times \{\USD\} \rightarrow \reals \times \{\EUR\},
\end{equation*}
by the formula
\begin{equation*}
    \tup{x, \USD} \longmapsto \tup{ax - b, \EUR}.
\end{equation*}
Note that that the commission is given in the units of the target currency. Of course, for changing USD to EUR, there may be various different banks or agencies which each offer different exchange rates and/or different commissions. Each of these corresponds to a different morphism from~$\reals \times \{\USD\}$ to~$\reals \times \{\EUR\}$.

To build our category, we also need to specify how currency exchangers compose. Given currencies~$\mathsf{c_1}, \mathsf{c_2}, \mathsf{c_3}$, and given currency exchangers
\begin{equation*}
    E_{a,b} \colon \reals \times \{\mathsf{c_1} \} \rightarrow \reals \times \{ \mathsf{c_2}\}
    \qquad \text{and} \qquad
    E_{a',b'} \colon \reals \times \{\mathsf{c_2}\} \rightarrow \reals \times \{\mathsf{c_3}\}
\end{equation*}
we define the composition~$E_{a,b} \then E_{a',b'}$ to be the currency exchanger
\begin{equation}
    \label{eq:comp-law-curr}
    E_{aa',a'b + b'} \colon \reals \times \{\mathsf{c_1}\} \rightarrow \reals \times \{\mathsf{c_3}\}.
\end{equation}
In other words, we compose currency exchangers as one would expect: we multiply the first and the second exchange rates together, and we add the commissions (paying attention to first transform the first commission into the units of the final target currency).

Finally, we also need to specify unit morphisms for our category. These are currency exchangers which ``do nothing''. For any object~$\reals \times \{ \mathsf{c}\}$, its identity morphism is
\begin{equation*}
    E_{1,0} \colon \reals \times \{\mathsf{c}\} \rightarrow \reals \times \{\mathsf{c}\},
\end{equation*}
the currency exchanger with exchange rate ``1'' and commission ``0''.

It is a straightforward to check that the composition of currency exchangers as defined above obeys the associative law, and that the identity morphisms act neutrally for composition. Thus we indeed have a category!

\begin{remark}
    In the above specification of our category of currency exchangers, we can actually just work with the set of currency labels~$\mathsf{C}$ as our objects, instead of using ``amounts'' of the form~$\reals \times \{\mathsf{c}\}$ as our objects. Indeed, on a mathematical level, the definition of currency exchangers and their composition law \cref{eq:comp-law-curr} do not depend on using amounts! Namely, a currency exchanger~$E_{a,b}$ is specified by the pair of numbers~$\tup{a, b}$, and the composition law (\ref{comp law curr}) may then, in this notation, be written as
    \begin{equation}
        \begin{aligned}
            \label{eq:currencycomp}
            \tup{a,b}\then \tupp{a',b'}&=\tupp{a' a, a' b + b'}.
        \end{aligned}
    \end{equation}
    The interpretation is still that currency exchangers change amounts of one currency to amounts in an another currency, but for this we do not need to carry around copies of~$\reals$ in our notation.
\end{remark}

Following the above remark:

\begin{definition}[Category \Curr]
    The \emph{category of currencies} \Curr is specified by:
    \begin{enumerate}
        \item \emph{Objects:} a collection of currencies \transmuted{C}.
        \item \emph{Morphisms:} given two currencies~$\transmuted{c}_1, \transmuted{c}_2\in \transmuted{C}$, morphisms between them are currency exchangers~$\tup{a,b}$ from~$\transmuted{c}_1$ to~$\transmuted{c}_2$.
        \item \emph{Identity morphism:} given an object~$\transmuted{c} \in \transmuted{C}$, its identity morphism is the currency exchanger~$\tup{1,0}$. We also call such morphisms ``trivial currency exchangers''.
        \item \emph{Composition of morphisms:} the composition of morphisms is given by the formula \cref{eq:currencycomp}.
    \end{enumerate}
\end{definition}



As an illustration, consider three currency exchange companies \transmuter{ExchATM}, \transmuter{MoneyLah}, and \transmuter{Frankurrencies}, which operate on several currencies (\cref{tab:currencycompanies}).

\begin{table}[h]
    \centering
    \begin{adjustbox}{max width=\textwidth}
        \begin{tabular}{c|c|c|c|c}
            Company name                & Exchanger label & Direction    & $a$ (exchange rate)       & $b$   (fixed commission) \\
            \hline
            \transmuter{ExchATM}        & $A$             & \USD to \CHF & \unitfrac[0.95]{CHF}{USD} & \unit[2.0]{CHF}       \\
            \transmuter{ExchATM}        & $B$             & \CHF to \USD & \unitfrac[1.05]{USD}{CHF} & \unit[1.5]{USD}       \\
            \transmuter{ExchATM}        & $C$             & \USD to \SGD & \unitfrac[1.40]{SGD}{USD} & \unit[1.0]{SGD}       \\
            \transmuter{MoneyLah}       & $D$             & \USD to \CHF & \unitfrac[1.00]{CHF}{USD} & \unit[1.0]{CHF}       \\
            \transmuter{MoneyLah}       & $E$             & \SGD to \USD & \unitfrac[0.72]{USD}{SGD} & \unit[3.0]{USD}       \\
            \transmuter{Frankurrencies} & $F$             & \EUR to \CHF & \unitfrac[1.20]{CHF}{EUR} & \unit[0.0]{CHF}       \\
            \transmuter{Frankurrencies} & $G$             & \CHF to \EUR & \unitfrac[1.00]{EUR}{CHF} & \unit[1.0]{EUR}
        \end{tabular}
    \end{adjustbox}
    \caption{Three currency exchange companies operating different currencies.
    }
    \label{tab:currencycompanies}
\end{table}
We can represent this information as a graph, where the nodes are the currencies and the edges are particular exchange operations (\cref{fig:currencygraph}).

\begin{figure}[h]
    \begin{center}
        \includesag{30_currencygraph}
    \end{center}
    \caption{Three currency exchange companies operating different currencies as a graph. \label{fig:currencygraph}}
\end{figure}

There is a currency category built from the information in \cref{tab:currencycompanies} and the graph in \cref{fig:currencygraph}. Its collection of objects is the set $\{  \EUR, \USD, \CHF, \SGD \}$, and it morphisms are, in total:
\begin{itemize}
    \item the trivial currency exchanger (identity morphism)~$\tup{1,0}$ for each of the four currencies (which are the objects),
    \item the currency exchangers corresponding to each item in \cref{tab:currencycompanies},
    \item all possible compositions of the currency exchangers listed in \cref{tab:currencycompanies}.
\end{itemize}

The phrase ``all possible compositions'' is a bit vague. What we mean here can be made more precise. It corresponds to a general recipe for starting with a graph~$G$, such as in \cref{fig:currencygraph}, and obtaining from it an associated category, called the \emph{free category on}~$G$. We introduce this concept in the next section.


\begin{exercise}[Temperatures]
    Define a category of temperature converters, where the objects are
    \transmuted{Celsius}, \transmuted{Kelvin}, \transmuted{Fahrenheit}, and the
    morphisms are the rules to transform a measurement from one unit to another.

    What relation is there with the currency category?

\end{exercise}


%The graph representation seems enough to describe this as a category, where the objects are the currencies (USD,CHF,EUR, and SGD), the morphisms are the different exchange operations, and the identity morphisms are identity currency exchangers. However, to properly define this category, we need to define composition and prove that the category is closed with respect to it, i.e. that the composition of two currency exchangers is a currency exchanger in the category. Given three currencies $\mathsf{X,Y,Z}$, a currency exchanger $\tup{a,b}$ from $\mathsf{X}$ to $\mathsf{Y}$, and a currency exchanger $\tup{c,d}$ from $\mathsf{Y}$ to $\mathsf{Z}$, one can define their composition as
%\begin{equation}
%\begin{aligned}
%\label{eq:currencycomp}
%    \tup{a,b}\then \tup{c,d}&=\tup{c\cdot a,c\cdot b+d}
%\end{aligned}
%\end{equation}
%Note that the result of the composition of currency exchangers is a currency exchanger: Thus, currency exchangers are closed under the composition operation we have defined. Finally, we need to check \emph{unitality} and \emph{associativity} for composition. Given a currency exchanger $\tup{a,b}$ from $\mathsf{X}$ to $\mathsf{Y}$ one has
%\begin{equation}
%    \begin{aligned}
%    \tup{1,0}\then \tup{a,b}&=\tup{a,b}\then \tup{1,0}\\
%    &=\tup{a,b},
%    \end{aligned}
%\end{equation}
%which is unitality. Furthermore, given a currency exchanger $\tup{c,d}$ from $\mathsf{Y}$ to $\mathsf{Z}$ and a currency exchanger $\tup{e,f}$ from $\mathsf{Z}$ to $\mathsf{W}$, one has
%\begin{equation}
%    \begin{aligned}
%    (\tup{a,b}\then \tup{c,d})\then \tup{e,f}&=\tup{a,b}\then( \tup{c,d}\then \tup{e,f})\\
%    &=\tup{eca, ecb+ed+f},
%    \end{aligned}
%\end{equation}
%which is associativity.
%We are now ready to properly define the category of currency exchangers $\mathbf{Curr}$.
%
%\begin{definition}[Category of currencies]
%    The \emph{category of currencies} $\mathbf{Curr}$ is specified by:
%    \begin{compactenum}
%        \item \emph{Objects:} $\Ob_\mathbf{Curr}$ is a collection of currencies.
%        \item \emph{Morphisms:} Given two currencies $\mathsf{C},\mathsf{D}\in \Ob_{\mathbf{Curr}}$, morphisms between them are currency exchangers $\tup{a,b}$ from $\mathsf{C}$ to $\mathsf{D}$.
%        \item \emph{Identity morphism:} Given an object $C\in \Ob_\mathbf{Curr}$, the identity morphism is given by the currency exchanger $\tup{1,0}$.
%        \item \emph{Composition of morphisms:} The composition of morphisms is given by composition of currency exchangers.
%    \end{compactenum}
%\end{definition}


% \JL{The following paragraph(s) might be best moved to a later part in the text, once pareto fronts and optimization have been discussed a little bit.}


\section{Definitional impetus vs. computational goals  }

The category \Curr represents the set of all possible currency exchangers that could ever exist. However, in this set there would be very irrational agents.
For example, there is a currency exchanger that, given 1 \USD, will give you back 2 \USD; there is one currency exchanger that corresponds to converting \USD to \CHF back and forth 21 times before getting you the money. There is even one that will not give you back any money.

Moreover, using the composition operations we could produce many more morphisms. In fact, if there are loops, we could traverse the loops multiple times, and, depending on the numbers, finding new morphisms, possibly infinitely many more.

This highlights a recurring topic: often mathematicians will be happy to define a broader category of objects, while, in practice, the engineer will find herself thinking about a more constrained set of objects.
In particular, while the mathematician is more concerned with defining categories as hypothetical universes of things, the engineer is typically interested in representing concrete things, and solve some computational problem on the represented structure.

For example, in the case of the currency exchangers, the problem might be that of finding the sequence of the best conversions between a source and a target currency.

First, the engineer would add more constraints to the definition to work with more well-behaved objects. For example, it is reasonable to limit the universe of morphisms in such a way that the action of converting back and forth the same currency to have a cost (through the commission) higher than 0.

% one would like to find the best conversions. These can be expressed as \emph{Pareto fronts}. To do so, one only needs to iterate a finite number of times, since the optimal path (conversion morphism), if such a morphism exists, will never pass through the same currency more than once. \JL{the previous sentence needs explaining}
In that case, we will find that the optimal paths of currencies never pass through a currency more than once. To see this, consider three currencies~$\transmuted{A},\transmuted{B},\transmuted{C}$, a currency exchanger~$\tup{a,b}$ from~$\transmuted{A}$ to~$\transmuted{B}$ , a currency exchanger~$\tup{c,d}$ from~$\transmuted{B}$ to~$\transmuted{C}$ , and a currency exchanger~$\tup{e,f}$ from~$\transmuted{C}$ to~$\transmuted{A}$.
The composition of the currency exchangers reads:
\begin{equation*}
    \tupp{\underbrace{eca}_{g}, \underbrace{ecb+ed+f}_{h}}.
\end{equation*}
Assuming~$e=a^{-1}$ (i.e., an exchange rate direction is not more profitable than the other), and~$h\neq 0$, because of the commissions one can show that there are multiple morphisms from~$\transmuted{A}$ to~$\transmuted{A}$, and that the identity morphism is the most ``convenient'' one.
If we only pass through each currency at most once, there are only a finite amount of paths to check, and this might simplify the computational problem.

Second, the engineer might be interested in keeping track only of the ``dominant'' currency exchangers.
For example, if we have two exchangers with the same rate but different commission, we might want to keep track only of the one with the lowest commission.

In the next chapters we will see that there are concepts that will be useful to model these situations:
\begin{itemize}
    \item There is a concept of \emph{subcategory} that allows to define more specific
    categories of a parent one, in a way that still satifies the axioms.
    \item There is a concept called \emph{locally posetal} categories, in which the
    set of morphisms between two objects is assumed to be a \emph{poset} rather than a \emph{set},
    that is, we assume that there is an order, and that this order will be compatible with the operation of composition.
\end{itemize}


\section{Things that don't matter}

In engineering we know that \textbf{using the right conventions is essential}.

There are many famous examples of unit mismatches causing disasters or near-disasters:
\begin{itemize}
    \item The loss of the Mars Climate Orbiter in 1999 was due to the fact that NASA used the metric system,
    while contractor Lockheed Martin used (by mistake) imperial units.
    \item In 1983, an Air Canadaâ€™s Boeing 767 jet ran out of fuel in mid-flight because
    there was a miscalculation of the fuel needed for the trip. In the end, the pilot managed to succesfully land the ``Gimli Glider''.
    \item
    Going back in history, Columbus wound up in the Bahamas because he miscalculated
    the Earth's circumference, due to several mistakes, and one of them was assuming
    that his sources were using the \emph{Roman mile} rather than the \emph{Arabic mile}.\footnote{
        \href{https://spectrum.ieee.org/tech-talk/at-work/test-and-measurement/columbuss-geographical-miscalculations}{IEEE Spectrum}
    }
    Columbus' mathematical mistakes led to a happy incident for him, but not so great outcomes for many others.
\end{itemize}

However, in category theory, we look at the ``essence'' of things, and we consider \textbf{what is true regardless of conventions}.

Just like this book is written in rather plain English, and could be translated to another language while preserving the meaning, in category theory we look at what is not changed by a 1:1 translation that can be reversed.

This will be covered later in a section on ``isomorphisms''; but for now we can look at this in an intuitive way.

\subsubsection{Typographical conventions don't matter}

Some of you might have objected to the conventions that we used in this chapter for the notation for composition of morphisms. We have used the notation $\mora \then \morb$ (``$\mora$ then~$\morb$'') while usually in the rest of mathematics we would have used $\morb \after \mora$ (``$\morb$ after $\mora$''). However, any concept we will use is ``invariant'' to the choice of notation. We can decide to rewrite the book using the other convention and still all the theorems would remain true, and all the falsities will remain false. More technically, we can take any formula written in one convention and rewrite it with the other convention, and viceversa. For example, the formula
%
\begin{equation*}
(\mora \then \morb)
    \then \morc = \mora \then (\morb \then \morc)
\end{equation*}
%
would be transformed in
%
\begin{equation*}
    \morc \after (\morb \after \mora) = (\morc \after \morb) \after \mora.
\end{equation*}
%
(A bit more advanced category theory can describe this transformation more precisely.)

The same considerations apply for the convention regarding the arrow directions.
If we have a category with morphisms such as
\begin{equation*}
    \motor \colon \rotationalmotion \to \electricpower
\end{equation*}
with the semantics of ``the \motor can produce \rotationalmotion given \electricpower'', we could define a \emph{different} category, where the conventions are inverted.
In this other category, for which we use arrows of different color, we would write
\begin{equation*}
{\color{blue}\motor}
    \colon \electricpower {\color{blue} \to}\  \rotationalmotion
\end{equation*}
and the semantics would be ``the \motor consumes \electricpower to produce \rotationalmotion'' (\cref{fig:inverted}).


\begin{figure}[h!]
    \centering
    \includesag{30_arrow_convention_power_a}\\[+15pt]
    \includesag{30_arrow_convention_power_b}
    \caption{Opposite convention for arrows direction. \label{fig:inverted}}
\end{figure}


These two categories would have the same objects, and the same number of arrows; it's just
that the arrows change direction when moving from one category to the other. In particular, there exists a transformation which maps every black arrow to a blue arrow, revertin the direction (\cref{fig:inverted_2}). This transformation is invertible.
Intuitively, we would not expect anything substantial to change, because we are
just changing a convention. We will see that there is a concept called \emph{opposite category}
that formalizes this idea of reversing the direction of the arrows.

\begin{figure}[h!]
    \begin{center}
        \includesag{020_inverted_2}
    \end{center}
    \caption{\label{fig:inverted_2}}
\end{figure}

\subsubsection{Diagrams conventions don't matter}

Now that we are flexed our isomorphism muscles, we can also talk about the isomorphisms
of the visual language.

In engineering, ``boxes and wires'' diagrams are commonly used to talk about
materials transformations and signal flows. In those diagrams one would use
boxes to describe the processes and the wires to describe the materials or information
that is being transformed. Boxes have ``inputs'' and ``outputs'', and arrows have
directions representing the causality. From left to right, what is to the left causes what is to the right.
The left-to-right directionality seems an utterly obvious choice for most of you
who learned languages that are written left-to-right, top-to-bottom as in this book\footnote{
    Note that this paragraph cannot be translated literally to Japanese. It breaks the assumption
    that we made before, about the fact that we can have a 1:1 literal translation of this book
    without changing the meaning. You might think that our future hypothetical Japanese
    translator can make an outstanding job and translate also our figures to go right-to-left,
    then saying that right-to-left is natural to people that write right-to-left. However,
    that does not work, because in fact Japanese engineers also use left-to-right diagrams.}.

\cref{fig:isodiagrams} shows how we would have visually described
the first example using the boxes-and-wires conventions.
Again, we say that this is just a different convention, because
we have a procedure to transform one diagram into the other.
This is not as simple as changing the direction of the arrows as in the case of an
opposite category. Rather, to go from points-and-arrows to boxes-and-wires:
\begin{itemize}
    \item Arrows that describe transmuters become boxes that describe processes;
    \item The points that describe the resources become wires between the boxes.
\end{itemize}


\begin{figure}[h!]
    \centering
    %\includegraphics[height=5cm]{chapters/sketch.jpg}\\
    \input{sag/20_iso_diags.tikz}
    \caption{Isomorphisms of resource diagrams. \label{fig:isodiagrams} }
\end{figure}


\todo[inline]{Expand example as in the slides}


\let\mora\oldmora
\let\morb\oldmorb
\let\morc\oldmorc

\let\Obja\oldObja
\let\Objb\oldObjb
\let\Objc\oldObjc
\let\Objd\oldObjd

\let\Ob\oldOb

\let\Hom\oldHom
