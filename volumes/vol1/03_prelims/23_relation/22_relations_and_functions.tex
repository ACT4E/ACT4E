% !TEX root = chapter-standalone.tex

\section{Relations and functions}
\linkvideo{spring2021-relations:relations:fun-rel} % Functions and relations


Every function between sets can be thought as a relation - this was the basis of our formal definition of function, \cref{def:function}.
Let us restate that definition once again here, using notation that we have developed since. 

\begin{definition}
    \label{def:functions_as_relations}
    Let~$\setA$ and~$\setB$ be sets. A \iindex{relation}~$\relA \subseteq \setA \cartprod \setB$ is a \emph{\iindex{function}} if it satisfies the following two conditions:
    \begin{enumerate}
        \item for all~$\ela \in \setA \quad \exists \ \elb \in \setB\colon  \inrel{\ela}{\relA}{\elb}$;
        \item for all~$\inrel{\ela_1}{\relA}{\elb_1}, \inrel{\ela_2}{\relA}{\elb_2}$ holds:
              \begin{equation*}
                  \prfperiod{\ela_1 = \ela_2}{\elb_1 = \elb_2}
              \end{equation*}
    \end{enumerate}
\end{definition}

To illustrate, let's consider the sets~$\setA = \{ \sbretzel, \sfondue, \schoco \}$ and~$\setB = \{ \stea, \smilk, \swater, \swine \}$, and the function~$\mapa \colon \setA \sto \setB$ defined by
\begin{equation}
    \mapa (\sbretzel) = \stea, \ \mapa (\sfondue) = \swater, \ \mapa(\schoco) = \swine.
\end{equation}
\begin{marginfigure}
    \centering
    \includesag{30_rel_4}
    \caption{Visualization of the function \cref{eq:fun-rel}.}
    \label{fig:example_fun_rel}
\end{marginfigure}
This can be depicted graphically as in \cref{fig:example_fun_rel} and can be written as the following relation
%
\begin{equation}
    \label{eq:fun-rel}
    \{ \tup{\sbretzel, \stea}, \tup{\sfondue, \swater}, \tup{\schoco, \swine} \} \subseteq \setA \cartprod \setB.
\end{equation}

\begin{marginfigure}
    \centering
    \includesag{30_rel_fun_graph}
    \caption{The graph of the function \cref{eq:fun-rel}.}
    \label{fig:example_fun_graph}
\end{marginfigure}

This relation \cref{eq:fun-rel} that we associated to the function~$\mapa$ may be thought of as its \emph{graph}.
That is, it is the set of tuples in~$\setA \cartprod \setB$ which are a pairing of an element of the source set~$\setA$ with the element which is its image under~$\mapa$.
In \cref{fig:example_fun_graph}, the graph of \cref{eq:fun-rel} is visualized by highlighting in color the elements of the graph.

Not every relation comes from a function in this way, however.
Indeed, part of the definition of the notion of a ``function'' is that it maps \emph{every} element of its source set to some element of its target.
And a function must map each element of it source to \emph{exactly one} element of its target (``multivalued functions'' are not functions in the strict sense).

For example, the relation in \cref{fig:example_rel} does not arise from a function.
Not every element of the source set is related to some element of the target:~$\schoco$ is not related to anything.
Nor is the relation ``single-valued'': the element~$\sfondue$ is related to two distinct elements of the target set.

\subsection{Composing functions}

You may now be wondering: if we define functions as special kinds of relations, how is relation composition related to the `usual' way of composing of functions?
The answer is that these two apparently different ways of composing functions are actually the same!

\begin{lemma}
    \label{lem:comprelfun}
    Let~$\relA \subseteq \setA \cartprod \setB$ and~$\relB \subseteq \setB \cartprod \setC$ be relations which are functions.
    Then their composition~$\relA \mthen \relB \subseteq \setA \cartprod \setC$ is again a function.
\end{lemma}

\begin{proof}
    We check that~$\relA \mthen \relB$ satisfies the two conditions stated in \cref{def:functions_as_relations}.

    \begin{enumerate}
        \item Choose an arbitrary~$\ela \in \setA$.
              We need to show that there exists~$\elc \in \setC$ such that~$\inrel{\ela}{\relA \mthen \relB}{\elc}$.
              Since~$\relA$ is a function, there exists~$\elb \in \setB$ such that~$\inrel{\ela}{\relA}{\elb}$.
              Choose such a~$\elb \in \setB$.
              Then, because~$\relB$ is a function, there exists~$\elc \in \setC$ such that~$\inrel{\elb}{\relB}{\elc}$.
              By the definition of composition of relations, we see that~$\elc$ is such that~$\inrel{\ela}{\relA \mthen \relB}{\elc}$.
        \item Let~$\inrel{\ela_1}{\relA \mthen \relB}{\elc_1}$,~$\inrel{\ela_2}{\relA \mthen \relB}{\elc_2}$.
              We need to show that if~$\ela_1 = \ela_2$, then~$\elc_1 = \elc_2$.
              So suppose~$\ela_1 = \ela_2$.
              Since~$\inrel{\ela_1}{\relA \mthen \relB}{\elc_1}$,~$\inrel{\ela_2}{\relA \mthen \relB}{\elc_2}$, there exist~$\elb_1, \elb_2 \in \setB$ such that, respectively,
              \begin{equation*}
                  \inrel{\ela_1}{\relA}{\elb_1} \booland \inrel{\elb_1}{\relB}{\elc_1},
              \end{equation*}
              \begin{equation*}
                  \inrel{\ela_2}{\relA}{\elb_2} \booland \inrel{\elb_2}{\relB}{\elc_2}.
              \end{equation*}
              Since~$\ela_1 = \ela_2$ and~$\relA$ is a function, we conclude that~$\elb_1 = \elb_2$ must hold.
              Now, since~$\relB$ is also a function, this implies that~$\elc_1 = \elc_2$, which is what was to be shown.
    \end{enumerate}
\end{proof}



\subsection{Relations via functions}

    \label{rem:rel-three-fun-descriptions}
    Though not every relation \emph{is} a function, we can however think about relations \emph{in terms of} functions.
    Here are three ways:
    \begin{enumerate}
        \item We can think of a relation~$\relA \colon \setA \mto\setB$ as a function~$\setA \cartprod \setB \sto \{ \false, \true \}$, where we think of ``$\false$'' as ``false'' and ``$\true$'' as ``true''.

              Given~$\relA$, we can define a function~$\phi_{\relA} \colon \setA \cartprod \setB \sto \{ \false, \true \}$ from it by setting
              \begin{equation}
                  \phi_{\relA}(\tup{\ela, \elb}) =
                  \left
                  \{\begin{array}{lr}
                      \true  & \text{if } \inrel{\ela}{\relA}{\elb} \\
                      \false & \text{otherwise.
                      }
                  \end{array}
                  \right.
              \end{equation}
              Conversely, given a function~$\phi\colon \setA \cartprod \setB \sto \{ \false, \true \}$ we can define a relation~$\relA_{\phi} \subseteq \setA \cartprod \setB$ from it by setting
              \begin{equation}
                  \relA_{\phi} = \{ \tup{\ela, \elb} \in \setA \cartprod \setB \mid \phi_{\relA}(\tup{\ela, \elb}) = \true \}.
              \end{equation}
              These two constructions are inverse to one-another.

        \item We can think of a relation~$\relA \colon \setA \mto \setB$ as a function~$\setA  \sto \powerset (\setB)$.

              Given~$\relA$, we can define a function~$\hat \phi_{\relA} \colon \setA \sto \powerset (\setB)$ via
              \begin{equation}
                  \hat \phi_{\relA} (\ela) = \{ \elb \in \setB \mid \inrel{\ela}{\relA}{\elb}\}.
              \end{equation}
              Conversely, given a function~$\hat \phi \colon \setA \sto \powerset (\setB)$, we can define
              \begin{equation}
                  \relA_{\hat \phi} = \{ \tup{\ela, \elb} \in \setA \cartprod \setB \mid \elb \in \hat \phi_{\relA}(\ela)   \}.
              \end{equation}
              These two constructions are inverse to one another, too.

        \item We can think of a relation~$\relA \subseteq \setA \cartprod \setB$ as a function~$\setB  \sto \powerset (\setA)$.

              Given~$\relA$, we can define a function~$\check \phi_{\relA} \colon \setB \sto \powerset (\setA)$ via
              \begin{equation}
                  \check \phi_{\relA} (\elb) = \{ \ela \in \setA \mid \inrel{\ela}{\relA}{\elb}\}.
              \end{equation}
              Conversely, given a function~$\check \phi \colon \setB \sto \powerset (\setA)$, we can define
              \begin{equation}
                  \relA_{\check \phi} = \{ \tup{\ela, \elb} \in \setA \cartprod \setB \mid \ela \in \check \phi_{\relA}(\elb)\}.
              \end{equation}
              These two constructions are \emph{also} inverse to one another.
    \end{enumerate}

\begin{marginfigure}
    \centering
    \includesag{30_rel_1_bis}
    \caption{}
    \label{fig:example_rel_again}
\end{marginfigure}
\vfill
\begin{gradedexercise}[\exname{Rel3Functions}]
    \label{ex:Rel3Functions}
    For the relation $\relA$ illustrated in~\cref{fig:example_rel_again}, write out the three functions that describe it, respectively, in the three ways outlined in \cref{rem:rel-three-fun-descriptions}.
\end{gradedexercise}

\solutionof{Rel3Functions}
