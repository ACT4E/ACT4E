% !TEX root = chapter-standalone.tex

\section{Relations and functions}
\linkvideo{spring2021-relations:relations:fun-rel} % Functions and relations


Every function between sets can be thought as a relation: this was the basis of our formal definition of function, \cref{def:function}.
Let us restate that definition once again here, using notation that we have developed since. 

\begin{definition}
    \label{def:functions_as_relations}
    Let~$\setA$ and~$\setB$ be sets. A \iindex{relation}~$\relA \subseteq \setA \cartprod \setB$ is a \emph{\iindex{function}} if it satisfies the following two conditions:
    \begin{enumerate}
        \item for all~$\ela \in \setA \quad \exists \ \elb \in \setB\colon  \inrel{\ela}{\relA}{\elb}$;
        \item for all~$\inrel{\ela_1}{\relA}{\elb_1}, \inrel{\ela_2}{\relA}{\elb_2}$ holds:
              \begin{equation*}
                  \prfperiod{\ela_1 = \ela_2}{\elb_1 = \elb_2}
              \end{equation*}
    \end{enumerate}
\end{definition}

Although we will mostly continue to think about functions in the `usual' way (as opposed to the perspective of \cref{def:functions_as_relations}), it is illuminating -- both for understanding relations as well as functions -- to study the relationships between the two points of view. 

First, let's recall how to go from viewing a function in the `usual' way to viewing it as a relation, as in \cref{def:functions_as_relations}. 

As an illustration, consider the sets~$\setA = \{ \sbretzel, \sfondue, \schoco \}$ and~$\setB = \{ \stea, \smilk, \swater, \swine \}$, and the function~$\mapa \colon \setA \sto \setB$ defined (in the `usual' way) by
\begin{equation}
    \mapa (\sbretzel) = \stea, \ \mapa (\sfondue) = \swater, \ \mapa(\schoco) = \swine.
\end{equation}
\begin{marginfigure}
    \centering
    \includesag{30_rel_4}
    \caption{Visualization of the function \cref{eq:fun-rel}.}
    \label{fig:example_fun_rel}
\end{marginfigure}
This way of specifying the function $\mora$ may be depicted graphically as in \cref{fig:example_fun_rel}. 

The relation that this function defines, in the sense of \cref{def:functions_as_relations}, is
%
\begin{equation}
    \label{eq:fun-rel}
    \{ \tup{\sbretzel, \stea}, \tup{\sfondue, \swater}, \tup{\schoco, \swine} \} \subseteq \setA \cartprod \setB.
\end{equation}

\begin{marginfigure}
    \centering
    \includesag{30_rel_fun_graph}
    \caption{The graph of the function \cref{eq:fun-rel}.}
    \label{fig:example_fun_graph}
\end{marginfigure}

This relation \cref{eq:fun-rel} is what is often called the \emph{graph} of $\mora$.
That is, it is the set of tuples in~$\setA \cartprod \setB$ which are a pairing of an element of the source set~$\setA$ with the element which is its image under~$\mapa$. In \cref{fig:example_fun_graph}, the graph of \cref{eq:fun-rel} is visualized by highlighting the elements of the graph among all the elements of $\setA \cartprod \setB$.

In general, any function~$\mapa \colon \setA \to \setB$ corresponds to the relation 
\begin{equation*}
   \{ \tup{\ela,\elb} \in \setA \cartprod \setB \mid \elb= \mapa(\ela) \}.
\end{equation*}


Second, let's start now with a relation~$\relA \subseteq \setA \cartprod \setB$ satisfying the conditions of \cref{def:functions_as_relations} and see how this corresponds to a function~$\mapa_\relA \colon \setA \to \setB$ in the `usual' sense.

Choose an arbitrary $\ela \in \setA$. According to point~$1.$ in \cref{def:functions_as_relations}, there exists a~$\elb \in \setB$ such that~$\inrel{\ela}{\relA}{\elb}$.
So let's choose such a~$\elb$, and call it~$\mapa_\relA(\ela)$.
This gives us recipe to get from any~$\ela$ to a~$\elb$.
But given a specific~$\ela \in \setA$, what if we choose~$\elb$ differently each time we apply the recipe?
Point~$2.
$ guarantees that this can't happen: it says that the element~$\mapa_\relA(\ela)$ that we associate to a given~$\ela \in \setA$ is in fact uniquely determined by that~$\ela$.
Put another way, the condition~$2.
$ says: if~$\mapa_\relA(\ela_1) \neq \mapa_\relA(\ela_2)$, then~$\ela_1 \neq\ela_2$.


\begin{remark}
Of course, not every relation corresponds to a function -- namely precisely those that do not satisfy the conditions in \cref{def:functions_as_relations}. For example, the relation in \cref{fig:example_rel} is not a function. In fact it does not satisfying \emph{either} of the conditions in \cref{def:functions_as_relations}. 
\end{remark}




\subsection{Composing functions}

If we define functions as special kinds of relations, how is relation composition relate to the `usual' way of composing of functions?
The answer is that these two apparently different ways of composing functions actually give the same result!

\begin{lemma}
    \label{lem:comprelfun}
    Let~$\relA \subseteq \setA \cartprod \setB$ and~$\relB \subseteq \setB \cartprod \setC$ be relations which are functions.
    Then their composition~$\relA \mthen \relB \subseteq \setA \cartprod \setC$ is again a function, and it corresponds to the `usual' composition of the functions corresponding to $\relA$ and $\relB$.
\end{lemma}

\begin{proof}
   First let us check that when $\relA$ and $\relB$ are composed as relations, the result is again a function. For this we check that~$\relA \mthen \relB$ satisfies the two conditions stated in \cref{def:functions_as_relations}.

    \begin{enumerate}
        \item Choose an arbitrary~$\ela \in \setA$.
              We need to show that there exists~$\elc \in \setC$ such that~$\inrel{\ela}{\relA \mthen \relB}{\elc}$.
              Since~$\relA$ is a function, there exists~$\elb \in \setB$ such that~$\inrel{\ela}{\relA}{\elb}$.
              Choose such a~$\elb \in \setB$.
              Then, because~$\relB$ is a function, there exists~$\elc \in \setC$ such that~$\inrel{\elb}{\relB}{\elc}$.
              By the definition of composition of relations, we see that~$\elc$ is such that~$\inrel{\ela}{\relA \mthen \relB}{\elc}$.
        \item Let~$\inrel{\ela_1}{\relA \mthen \relB}{\elc_1}$,~$\inrel{\ela_2}{\relA \mthen \relB}{\elc_2}$.
              We need to show that if~$\ela_1 = \ela_2$, then~$\elc_1 = \elc_2$.
              So suppose~$\ela_1 = \ela_2$.
              Since~$\inrel{\ela_1}{\relA \mthen \relB}{\elc_1}$,~$\inrel{\ela_2}{\relA \mthen \relB}{\elc_2}$, there exist~$\elb_1, \elb_2 \in \setB$ such that, respectively,
              \begin{equation*}
                  \inrel{\ela_1}{\relA}{\elb_1} \booland \inrel{\elb_1}{\relB}{\elc_1},
              \end{equation*}
              \begin{equation*}
                  \inrel{\ela_2}{\relA}{\elb_2} \booland \inrel{\elb_2}{\relB}{\elc_2}.
              \end{equation*}
              Since~$\ela_1 = \ela_2$ and~$\relA$ is a function, we conclude that~$\elb_1 = \elb_2$ must hold.
              Now, since~$\relB$ is also a function, this implies that~$\elc_1 = \elc_2$, which is what was to be shown.
    \end{enumerate}
    
    Second let us check that relation composition of functions gives the same result as the `usual' composition of functions. 
    Let $\mapa_\relA$ and $\mapb_\relB$ denote the relations $\relA$ and $\relB$ when we are thinking of them in the `usual' way of thinking about functions. Our goal is to show that $\mapa_\relA \then \mapb_\relB$ corresponds to $\relA \then \relB$; in other words, that the latter is the graph of former. 
    
    Suppose first that $\tup{\ela, \elc}$ is in the graph of $\mapa_\relA \then \mapb_\relB$, so $\elc = (\mapa_\relA \then \mapb_\relB)(\ela)$. In particular $\elc =  \mapb_\relB(\mapa_\relA(\ela))$, which means there exists $\elb = \mapa_\relA(\ela) \in \setB$ such that $\tup{\ela, \elb} \in \relA$ and $\tup{\elb, \elc} \in \relB$. This implies that $\tup{\ela, \elc} \in \relA \then \relB$. 
    
   Conversely, suppose $\tup{\ela, \elc} \in \relA \then \relB$. By the definition of relation composition there must exist $\elb \in \setB$ such that $\tup{\ela, \elb} \in \relA$ and $\tup{\elb, \elc} \in \relB$, which means $\elb = \mapa_\relA(\ela)$ and $\elc = \mapb_\relB(\elb)$. Thus $\elc = \mapb_\relB(\mapa_\relA(\ela))$. 
    
\end{proof}



\subsection{Relations via functions}

    \label{rem:rel-three-fun-descriptions}
    Though not every relation \emph{is} a function, we can however think about relations \emph{in terms of} functions.
    Here are three ways:
    \begin{enumerate}
        \item We can think of a relation~$\relA \colon \setA \mto\setB$ as a function~$\setA \cartprod \setB \sto \{ \false, \true \}$, where we think of ``$\false$'' as ``false'' and ``$\true$'' as ``true''.

              Given~$\relA$, we can define a function~$\phi_{\relA} \colon \setA \cartprod \setB \sto \{ \false, \true \}$ from it by setting
              \begin{equation}
                  \phi_{\relA}(\tup{\ela, \elb}) =
                  \left
                  \{\begin{array}{lr}
                      \true  & \text{if } \inrel{\ela}{\relA}{\elb} \\
                      \false & \text{otherwise.
                      }
                  \end{array}
                  \right.
              \end{equation}
              Conversely, given a function~$\phi\colon \setA \cartprod \setB \sto \{ \false, \true \}$ we can define a relation~$\relA_{\phi} \subseteq \setA \cartprod \setB$ from it by setting
              \begin{equation}
                  \relA_{\phi} = \{ \tup{\ela, \elb} \in \setA \cartprod \setB \mid \phi_{\relA}(\tup{\ela, \elb}) = \true \}.
              \end{equation}
              These two constructions are inverse to one-another.

        \item We can think of a relation~$\relA \colon \setA \mto \setB$ as a function~$\setA  \sto \powerset (\setB)$.

              Given~$\relA$, we can define a function~$\hat \phi_{\relA} \colon \setA \sto \powerset (\setB)$ via
              \begin{equation}
                  \hat \phi_{\relA} (\ela) = \{ \elb \in \setB \mid \inrel{\ela}{\relA}{\elb}\}.
              \end{equation}
              Conversely, given a function~$\hat \phi \colon \setA \sto \powerset (\setB)$, we can define
              \begin{equation}
                  \relA_{\hat \phi} = \{ \tup{\ela, \elb} \in \setA \cartprod \setB \mid \elb \in \hat \phi_{\relA}(\ela)   \}.
              \end{equation}
              These two constructions are inverse to one another, too.

        \item We can think of a relation~$\relA \subseteq \setA \cartprod \setB$ as a function~$\setB  \sto \powerset (\setA)$.

              Given~$\relA$, we can define a function~$\check \phi_{\relA} \colon \setB \sto \powerset (\setA)$ via
              \begin{equation}
                  \check \phi_{\relA} (\elb) = \{ \ela \in \setA \mid \inrel{\ela}{\relA}{\elb}\}.
              \end{equation}
              Conversely, given a function~$\check \phi \colon \setB \sto \powerset (\setA)$, we can define
              \begin{equation}
                  \relA_{\check \phi} = \{ \tup{\ela, \elb} \in \setA \cartprod \setB \mid \ela \in \check \phi_{\relA}(\elb)\}.
              \end{equation}
              These two constructions are \emph{also} inverse to one another.
    \end{enumerate}

\begin{marginfigure}
    \centering
    \includesag{30_rel_1_bis}
    \caption{}
    \label{fig:example_rel_again}
\end{marginfigure}
\vfill
\begin{gradedexercise}[\exname{Rel3Functions}]
    \label{ex:Rel3Functions}
    For the relation $\relA$ illustrated in~\cref{fig:example_rel_again}, write out the three functions that describe it, respectively, in the three ways outlined in \cref{rem:rel-three-fun-descriptions}.
\end{gradedexercise}

\solutionof{Rel3Functions}
