% !TEX root = chapter-standalone.tex

\section{Interaction with composition}
In the previous section, we introduced the concept of order in~\DP, and proved that hom-sets of~\DP form a bounded lattice.
In this section, we show that composition (\cref{def:dp-series}), monoidal product (\cref{def:monoidalproduct}), and trace (\cref{def:dp-trace}) of design problems are order-preserving operations.

\todographicsjira{432}{@Gioele: (polish) These relations are very well explained with diagrams.}
\begin{lemma}
    \label{lem:series_pres_order}
    Given~$\adpa,\adpab \in \HomSet{\DP}{\F{\posgenA}}{\R{\posgenB}}$ and~$\adpc,\adpd \in \HomSet{\DP}{\F{\posgenB}}{\R{\posgenC}}$ one has:
    \begin{equation}
        \prfperiod{\adpa\posDPleq \adpb}{\adpc\posDPleq \adpd}{\adpa\mthen \adpc \posDPleq \adpb\mthen \adpd}
    \end{equation}
    In other words, series composition is order-preserving on \DP.
\end{lemma}

\begin{proof}
    We have
    \begin{equation}
        \label{eq:series_pres_ord}
        \begin{aligned}
            \left( \adpa\mthen \adpc\right)(\F{\posgenAel^*},\R{\posgenCel}) & =
            \bigvee_{\posgenBel\in \posgenB}\adpa(\F{\posgenAel^*},\R{\posgenBel})\booland \adpc(\F{\posgenBel^*},\R{\posgenCel})                                                                         \\
                                                                             & \posDPleq \bigvee_{\posBel\in \posB} \adpb(\F{\posgenAel^*},\R{\posgenBel})\booland \adpd(\F{\posgenBel^*},\R{\posgenCel}) \\
                                                                             & =\left( \adpb\mthen \adpd\right)(\F{\posgenAel^*},\R{\posgenCel}).
        \end{aligned}
    \end{equation}
    Therefore~$\mthen$ is order-preserving on~\DP.
\end{proof}

\begin{lemma}
    \label{lem:tens_pres_order}
    Given~$\adpa,\adpb \in \HomSet{\DP}{\F{\posgenA}}{\R{\posgenB}}$ and~$\adpc,\adpd \in \HomSet{\DP}{\F{\posgenC}}{\R{\posgenD}}$, one has:

    \begin{equation}
        \prfperiod{
            \adpa\posDPleq \adpb
        }{
            \adpc\posDPleq \adpd
        }{
            \adpa\mtimescat \adpc \posDPleq \adpb\mtimescat \adpd
        }
    \end{equation}
    In other words, the monoidal product preserves order on~\DP.
\end{lemma}

\begin{proof}
    We have
    \begin{equation}
        \label{eq:tens_pres_ord}
        \begin{aligned}
            \left( \adpa\mtimescat \adpc\right) (\tup{\F{\posgenAel},\F{\posgenCel}}^\F{*},\tup{\R{\posgenBel},\R{\posgenDel}}) & =
            \adpa(\F{\posgenAel^*},\R{\posgenBel})\booland \adpc(\F{\posgenCel^*},\R{\posgenDel})                                                                                                                                                       \\
                                                                                                                                & \posDPleq \adpb(\F{\posgenAel^*},\R{\posgenBel})\booland \adpd(\F{\posgenCel^*},\R{\posgenDel})                       \\
                                                                                                                                & =\left( \adpb\mtimescat \adpc\right) (\tup{\F{\posgenAel},\F{\posgenCel}}^\F{*},\tup{\R{\posgenBel},\R{\posgenDel}}).
        \end{aligned}
    \end{equation}
    Therefore,~$\mtimescat$ is order-preserving on \DP.
\end{proof}

\begin{lemma}
    \label{lem:trace_pres_order}
    Given~$\adpa,\adpb\in \HomSet{\DP}{\F{\posgenC}\cartprod \F{\posgenA}}{\R{\posgenC}\cartprod \R{\posgenB}}$, one has:

    \begin{equation}
        \prfperiod{\adpa\posDPleq \adpb}{\Tr_{\F{\posgenA},\R{\posgenB}}^\posC(\adpa)\posDPleq \Tr_{\F{\posgenA},\R{\posgenB}}^\posC(\adpb)}
    \end{equation}
    In other words, trace preserves order on~\DP.
\end{lemma}

\begin{proof}
    One has
    \begin{equation}
        \label{eq:trace_pres_ord}
        \begin{aligned}
            \Tr_{\F{\posgenA},\R{\posgenB}}^\posC(\adpa)(\F{\posgenAel^*},\R{\posgenBel}) & =
            \bigvee_{\posCel\in \posC}\adpa(\tup{\F{\posgenCel},\F{\posgenAel}}^\F{*},\tup{\R{\posgenCel},\R{\posgenBel}})                                                                                           \\
                                                                                          & \posDPleq \bigvee_{\posCel\in \posC}\adpb(\tup{\F{\posgenCel},\F{\posgenAel}}^\F{*},\tup{\R{\posgenCel},\R{\posgenBel}}) \\
                                                                                          & =\Tr_{\F{\posgenA},\R{\posgenB}}^\posC(\adpb)(\F{\posgenAel^*},\R{\posgenBel}).
        \end{aligned}
    \end{equation}
    Therefore,~$\Tr$ is order-preserving on~\DP.
\end{proof}

\begin{lemma}
    \label{lem:coprod_mon}
    Given~$\adpa,\adpb,\adpc,\adpd \in \HomSet{\DP}{\F{\posgenA}}{\R{\posgenB}}$ one has:
    \begin{equation*}
        \prfperiod{\adpa\posleq_\DP \adpb\ }{\ \adpc\posleq_\DP\adpd}{(\adpa\join\adpc)\posleq_\DP (\adpb\join \adpd)}
    \end{equation*}
\end{lemma}
\begin{proof}
    For any~$\F{\posgenAel}\in \F{\posgenA}$,~$\R{\posgenBel}\in \R{\posgenB}$:
    \begin{equation*}
        \begin{aligned}
            (\adpa \join \adpc)(\F{\posgenAel^*},\R{\posgenBel})
             & =\adpa(\F{\posgenAel^*},\R{\posgenBel})\boolor \adpc(\F{\posgenAel^*},\R{\posgenBel})             \\
             & \posleq_\DP \adpb(\F{\posgenAel^*},\R{\posgenBel})\boolor \adpc(\F{\posgenAel^*},\R{\posgenBel})  \\
             & \posleq_\DP \adpb(\F{\posgenAel^*},\R{\posgenBel})\boolor \adpd(\F{\posgenAel^*},\R{\posgenBel}).
        \end{aligned}
    \end{equation*}
\end{proof}

\begin{lemma}
    \label{lem:intersection_mon}
    Given~$\adpa,\adpb,\adpc,\adpd \in \HomSet{\DP}{\F{\posgenA}}{\R{\posgenB}}$ one has:
    \begin{equation*}
        \prfperiod{\adpa\posleq_\DP \adpb\ }{\ \adpc\posleq_\DP \adpd}{(\adpa\meet \adpc)\posleq_\DP (\adpb\meet \adpd)}
    \end{equation*}
\end{lemma}
\begin{proof}
    For any~$\F{\posgenAel}\in \F{\posgenA}$,~$\R{\posgenBel}\in \R{\posgenB}$:
    \begin{equation*}
        \begin{aligned}
            (\adpa \meet \adpc)(\F{\posgenAel}^*,\R{\posgenBel})
             & =\adpa(\F{\posgenAel^*},\R{\posgenBel})\booland \adpc(\F{\posgenAel^*},\R{\posgenBel})             \\
             & \posleq_\DP \adpb(\F{\posgenAel^*},\R{\posgenBel})\booland \adpc(\F{\posgenAel^*},\R{\posgenBel})  \\
             & \posleq_\DP \adpb(\F{\posgenAel^*},\R{\posgenBel})\booland \adpd(\F{\posgenAel^*},\R{\posgenBel}).
        \end{aligned}
    \end{equation*}
\end{proof}