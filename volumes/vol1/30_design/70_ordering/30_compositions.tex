% !TEX root = chapter-standalone.tex


\section{Interaction with composition}

\todo{Show that all composition operations are monotone}

In the previous section, we introduced the concept of order in~\DP, and proved that hom-sets of~\DP form a bounded lattice.
In this section, we show that composition (\cref{def:dp-series}), monoidal product (\cref{def:monoidalproduct}), and trace (\cref{def:dp-trace}) of design problems are order-preserving operations.
\begin{lemma}
  \label{lem:series_pres_order}
  Given~$\adpa_1,\adpa_2 \in \HomSet{\DP}{\F{\posgenA}}{\R{\posgenB}}$ and~$\adpb_1,\adpb_2 \in \HomSet{\DP}{\F{\posgenB}}{\R{\posgenC}}$ one has:
  \begin{equation}
    \prftree{\adpa_1\posDPleq \adpa_2}{\adpb_1\posDPleq \adpb_2}{\adpa_1\mthen \adpb_1 \posDPleq \adpa_2\mthen \adpb_2}
  \end{equation}
In other words, series composition is order-preserving on \DP.
\end{lemma}

\begin{proof}
  We have
  \begin{equation}
   \label{eq:series_pres_ord}
    \begin{aligned}
      \left( \adpa_1\mthen \adpb_1\right)(\F{a}^*,\R{c})&=\bigvee_{b\in \posgenB}\adpa_1(\F{a}^*,\R{b})\wedge \adpb_1(\F{b}^*,\R{c})\\
      &\posDPleq \bigvee_{b\in \posgenB} \adpa_2(\F{a}^*,\R{b})\wedge \adpb_2(\F{b}^*,\R{c})\\
      &=\left( \adpa_2\mthen \adpb_2\right)(\F{a}^*,\R{c}).
    \end{aligned}
  \end{equation}
  Therefore~$\mthen$ is order-preserving on~\DP.
\end{proof}

\begin{lemma}
  \label{lem:tens_pres_order}
  Given~$\adpa_1,\adpa_2 \in \HomSet{\DP}{\F{\posgenA}}{\R{\posgenB}}$ and~$\adpb_1,\adpb_2 \in \HomSet{\DP}{\F{\posgenC}}{\R{\posgenD}}$, one has:

 \begin{equation}
   \prftree{\adpa_1\posDPleq \adpa_2}{\adpb_1\posDPleq \adpb_2}{\adpa_1\mtimescat \adpb_1 \posDPleq \adpa_2\mtimescat \adpb_2}
\end{equation}
  In other words, the monoidal product preserves order on~\DP.
\end{lemma}

\begin{proof}
  We have
  \begin{equation}
    \label{eq:tens_pres_ord}
    \begin{aligned}
      \left( \adpa_1\mtimescat \adpb_1\right) (\tup{\F{a},\F{c}}^*,\tup{\R{b},\R{d}})&=\adpa_1(\F{a}^*,\R{b})\wedge \adpb_1(\F{c}^*,\R{d})\\
      &\posDPleq \adpa_2(\F{a}^*,\R{b})\wedge \adpb_2(\F{c}^*,\R{d})\\
      &=\left( \adpa_2\mtimescat \adpb_2\right) (\tup{\F{a},\F{c}}^*,\tup{\R{b},\R{d}})
    \end{aligned}
  \end{equation}
  Therefore,~$\mtimescat$ is order-preserving on \DP.
\end{proof}

\begin{lemma}
  \label{lem:trace_pres_order}
  Given~$\adpa_1,\adpa_2\in \HomSet{\DP}{\F{\posgenC}\times \F{\posgenA}}{\R{\posgenC}\times \R{\posgenB}}$, one has:

  \begin{equation}
    \prftree{\adpa_1\posDPleq \adpa_2}{\Tr_{\F{\posgenA},\R{\posgenB}}^\posgenC(\adpa_1)\posDPleq \Tr_{\F{\posgenA},\R{\posgenB}}^\posgenC(\adpa_2)}
  \end{equation}
  In other words, trace preserves order on~\DP.
\end{lemma}

\begin{proof}
  One has
  \begin{equation}
     \label{eq:trace_pres_ord}
    \begin{aligned}
      \Tr_{\F{\posgenA},\R{\posgenB}}^\posgenC(\adpa_1)(\F{a}^*,\R{b})&=\bigvee_{c\in \posgenC}\adpa_1(\tup{\F{c},\F{a}}^*,\tup{\R{c},\R{b}})\\
      &\posDPleq \bigvee_{c\in \posgenC}\adpa_2(\tup{\F{c},\F{a}}^*,\tup{\R{c},\R{b}})\\
      &=\Tr_{\F{\posgenA},\R{\posgenB}}^\posgenC(\adpa_2)(\F{a}^*,\R{b}).
    \end{aligned}
  \end{equation}
  Therefore,~$\Tr$ is order-preserving on~\DP.
\end{proof}

\begin{lemma}
  \label{lem:coprod_mon}
  Given~$\adpa_1,\adpa_2,\adpa_3,\adpa_4 \in \HomSet{\DP}{\F{\posgenA}}{\R{\posgenB}}$ one has:
  \begin{equation*}
  \prftree{\adpa_1\posleq_\DP \adpa_2}{\adpa_3\posleq_\DP \adpa_4}{\adpa_1\vee \adpa_3\posleq_\DP \adpa_2\vee \adpa_4}
  \end{equation*}
\end{lemma}
\begin{proof}
  For any~$\F{a}\in \F{\posgenA}$,~$\R{b}\in \R{\posgenB}$:
  \begin{equation*}
    \begin{aligned}
      (\adpa_1 \vee \adpa_3)(\F{a}^*,\R{b})&=\adpa_1(\F{a}^*,\R{b})\vee \adpa_3(\F{a}^*,\R{b})\\
      &\posleq_\DP \adpa_2(\F{a}^*,\R{b})\vee \adpa_3(\F{a}^*,\R{b})\\
      &\posleq_\DP \adpa_2(\F{a}^*,\R{b})\vee \adpa_4(\F{a}^*,\R{b}).
    \end{aligned}
  \end{equation*}
\end{proof}


\begin{lemma}
  \label{lem:intersection_mon}
  Given~$\adpa_1,\adpa_2,\adpa_3,\adpa_4 \in \HomSet{\DP}{\F{\posgenA}}{\R{\posgenB}}$ one has:
  \begin{equation*}
  \prftree{\adpa_1\posleq_\DP \adpa_2}{\adpa_3\posleq_\DP \adpa_4}{\adpa_1\wedge \adpa_3\posleq_\DP \adpa_2\wedge \adpa_4}
  \end{equation*}
\end{lemma}
\begin{proof}
  For any~$\F{a}\in \F{\posgenA}$,~$\R{b}\in \R{\posgenB}$:
  \begin{equation*}
    \begin{aligned}
      (\adpa_1 \wedge \adpa_3)(\F{a}^*,\R{b})&=\adpa_1(\F{a}^*,\R{b})\wedge \adpa_3(\F{a}^*,\R{b})\\
      &\posleq_\DP \adpa_2(\F{a}^*,\R{b})\wedge \adpa_3(\F{a}^*,\R{b})\\
      &\posleq_\DP \adpa_2(\F{a}^*,\R{b})\wedge \adpa_4(\F{a}^*,\R{b}).
    \end{aligned}
  \end{equation*}
\end{proof}