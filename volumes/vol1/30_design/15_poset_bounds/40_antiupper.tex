% !TEX root = chapter-standalone.tex

\section[Antichains]{Upper and lower closure}

\linkvideo{spring2021-design:up-low-closure} % Upper and lower closure
\begin{definition}[Upper closure operator]
    \label{def:upperclosure}
    The \emph{upper closure operator}~$\upit $ maps a subset to the smallest upper set that includes it:
    \begin{equation}
        \defmapperiod{
            \upit
        }{
            \posPA
        }{
            \to
        }{
            \setOfUppersets\posA
        }{
            \posA
        }{
            \makeset{\styleelements{y}\setin \posAset \mid \exists \styleelements{x}\setin \stylesets{S} \colon \styleelements{x}\posAleq \styleelements{y}}
        }
    \end{equation}
\end{definition}
\begin{remark}
    Note that, by definition, an upper set is closed to upper closure.
\end{remark}
\begin{lemma}
    For any~$\stylesets{S}\setin \posPA$,~$\upit  \stylesets{S}$ is in fact an upper set.
\end{lemma}
\begin{proof}
    Suppose~$\styleelements{y}\setin \upit  \stylesets{S}$ and~$\styleelements{z}\setin \posAset$, and suppose $\styleelements{y}\posAleq \styleelements{z}$.
    By definition there exists a~$\styleelements{x}$ s.t.~$\styleelements{x}\posAleq \styleelements{y}$, meaning that~$\styleelements{x}\posAleq \styleelements{z}$.
    Thus,~$\styleelements{z}\setin \upit  \stylesets{S}$, as was to be shown.
\end{proof}

\begin{lemma}
    The upper closure operator~$\upit$ is an \SY{antitone map}.
\end{lemma}
\begin{proof}
    Consider the \SY{posets}~$\tupp{\posPA,\setsubseteq}$ and $\tupp{\setOfUppersets \posA,\setsupseteq}$, and two sets of sets $\stylesets{S_1}\com \stylesets{S_2}\setin \linebreak[1] \posPA$.
    It is clear that given~$\stylesets{S_1}\setsubseteq \stylesets{S_2}$, we have
    \begin{equation}
        \makeset{\styleelements{y}\setin \posAset\mid \exists \styleelements{x}\setin \stylesets{S_1}\colon \styleelements{x}\posAleq \styleelements{y}} \setsubseteq \makeset{\styleelements{y}\setin \posAset\mid \exists \styleelements{x}\setin \stylesets{S_2}\colon \styleelements{x}\posAleq \styleelements{y}}.
    \end{equation}
    Therefore,~$\upit \stylesets{S_1} \setsubseteq \upit  \stylesets{S_2}$, satisfying the \SY{antitone map} property for~$\upit$.
\end{proof}

In the example of battery choices (in the numerical case), first, consider the upper closure of a single element of the poset, for instance~$\posAel_1=\tupp{\unit[10]{\standardcurrency},\unit[500]{g}}$ (\cref{fig:upperclosure_1}, left).
Second, we can look at the upper closure when we add the choice~$\posAel_2=\tupp{\unit[20]{\standardcurrency},\unit[250]{g}}$ (\cref{fig:upperclosure_1}, center).

Note that the upper set of the subset formed by the two elements is the union of the upper sets of the single elements.
%
Finally, we can also define the set
%
\begin{equation}
    \setA=\makeset{
        \tupp{\text{cost},\text{mass}}\mid \text{mass}=750-25\cdot \text{cost},
        \forall \text{cost} \setin [0,20]
    },
\end{equation}
%
and find its upper closure (\cref{fig:upperclosure_1}, right).
%
\begin{figure*}[h!]
    \centering
    \includesag{70_uc_1_1}
    \hfill
    \includesag{70_uc_1_2}
    \hfill
    \includesag{70_uc_1_3}
    \caption{Example of upper closure for different sets of battery choices.}
    \label{fig:upperclosure_1}
\end{figure*}

\begin{definition}[Lower closure operator]
    \label{def:lowerclosure}
    The \emph{lower closure operator}~$\downit$ maps a subset to the smallest lower set that includes it:
    \begin{equation}
        \defmapperiod{
            \downit
        }{
            \posPA
        }{
            \to
        }{
            \setOfLowersets \posA
        }{
            \stylesets{S}
        }{
            \makeset{ \styleelements{y}\setin \posAset \mid \exists \styleelements{x}\setin \stylesets{S} \colon \styleelements{y}\posAleq \styleelements{x}}
        }
    \end{equation}
\end{definition}

\begin{lemma}
    \label{lem:lower_closure_monotone}
    The lower closure operator~$\downit$ is a monotone map.
\end{lemma}

\begin{exercise}
    Prove \cref{lem:lower_closure_monotone}.
\end{exercise}
\begin{solution}
    Consider the \SY{posets}~$\tup{\posPA,\setsubseteq}$ and~$\tup{\setOfLowersets \posA,\setsubseteq}$, and let~$\stylesets{S_1},\stylesets{S_2}\setin \posPA$.
    It is clear that given~$\stylesets{S_1}\setsubseteq \stylesets{S_2}$, we have
    \begin{equation}
        \makeset{\styleelements{y}\setin \posAset\mid \exists \styleelements{x}\setin \stylesets{S_1}\colon \styleelements{y}\posAleq \styleelements{x}} \setsubseteq \makeset{\styleelements{y}\setin \posAset\mid \exists \styleelements{x}\setin \stylesets{S_2}\colon \styleelements{y}\posAleq \styleelements{x}}.
    \end{equation}
    Therefore,~$\downit \stylesets{S_1}\setsubseteq \ \downit \stylesets{S_2}$, satisfying the monotonicity property for~$\downit$.
\end{solution}

Consider the battery example, and the \SY{antichain} given by the battery models~$\posAel_1=\tupp{\unit[10]{\standardcurrency},\unit[1000]{g}}$,~$\posAel_2=\tupp{\unit[20]{\standardcurrency},\unit[500]{g}}$, and~$\posAel_3=\tupp{\unit[30]{\standardcurrency},\unit[250]{g}}$ (\cref{fig:examplebatt}, left).
The lower closure operator~$\downit\makeset{\posAel_1,\posAel_2,\posAel_3}$ represents all the battery models which, if existing, would dominate~$\makeset{\posAel_1,\posAel_2,\posAel_3}$.
We could instead consider linear maps between the points getting a poset~\posA, and obtain the lower closure depicted in \cref{fig:examplebatt} on the right.

\begin{figure*}[h!]
    \centering
    \includesag{70_battery_0}
    \hfill
    \includesag{70_battery_1}
    \hfill
    \includesag{70_battery_1_bis}
    \caption{Example of lower closures.}
    \label{fig:examplebatt}
\end{figure*}

\subsection{Antichains and upper sets}

\begin{lemma}
    \label{lem:up-cl-inj-antichains}
    Let~\setA and~\setB be subsets of~\posA that are \SY{antichains}.
    Then
    \begin{equation}
        \prfperiod{
            \upit  \setA = \ \upit  \setB
        }{
            \setA = \setB
        }
        %\upit  \setA = \ \upit  \setB \quad \Imp \quad \setA = \setB.
    \end{equation}
\end{lemma}

\begin{proof}
    Fix an element~$\setAel \setin \setA$.
    From~$\upit  \setA = \ \upit  \setB$ we know that in particular $\setA \setsubseteq \ \upit  \setB$.
    This means that for our fixed~$\setAel \setin \setA$ there exists~$\setBel \setin \setB$ such that~$\setBel \posleq \setAel$.
    From~$\upit \setA = \ \upit  \setB$ it also follows that~$\setB \setsubseteq \ \upit  \setA$, so to the~$\setBel \setin \setB$ given above, there exists~$\setAel' \setin \setA$ such that~$\setAel' \posleq \setBel$.
    In total, we have~$\setAel' \posleq \setBel \posleq \setAel$, and since \setA is an \SY{antichain}, we must have~$\setAel' = \setAel$.
    This implies that~$\setAel' = \setBel = \setAel$.
    In particular, we have~$\setAel \setin \setB$.

    The above shows that~$\setA \setsubseteq \setB$.
    To show~$\setB \setsubseteq \setA$, we can fix any~$\setBel \setin \setB$ and repeat the above argumentation, now with the roles of~\setA and~\setB exchanged.
\end{proof}

\begin{definition}[Downward closed set]
    \label{def:downward-closed-upperset}
    An upper set~$\subA$ is \emph{downward-closed} in a poset~\posA if
    \begin{equation}
        \subA =\, \upit  \Min \subA.
    \end{equation}
    The set of downward-closed upper sets of~\posA is denoted~$\setOfDCUppersets \posA$.

\end{definition}

\begin{definition}[Upward closed set]
    \label{def:upward-closed-lowerset}
    A lower set~$\subA$ is \emph{upward-closed} in a poset~\posA if
    \begin{equation}
        \subA =\, \downit  \Max \subA.
    \end{equation}
    The set of upward-closed lower sets of~\posA is denoted~$\setOfUCLowersets \posA$.
\end{definition}
