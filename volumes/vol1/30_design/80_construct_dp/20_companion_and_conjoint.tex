% !TEX root = chapter-standalone.tex

\section{Companions and conjoint}
We round out our discussion of~\DP by introducing two formulae for transforming monotone maps in~\Pos into design problems in~\DP.
Each monotone map~$\mapa$ can be transformed into two design problems, called its \emph{companion}~$\comp{\mapa}$ and \emph{conjoint}~$\conj{\mapa}$.
Many of the design problems that we have introduced can be realized as companions and conjoints of appropriate monotone maps.

\begin{definition}[Companion and conjoint]
    \label{def:comp_conj}
    Let~$\posA$ and~$\posB$ be posets, and suppose that~$\mapa\colon\posA \toinPos \posB$ is a monotone map.
    We define its \emph{companion} in~\DP, denoted~$\comp{\mapa}\colon \F{\posgenA} \profto \R{\posgenB}$,
    and its \emph{conjoint}, denoted~$\conj{\mapa}\colon \F{\posgenB} \profto \R{\posgenA}$ as
    \begin{equation}
        \comp{\mapa}(\FposgenAelop,\RposgenBel)\definedas \mapa(\FposgenAel) \posleqof\posB \RposgenBel
        \qqand
        \conj{\mapa}(\FposgenBelop,\R{\posAel})\definedas \FposgenBel \posleqof\posA \mapa(\R{\posgenAel}).
    \end{equation}
\end{definition}

\begin{lemma}
    \label{lem:comp_conj}
    Both the companion and conjoint constructions from \cref{def:comp_conj} are functorial from~\Pos to~\DP: they preserve identities and composition.
\end{lemma}
\begin{proof}
    We will show that the companion and conjoint are functors of the following forms:
    \begin{equation}
        \comp{\cdot}\colon\Pos\fto\DP
        \qqand
        \conj{\cdot}\colon\Pos\fto\DP\op.
    \end{equation}
    First, we see that they send the identity monotone map~$\mapa(\posAel)=\posAel$ to the unit~$\Unit{\posA }$ for any poset~$\posA$, because
    \begin{equation}
        \begin{aligned}
            ~ & \comp{\catid}(\F{\posgenAel_1^*},\R{\posgenAel_2}) \\
              & = (\F{\posgenAel_1} \posleqof{\posA} \R{\posgenAel_2}) \\
              & =\conj{\catid}(\F{\posgenAel_1^*},\R{\posgenAel_2}).
        \end{aligned}
    \end{equation}
    Now suppose that~$\mapa\colon  \posA \toinPos \posB $ and~$\mapb\colon \posB \toinPos \posC$ are given.
    We first show that $\conj{\mapb}\mthen\conj{\mapa}=\conj{\mapa\mthen \mapb}$.
    For any~$\posAel\setin \posAset$ and $\posCel\setin \posCset$, we have
    \begin{equation}
        \begin{aligned}
            ~ & \left(\conj{\mapb}\mthen \conj{\mapa}\right)(\FposgenAelop,\R{\posgenCel}) \\
              & =\bigvee_{\posBel\setin \posB} \conj{\mapb}(\F{\posgenCel^*},\RposgenBel)\booland\conj{\mapa}(\FposgenBelop,\R{\posgenAel}) \\
              & =\bigvee_{\posBel\setin \posB} (\F{\posgenCel}\posleqof\posC \mapb(\RposgenBel)) \booland (\FposgenBel\posleqof\posB \mapa(\R{\posgenAel})) \\
              & = \F{\posgenCel}\posleqof\posC \mapb(\mapa(\R{\posgenAel})) \\
              & =\left(\conj{\mapa\mthen \mapb}\right)(\F{\posgenCel^*},\R{\posgenAel}).
        \end{aligned}
    \end{equation}
    Similarly, we can prove that~$\comp{\mapa}\mthen \comp{\mapb}=\comp{\mapa\mthen \mapb}$:
    \begin{equation}
        \begin{aligned}
            ~ & \left(\comp{\mapa}\then \comp{\mapb}\right)(\FposgenAelop,\R{\posgenCel}) \\
              & =\bigvee_{\posBel\setin \posB} \comp{\mapa}(\FposgenAelop,\RposgenBel)\booland\comp{\mapb}(\FposgenBelop,\R{\posgenCel}) \\%.
              & =\bigvee_{\posBel\setin \posB} (\mapb(\FposgenAel)\posleqof\posB \RposgenBel)\booland (\mapb(\FposgenBel)\posleqof\posC \R{\posgenCel}) \\
              & =\mapb(\mapa(\FposgenAel))\posleqof\posC \R{\posgenCel} \\
              & =\left(\comp{\mapa\then \mapb}\right)(\FposgenAelop,\R{\posgenCel}).
        \end{aligned}
    \end{equation}
\end{proof}

\begin{example}
    The identity design problem~$\catid_\posA\colon \F{\posgenA} \profto \R{\posgenA}$ is the companion (and the conjoint) of the identity map~$\catid_\posA'\colon \posgenA \toinPos \posgenA$.
    This is easy to check, as
    \begin{equation}
        \begin{aligned}
            ~ & \comp{\id}_\posA'(\F{\posgenAel_1^*},\R{\posgenAel_2}) \\
              & =\id_\posA'(\F{\posgenAel_1})\posleq \R{\posgenAel_2} \\
              & =\F{\posgenAel_1}\posleq \R{\posgenAel_2} \\
              & =\catid_\posA(\F{\posgenAel_1^*},\R{\posgenAel_2}).
        \end{aligned}
    \end{equation}
\end{example}

\begin{example}
    The coproduct injections~$\iota_\posA, \iota_\posB$ for design problems are the companions of the coproduct injections for the disjoint union.
\end{example}

\begin{example}
    The product projections~$\pi_\posA, \pi_\posB$ for design problems are the conjoints of the coproduct injections for the disjoint union.
\end{example}

\subsection{Deriving terminators}
Using companion and conjoint we can obtain the equivalent of ``terminators'' representing constant functionality/resources.
Consider an element $\posela$ of a poset~$\posgenA$.
We can represent this constant element as a map $\mapa_{\posela}$ from the singleton to the poset:
%
\begin{equation}
    \defmapperiod{
        \mapa_{\posela}
    }{
        \singleton
    }{
        \toinPos
    }{
        \posA
    }{
        \singletonel
    }{
        \posela
    }
\end{equation}
%
By taking the companion of~$\mapa_{\posela}$ one gets
%
\begin{equation}
    \defmapperiod{
        \comp{\mapa_{\posela}}
    }{
        \F{\singleton}
    }{
        \profto
    }{
        \R{\posgenA}
    }{
        \tup{\F{\singletonel},\R{\posgenAel}}
    }{
        ( x \posleqof\posgenA \R{\posgenAel})
    }
\end{equation}
By taking the conjoint, one gets
\begin{equation}
    \defmapperiod{
        \conj{\mapa_{\posela}}
    }{
        \F{\posgenA}
    }{
        \profto
    }{
        \R{\singleton}
    }{
        \tup{\FposgenAelop,\R{\singletonel}}
    }{
        (\FposgenAel\posleqof\posgenA x)
    }
\end{equation}
These two cases represent design problems with either \emph{constant} resources or constant, functionalities, respectively.
\todographics{@Gioele: Create figures for terminators}
