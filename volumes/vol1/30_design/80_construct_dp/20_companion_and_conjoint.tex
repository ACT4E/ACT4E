% !TEX root = chapter-standalone.tex

\section{Companions and conjoint}
We round out our discussion of~\DP by introducing two formulas for transforming \SY{monotone maps} in~\Pos into \SY{design problems} in~\DP.
Each \SY{monotone maps}~$\mapa$ can be transformed into two \SY{design problems}, called its \emph{companion}~$\comp{\mapa}$ and \emph{conjoint}~$\conj{\mapa}$.
Many of the \SY{design problems} that we have introduced can be realized as \SY{companions} and conjoints of appropriate \SY{monotone maps}.

\begin{definition}[Companion and conjoint]
    \label{def:comp_conj}
    Let~\posA and~\posB be \SY{posets}, and suppose that~$\mapa\colon\posA \toinPos \posB$ is a \SY{monotone map}.
    We define its \emph{companion} in~\DP, denoted~$\comp{\mapa}\colon \F{\posgenA} \profto \R{\posgenB}$,
    and its \emph{conjoint}, denoted~$\conj{\mapa}\colon \F{\posgenB} \profto \R{\posgenA}$ as
    \begin{equation}
        \comp{\mapa}(\FposgenAelop,\RposgenBel)\definedas \mapa(\FposgenAel) \posleqof\posB \RposgenBel
        \qqand
        \conj{\mapa}(\FposgenBelop,\R{\posgenAel})\definedas \FposgenBel \posleqof\posA \mapa(\R{\posgenAel}).
    \end{equation}
\end{definition}

\begin{lemma}
    \label{lem:comp_conj}
    Both the \SY{companion} and \SY{conjoint} constructions from \cref{def:comp_conj} are functorial from~\Pos to~\DP: they preserve identities and composition.
\end{lemma}
\begin{proof}
    We will show that the \SY{companion} and \SY{conjoint} are \SY{functors} of the following forms:
    \begin{equation}
        \compmap\colon\Pos\fto\DP
        \qqand
        \conjmap\colon\Pos\fto\DP\op.
    \end{equation}
    First, we see that they send the identity \SY{monotone maps}~$\mapidat{\posA}$ to the identity design problem~$\dpidat{\posA}$ for any poset~\posA, because
    \begin{equation}
        % \begin{aligned}
        \comp{\mapidat{\posA}}(\F{\posgenAel_1^*},\R{\posgenAel_2})
        = (\F{\posgenAel_1} \posleqof{\posA} \R{\posgenAel_2})
        =\conj{\mapidat{\posA}}(\F{\posgenAel_1^*},\R{\posgenAel_2}).
        % \end{aligned}
    \end{equation}
    Now suppose that~$\mapa\colon  \posA \toinPos \posB $ and~$\mapb\colon \posB \toinPos \posC$ are given.
    We first show that $\conj{\mapb}\dpthen\conj{\mapa}=\conj{\mapa\mthen \mapb}$.
    For any~$\posAel\setin \posAset$ and $\posCel\setin \posCset$, we have
    \begin{equation}
        \begin{aligned}
            ~ & \pars{\conj{\mapb}\dpthen \conj{\mapa}}(\FposgenAelop,\R{\posgenCel}) \\
              & =\bigvee_{\posBel\setin \posB} \conj{\mapb}(\F{\posgenCel^*},\RposgenBel)\booland\conj{\mapa}(\FposgenBelop,\R{\posgenAel}) \\
              & =\bigvee_{\posBel\setin \posB} (\F{\posgenCel}\posleqof\posC \mapb(\RposgenBel)) \booland (\FposgenBel\posleqof\posB \mapa(\R{\posgenAel})) \\
              & = \F{\posgenCel}\posleqof\posC \mapb(\mapa(\R{\posgenAel})) \\
              & =\pars{\conj{\mapa\mthen \mapb}}(\F{\posgenCel^*},\R{\posgenAel}).
        \end{aligned}
    \end{equation}
    Similarly, we can prove that~$\comp{\mapa}\dpthen \comp{\mapb}=\comp{\mapa\mthen \mapb}$:
    \begin{equation}
        \begin{aligned}
            ~ & \pars{\comp{\mapa}\fthen \comp{\mapb}}(\FposgenAelop,\R{\posgenCel}) \\
              & =\bigvee_{\posBel\setin \posB} \comp{\mapa}(\FposgenAelop,\RposgenBel)\booland\comp{\mapb}(\FposgenBelop,\R{\posgenCel}) \\%.
              & =\bigvee_{\posBel\setin \posB} (\mapb(\FposgenAel)\posleqof\posB \RposgenBel)\booland (\mapb(\FposgenBel)\posleqof\posC \R{\posgenCel}) \\
              & =\mapb(\mapa(\FposgenAel))\posleqof\posC \R{\posgenCel} \\
              & =\pars{\comp{\mapa\mthen \mapb}}(\FposgenAelop,\R{\posgenCel}).
        \end{aligned}
    \end{equation}
\end{proof}

\begin{example}
    The \SY{identity design problem}~$\dpid_\posA\colon \F{\posgenA} \profto \R{\posgenA}$ is the \SY{companion} (and the \SY{conjoint}) of the identity map~$\catidofat\Pos\posA \colon \posgenA \toinPos \posgenA$.
    This is easy to check, as
    \begin{equation}
        \begin{aligned}
            ~ & \comp{\catidat\posA}(\F{\posgenAel_1^*},\R{\posgenAel_2}) \\
              & =\catidat\posA(\F{\posgenAel_1})\posleq \R{\posgenAel_2} \\
              & =\F{\posgenAel_1}\posleq \R{\posgenAel_2} \\
              & =\dpid_\posA(\F{\posgenAel_1^*},\R{\posgenAel_2}).
        \end{aligned}
    \end{equation}
\end{example}

\todotext{\alphubel: we need to use macros for $\iota$ etc.}
\begin{example}
    The coproduct injections~$\iota_\posA, \iota_\posB$ for \SY{design problems} are the \SY{companions} of the coproduct injections for the disjoint union.
\end{example}

\begin{example}
    The product projections~$\pi_\posA, \pi_\posB$ for \SY{design problems} are the conjoints of the coproduct injections for the disjoint union.
\end{example}

\subsection{Deriving terminators}
Using \SY{companion} and \SY{conjoint} we can obtain the equivalent of ``terminators'' representing constant functionality/resources.
Consider an element $\posela$ of a poset~$\posgenA$.
We can represent this constant element as a map $\mapa_{\posela}$ from the singleton to the poset:
%
\begin{equation}
    \defmapperiod{
        \mapa_{\posela}
    }{
        \singleton
    }{
        \toinPos
    }{
        \posA
    }{
        \singletonel
    }{
        \posela
    }
\end{equation}
%
By taking the \SY{companion} of~$\mapa_{\posela}$ we get
%
\begin{equation}
    \defmapperiod{
        \comp{\mapa_{\posela}}
    }{
        \F{\singleton}
    }{
        \profto
    }{
        \R{\posgenA}
    }{
        \tup{\F{\singletonel},\R{\posgenAel}}
    }{
        ( x \posleqof\posgenA \R{\posgenAel})
    }
\end{equation}
By taking the \SY{conjoint}, we get
\begin{equation}
    \defmapperiod{
        \conj{\mapa_{\posela}}
    }{
        \F{\posgenA}
    }{
        \profto
    }{
        \R{\singleton}
    }{
        \tup{\FposgenAelop,\R{\singletonel}}
    }{
        (\FposgenAel\posleqof\posgenA x)
    }
\end{equation}
These two cases represent \SY{design problems} with either \emph{constant} resources or constant, functionalities, respectively.
\todographics{@Gioele: Create figures for terminators}
