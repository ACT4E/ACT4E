% !TEX root = chapter-standalone.tex

\section{``Twisted''  poset of intervals}
\linkvideo{spring2021-tradeoffs:tradeoffs:orders:interval-poset} % Poset of intervals

An interval of time is defined by two numbers: a lower and upper bound.
The notation $[a,b]$ usually defines an interval on the real line.
We can generalize the notion to an interval of a poset.

\subsection{Poset intervals}
\begin{marginfigure}
    \centering
    \includesag{int_pos_fig}
    \caption{Poset interval on $\reals^2$.}
    \label{fig:int_posets}
\end{marginfigure}

\begin{definition}[Interval]
    \label{def:interval}
    An \maindef{interval} of a poset~\posA is a pair of elements~$\posela, \poselb$ such that~$\posela \posAleq \poselb$.
    We also write $\interv \posela \poselb$, and we identify it with the subset of elements of \posA that are a bounded above and below by the two elements:
    \begin{equation}\label{eq:interval}
        \interv \posela \poselb
        \definedas
        \makeset{
            \poselc \setin \posAset \colon
            \posela \posAleq \poselc \posAleq \poselb
        }.
    \end{equation}
\end{definition}

Note that, following this definition, the empty set is \emph{not} an interval.

\subsection{A ``twisted''  poset} of  poset intervals

There are two canonical ways to order \SY{poset} intervals: a ``twisted'' version and an ``arrow'' version.
The names are not intuitive at this point: later on, we will see that there exists an ``arrow construction'' and a ``twisted arrow construction'' for categories, and they correspond to these constructions when a \SY{poset} is considered as a category.

\begin{marginfigure}
    \centering
    %\includesag{first_poset_intervals}
    \includesag{tw_int_fig}
    \caption{
        $\interv \posela \poselb
            \posleqof{\posint{\posA}}
            \interv \poselc \poseld$
    }
\end{marginfigure}

\begin{definition}[``Twisted'' poset of intervals~$\posint\posA$]
    \label{def:poset_intervals}
    \SYNDEF{twisted poset of intervals}
    Given a poset~\posA, we define a \emph{``twisted'' \SY{poset} of intervals}~$\posint\posA$
    by ordering the intervals by inclusion:
    %
    \begin{equation}\label{eq:twisted-1}
        \prfdoubleperiod{
            \interv \posela \poselb
            \posleqof{\posint{\posA}}
            \interv \poselc \poseld
        }{
            \interv \posela \poselb
            \setsubseteq
            \interv \poselc \poseld
        }
    \end{equation}
    Equivalently we only need to check the bounds:
    \begin{equation}\label{eq:twisted-2}
        \prfdoubleperiod{
            \interv \posela \poselb
            \posleqof{\posint{\posA}}
            \interv \poselc \poseld
        }{
            (\poselc \posAleq \posela ) \booland (\poselb \posAleq \poseld)
        }
    \end{equation}

\end{definition}

\begin{exercise}
    Check that the relation defined in \cref{def:poset_intervals} is indeed a poset.
\end{exercise}
\begin{solution}
    We check the three conditions.
    \begin{itemize}
        \item First, we know that~$\interv{\posAnel{1}}{\posBnel{1}}\posleqof{\posint{\posA}}\interv{\posAnel{1}}{\posBnel{1}}$, since~$\posAnel{1}\posAleq \posAnel{1}$ and~$\posBnel{1}\posAleq \posBnel{1}$.
        \item Second,~$\interv{\posAnel{1}}{\posBnel{1}}\posleqof{\posint{\posA}}\interv{\posAnel{2}}{\posBnel{2}}$ and~$\interv{\posAnel{2}}{\posBnel{2}}\posleqof{\posint{\posA}}\interv{\posAnel{3}}{\posBnel{3}}$ imply
              \begin{equation}
                  \interv{\posAnel{1}}{\posBnel{1}}\posleqof{\posint{\posA}}\interv{\posAnel{3}}{\posBnel{3}}.
              \end{equation}
        \item Third, if~$\interv{\posAnel{1}}{\posBnel{1}}\posleqof{\posint{\posA}}\interv{\posAnel{2}}{\posBnel{2}}$ and~$\interv{\posAnel{2}}{\posBnel{2}}\posleqof{\posint{\posA}}\interv{\posAnel{1}}{\posBnel{1}}$, then~$\posAnel{1}=\posAnel{2}$ and~$\posBnel{1}=\posBnel{2}$.
    \end{itemize}
\end{solution}

In general, $\posint\posA$ does not have a top or a bottom.

\vfill
\clearpage

\subsection{Set-based filtering}
\linkvideo{spring2021-tradeoffs:tradeoffs:orders:set-based-filtering} % Set-based filtering
\todojira{458}{\bernina:Expand.
    Need cute pictures of dynamics.
}
We now look at an example of \textbf{set-based filtering}, where filtering refers to online inference (recursive estimation).
Suppose that we want to track the value of a quantity~$x\setin \interv{0}{100}$, without having \emph{a priori} information about~$x$.
We are equipped with sensors, which periodically measure the quantity~$x$ with some variable precision.
At time~$t\setin \nonNegReals$ they produce an \emph{observation}~$y_t\colon x_t\setin \interv{l_t}{u_t}$.
Also, note that the quantity fluctuates randomly, and we bound its ``velocity'' to be~$\dot{x}_t\setin \interv\minusone\plusone$ (except at boundaries).
At the beginning, our information state~$\bar{i}_0$ could be that~$x\setin \interv{0}{100}$.
At time 0, we get an observation~$y_0$, that says~$x\setin \interv{21}{24}$.
The new information state can be obtained by ``fusing'' the two inputs we have received about~$x$.
This corresponds to the intersection
\begin{equation}\label{eq:filtering-2}
    \prfdoubleperiod{
        x\setin \left( \interv{0}{100} \setintersection \interv{21}{24}\right)
    }{
        x\setin \interv{21}{24}
    }
\end{equation}
Say we get an observation~$y_1$ which says~$x\setin \interv{19}{22}$.
We now need to take into account the evolution/dynamics of the quantity we are tracking.
From the interval~$\interv{21}{24}$ we know that the variable could have evolved in~$\interv{20}{25}$ (dynamics are bounded with a unit increase/decrease).
Therefore, the new information state is given by
\begin{equation}\label{eq:filtering-3}
    \prfdoubleperiod{
        x\setin \left( \interv{20}{25} \setintersection \interv{19}{22}\right)
    }{
        x\setin \interv{20}{22}
    }
\end{equation}
One of the structures which could sustain this kind of inference, is the \SY{poset} of twisted intervals  (\cref{def:poset_intervals}).

The Hasse diagram representing a situation related to this example could be as reported in \cref{fig:hasse_filtering}.
\begin{figure}[h!]
    \centering
    \includesag{080_hasse_filtering_bis}
    \caption{}
    \label{fig:hasse_filtering}
\end{figure}
