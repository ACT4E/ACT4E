% !TEX root = chapter-standalone.tex

\section{Style guide}
\subsection*{Text}

Avoid unnecessary words.

Bad: ``Let us define the set\dots''

Better: ``Define the set\dots''

Bad: ``Let's consider the functor\dots''

Better: ``Consider the functor\dots ''

\subsubsection*{No abbreviations}
Do not use ``\ie '', ``\eg '', ``etc.'', etc.

You can \emph{always} rephrase it better.

\subsubsection*{Speak the symbols}
Spell out symbols when in sentences.

Bad: ``For all~$\ela \setin \Obja$, $\exists \elb \setin \Objb$ such that \dots''

Better: ``For all elements $\ela$ of $\Obja$, we can find an element $\elb$ in $\Objb$ such that \dots''

\subsubsection*{Use easy to parse math}

Bad: ``For all $\ela\setin \Obja=\Emptyset$''

Better: ``If $\Obja$ is the empty set, then certainly for all its elements \dots''

\subsection*{Nomenclature}

\subsubsection*{Use the semantic commands for symbols}

We are in the course of defining abstract symbols.
For a poset, use $\posA,\posAleq$, not $P,\leq_P$.

When referring to a sets and functions outside a category theoretical context,   use $\ela,\elb,\elc$, $\setA,\setB,\setC$, and $\mapa,\mapb,\mapc$ macros.

When referring to objects and morphisms in a category,   use $\Obja,\Objb,\Objc$, and $\mora,\morb,\morc$.
%Deprecated: $\obja,\objb,\objc$.

\subsubsection*{Never use font families or other font styles in the text}

If you find that you need to use things like \texttt{mathrm} or \texttt{textsf} in the text, you should be defining a command for that.

\subsubsection*{Colors}

There is a section in the preamble where all colors are defined.

The definitions should be semantics: do not define \texttt{darkgreen}, define \texttt{fun\-ctionality}.

Note we might do a color-blind version where all the green becomes blue.

\subsubsection*{Arrow style}

I am thinking to have the thin arrow $\to$ used only for functions between sets, and use a ticker arrow $\pmb{\to}$ when indicating morphisms.
(Note: that is poor man's bold command \texttt{pmb}, we should find a better bold arrow.)

We consistently use colors for morphisms.

Example:
\begin{itemize}
    \item A function $f: A \to B$ from set $A$ to $B$.
    \item A morphism $g: X \mto  Y$
\end{itemize}

There's the argument that they should be the same because the functions are also morphisms.
But note that in the definitions themselves we need to distinguish between maps and morphisms.
For example, a functor $F$ is a map $F: \ObC \to \ObD$ and maps an $\alpha: \Obja \mtoin{\CatC} \Objb $ to $F(\alpha): F(\Obja) \mtoin{\CatD} F(\Objb) $.

If we write for a morphism $f: A \mto B$, then the graphics should also use the same arrow style $\mto$.

\section{Latex guidelines}

\subsection*{Define commands }

Define a command whenever you use the same thing for more than 3 times.

Also, it helps a lot to keep text and pics in sync.

DRY: don't repeat yourself.

\subsection{Define commands in the preamble }

Because the figures must be able to compile by themselves, always define the commands in the preamble, rather than the text.

\subsection{Using \str{cref}}

If you are citing multiple references, instead of
%
\begin{minted}{latex}
\dots this thing is true (\cref{fig:e6},~\cref{fig:e6-together}).
\end{minted}
%
use
%
\begin{minted}{latex}
\dots this thing is true (\cref{fig:e6, fig:e6-together}).
\end{minted}
%
This works also for equations:
%
\begin{minted}{latex}
Because of \cref{eq:one,eq:two,eq:three}
\end{minted}
%
Latex will do the smart thing and write ``Because of (1) to (3)''.

At the beginning of a sentence you should use uppercase \texttt{Cref}.
If you write
%
\begin{minted}{latex}
...and so on. \cref{fig:Setoid} shows that...
\end{minted}
%
Latex will produce ``\dots and so on.
fig 3.2 shows that \dots''.

If instead you use
\begin{minted}{latex}
\dots and so on. \Cref{fig:Setoid} shows that \dots
\end{minted}
Latex will produce ``\dots and so on.
Fig 3.2 shows that \dots''.

\subsection{Conditional inclusion}

You can use \str{iflabelexists} or \str{iflabeldoesnotexist}  to add content conditional on the existence of a label.

\begin{minted}{latex}
\iflabelexists{def:Setoid}{
    You can find a formal definition of setoid at \cref{def:Setoid}
}
\iflabeldoesnotexist{def:Setoid}{
    We do not give a formal definition of setoid.
}
\end{minted}

\subsection{Punctuating equations}

Always punctuate all equations!

For proof trees, you can use the ``right label function'' and add
%
\begin{quote}
    \centering
    \str{[r]{,}} \qquad or \qquad \str{[r]{.
    }}
\end{quote}
%
to the \str{prftree} command:
%
\begin{minted}{latex}
If this is true:
\begin{equation}
    \prftree[r]{,}{
        A
    }{
        B
    }
\end{equation}
then this might still be not true:
\begin{equation}
    \prftree[r]{.}{
        B
    }{
        A
    }
\end{equation}
\end{minted}
\begin{quote}
    If this is true:
    \begin{equation}
        \prftree[r]{,}{
            A
        }{
            B
        }
    \end{equation}
    then this might still be not true:
    \begin{equation}
        \prftree[r]{.
        }{
            B
        }{
            A
        }
    \end{equation}
\end{quote}

We also have some convenience functions, \str{\\prfperiod} and \str{\\prfcomma},
which also align the punctuation properly.

\begin{minted}{latex}
\begin{equation}
    \prfcomma{
        A
    }{
        B
    }
    \prfperiod{
        A
    }{
        B
    }
\end{equation}
\end{minted}
\begin{quote}
    \begin{equation}
        \prfcomma{
            A
        }{
            B
        }
        \prfperiod{
            A
        }{
            B
        }
    \end{equation}
\end{quote}

\subsection{Spacing for operators}

\str{mtimes} and relatives are defined as \str{mathrel}s.
Therefore, you should not use \str{\mtimes_X}.
Rather, use the macros \str{mthenof}, \str{mtimesof}, etc.

Bad:

\begin{minted}{latex}
\begin{equation}
    \sgrpmorA (\monela \mtimes_{\monoidA} \monelb)
    = \sgrpmorA (\monela) \mtimes_{\monoidB}  \sgrpmorA(\monelb),
\end{equation}
\end{minted}

\begin{equation}
    \sgrpmorA (\monela \mtimes_{\monoidA} \monelb) = \sgrpmorA (\monela) \mtimes_{\monoidB}  \sgrpmorA(\monelb),
\end{equation}

Good:

\begin{minted}{latex}
\begin{equation}
    \sgrpmorA (\monela \mtimesof\monoidA \monelb)
    = \sgrpmorA (\monela) \mtimesof\monoidB  \sgrpmorA(\monelb),
\end{equation}
\end{minted}

\begin{equation}
    \sgrpmorA (\monela \mtimesof\monoidA \monelb) = \sgrpmorA (\monela) \mtimesof\monoidB  \sgrpmorA(\monelb),
\end{equation}

\subsection{Allowing line breaks in lists of elements}

Use \str{\makeset} to write a list of elements.
This includes magic that allows latex to break at commas - which is not allowed by default.

Bad:

\begin{minted}{latex}
The set is \{a, b, c, d, e, f, g\}.
\end{minted}
\begin{widepar}
    \centering
    \includegraphics[height=2cm]{makeset0}
\end{widepar}

Better:

\begin{minted}{latex}
The set is \makeset{a, b, c, d, e, f, g}.
\end{minted}

\begin{widepar}
    \centering
    \includegraphics[height=2cm]{makeset1}
\end{widepar}

\subsection{Source formatting}

When you write chunks of text, do not use hard wraps.
% <-- period, newline
Let it flow.
% <-- period, newline
However, put a newline after every sentence, so it is easy to find where sentences start.
(Look at the source code for this.)

\subsection{Function definitions}

There are macros that allow nice formatting of function definitions.

There are three basic macros:
\str{defmap}, \str{defmapcomma}, \str{defmapperiod}.

They take 6 arguments:
\begin{enumerate}
    \item Name of function
    \item Domain
    \item Arrow symbol
    \item Codomain
    \item Element pattern
    \item Result
\end{enumerate}

The macros \str{defmapcomma}, \str{defmapperiod} add punctuation.
This separates semantics from presentation, and also allows to remove the punctuation when rendering the equation by itself (to be implemented).

\begin{widepar}
    \begin{tabular}{|c|c|c|}%
        \hline
        \begin{minipage}{0.3\textwidth}
            \begin{minted}{latex}
\begin{equation}
    \defmap{
        f
    }{
        X
    }{
        \mto
    }{
        Y
    }{
        x
    }{
        x + 2
    }
\end{equation}
            \end{minted}
        \end{minipage}
         &
        \begin{minipage}{0.3\textwidth}
            \begin{minted}{latex}
\begin{equation}
    \defmapcomma{
        f
    }{
        X
    }{
        \mto
    }{
        Y
    }{
        x
    }{
        x + 2
    }
\end{equation}
            \end{minted}
        \end{minipage}
         &
        \begin{minipage}{0.3\textwidth}
            \begin{minted}{latex}
\begin{equation}
    \defmapperiod{
        f
    }{
        X
    }{
        \sto
    }{
        Y
    }{
        x
    }{
        x + 2
    }
\end{equation}
            \end{minted}
        \end{minipage}
        \\
        \begin{minipage}{0.3\textwidth}
            \begin{equation*}
                \defmap{
                    f
                }{
                    X
                }{
                    \mto
                }{
                    Y
                }{
                    x
                }{
                    x + 2
                }
            \end{equation*}
        \end{minipage}
         &
        \begin{minipage}{0.3\textwidth}
            \begin{equation*}
                \defmapcomma{
                    f
                }{
                    X
                }{
                    \mto
                }{
                    Y
                }{
                    x
                }{
                    x + 2
                }
            \end{equation*}
        \end{minipage}
         &
        \begin{minipage}{0.3\textwidth}
            \begin{equation*}
                \defmapperiod{
                    f
                }{
                    X
                }{
                    \sto
                }{
                    Y
                }{
                    x
                }{
                    x + 2
                }
            \end{equation*}
        \end{minipage}
        \\\hline
    \end{tabular}
\end{widepar}
Most of the maps we care about are either in \Set or \Pos.
Therefore, there are utility macros for those special cases that only take 5 arguments instead of six.

\begin{widepar}
    \begin{tabular}{rlll}
                       & must specify arrow                           & uses $\sto$            & uses $\toinPos$ \\
        arguments      & 6                                            & 5                      & 5 \\
        no punctuation & \str{\defmap}       & \str{\defmapset}       & \str{\defmappos} \\
        comma, comma   & \str{\defmapcomma}  & \str{\defmapcommaset}  & \str{\defmapcommapos} \\
        comma, period  & \str{\defmapperiod} & \str{\defmapperiodset} & \str{\defmapperiodpos} \\
    \end{tabular}
\end{widepar}

\begin{widepar}
    \begin{tabular}{|c|c|c|}%
        \hline
        \begin{minipage}{0.3\textwidth}
            \begin{minted}{latex}
\begin{equation}
    \defmapperiod{
        f
    }{
        X
    }{
        \mto
    }{
        Y
    }{
        x
    }{
        x + 2
    }
\end{equation}
            \end{minted}
        \end{minipage}
         &
        \begin{minipage}{0.3\textwidth}
            \begin{minted}{latex}
\begin{equation}
    \defmapperiodset{
        f
    }{
        X


    }{
        Y
    }{
        x
    }{
        x + 2
    }
\end{equation}
            \end{minted}
        \end{minipage}
         &
        \begin{minipage}{0.3\textwidth}
            \begin{minted}{latex}
\begin{equation}
    \defmapperiodpos{
        f
    }{
        X


    }{
        Y
    }{
        x
    }{
        x + 2
    }
\end{equation}
            \end{minted}
        \end{minipage}
        \\
        \begin{minipage}{0.3\textwidth}
            \begin{equation*}
                \defmapperiod{
                    f
                }{
                    X
                }{
                    \mto
                }{
                    Y
                }{
                    x
                }{
                    x + 2
                }
            \end{equation*}
        \end{minipage}
         &
        \begin{minipage}{0.3\textwidth}
            \begin{equation*}
                \defmapperiodset{
                    f
                }{
                    X
                }{
                    Y
                }{
                    x
                }{
                    x + 2
                }
            \end{equation*}
        \end{minipage}
         &
        \begin{minipage}{0.3\textwidth}
            \begin{equation*}
                \defmapperiodpos{
                    f
                }{
                    X
                }{
                    Y
                }{
                    x
                }{
                    x + 2
                }
            \end{equation*}
        \end{minipage}
        \\\hline
    \end{tabular}
\end{widepar}

\vfill\pagebreak

\paragraph{Sets}
There is the command \str{\makeset} to create sets:
\begin{minted}{latex}
    \makeset{A,B,C,D}
\end{minted}
\begin{equation}
\makeset{A,B,C,D}
\end{equation}
There is also the command \str{\makesett} to match the parentheses size, and the command\linebreak[1] \str{\makesetBig} to just have big parentheses.
\begin{equation}
    \makesett{A, B, \rule{1pt}{10pt}}
    \qquad
    \makesetBig{A, B, i}
\end{equation}


Also, we have \str{\opensetbracket} $\opensetbracket$ and \str{\closesetbracket} $\closesetbracket$ which are useful in align environments.
% \begin{minted}{latex}
%     \tupp{A,B,C,D}
% \end{minted}
% \begin{equation}
%     \tupp{A,B,C,D}
% \end{equation}
\paragraph{Tuples and cartesian product}
Here, $a\setin \setA, b \setin \setB, c \setin \setC$. The command \str{\tup} creates the tuple. The command \str{\makecartprod} makes the cartesian product.
\begin{minted}{latex}
    \tup{a,b,c} \setin (\makecartprod{\setA, \setB, \setC})
\end{minted}
\begin{equation}
    \tup{a,b,c} \setin (\makecartprod{\setA, \setB, \setC})
\end{equation}

% \begin{minted}{latex}
%     \makesett{A,B,C,D}
% \end{minted}
% \begin{equation}
% \makesett{A,B,C,D}
% \end{equation}
% \begin{minted}{latex}
%     \makesetBig{A,B,C,D}
% \end{minted}
% \begin{equation}
% \makesetBig{A,B,C,D}
% \end{equation}
\paragraph{Lists}
Here, $a, b, c, d$ are generic elements that go in a list.
\begin{minted}{latex}
    \makelist{a,b,c,d}
\end{minted}
\begin{equation}
\makelist{a,b,c,d}
\end{equation}
\paragraph{Set lists}
Here, $\setA, \setB, \setC, \setD$ are \textbf{generic sets}.
\begin{minted}{latex}
    \makeTupcat{\setA,\setB,\setC,\setD}
\end{minted}
\begin{equation}
    \makeTupcat{\setA,\setB,\setC,\setD}
\end{equation}
Another one:
\begin{minted}{latex}
    \cObj{a,b,c}
\end{minted}
\begin{equation}
    \cObj{a,b,c}
\end{equation}

\paragraph{Lists of sets}
Here, $A, B, C$ are \textbf{lists of sets}.
\begin{minted}{latex}
    \makecprod{A,B,C}
\end{minted}
\begin{equation}
\makecprod{A,B,C}
\end{equation} 

Here, $a \setin A, b \setin B, c \setin C$ are \textbf{tuples}.
\begin{minted}{latex}
    (\maketupconcat{a,b,c}) \in (\makecprod{A,B,C})
\end{minted}
\begin{equation}
(\maketupconcat{a,b,c}) \in (\makecprod{A,B,C})
\end{equation}




\vfill\pagebreak

\subsection{Graphics}

\subsubsection*{Use separate tikz files for different graphics}

Have only one tikz picture for file.
Do not put \texttt{hspace} or \texttt{hfill} commands to separate graphics.

If you want to put graphics side by side, you should use subfigures, which come with labels and caption.

\subsubsection*{Arrow styles}

We should use different arrow styles for different purposes,
and we should be consistent.

For axes in diagrams, use ``-latex'' style.

For signal flow diagrams, use an arrow with a triangle as the tip (not rounded like the latex style.)

Whatever style we use in the text for the morphisms arrows, it should be the same for the Tikz figure.

\vfill\pagebreak
\subsection{Main Colors used}

\begin{center}
    \begin{tabular}{ll}
        Sets                               & \coloredbox{formulasetcolor} \\
        Elements                           & \coloredbox{elementscolor} \\
        Lists of sets                      & \coloredbox{formulasetLcolor} \\
        Objects                            & \coloredbox{objects} \\
        Morphisms                          & \coloredbox{morphisms} \\
        Functors                           & \coloredbox{functors} \\
        Natural Transformations            & \coloredbox{naturaltransformations} \\
        Background for set graphics        & \coloredbox{setcolor} \\
        Border for set graphics            & \coloredbox{setcolorbord} \\
        Background for poset graphics      & \coloredbox{posetcolor} \\
        Border for poset graphics          & \coloredbox{posetcolorbord} \\
        Background for categories graphics & \coloredbox{catcolor} \\
        Background for graph graphics      & \coloredbox{graphcolor} \\
        Border for graph graphics          & \coloredbox{graphcolorbord} \\
        Upper                              & \coloredbox{upcolor} \\
        Lower                              & \coloredbox{downcolor} \\
        Antichain                          & \coloredbox{antichaincolor} \\
        Functionalities                    & \coloredbox{functionality} \\
        Resources                          & \coloredbox{requirements} \\
        Implementations                    & \coloredbox{implementations} \\
        Transmuter                         & \coloredbox{transmuter} \\
        Transmuted                         & \coloredbox{transmuted}
    \end{tabular}
\end{center}
