% !TEX root = chapter-standalone.tex

% \section{The duality of design}

\section{Galois connections}\label{subsec:galois-connections}

\begin{ctdefinition}[Monotone Galois Connection]
    A \emph{\iindex{monotone Galois connection}} between posets~$\posA$ and~$\posB$ is a pair of monotone maps~$\mapa\colon \posA\to \posB$ and~$\mapb\colon \posB\to \posA$ such that for all~$\posAel\setin \posA$,~$\posBel\setin \posB$:
    \begin{equation}
        \prfdoubleperiod{\mapa(\posAel) \posBleq \posBel}{\posAel \posAleq \mapb(\posBel)}
        %\mapa(\posAel) \posBleq \posBel \quad \Leftrightarrow \quad \posAel \posAleq \mapb(\posBel).
    \end{equation}
    This is equivalent to ask, for all~$\posAel\setin \posA$,~$\posBel\setin \posB$, that:
    \begin{equation}
        (\posAel\posAleq \mapb(\mapa(\posAel)))
        \booland (\posBel\posBleq \mapa(\mapb(\posBel))).
    \end{equation}
\end{ctdefinition}

\begin{ctdefinition}[Antitone Galois Connection]
    An \emph{\iindex{antitone Galois connection}} between~$\posA$ and~$\posB$ is a pair of antitone maps $\mapa\colon \posA\to \posB$ and $\mapb \colon \posB\to \posA$ such that for all~$\posAel\setin \posA$, $\posBel\setin \posB$:
    \begin{equation}
        \prfdoubleperiod{\posBel \posBleq \mapa(\posAel)}{\posAel \posAleq \mapb(\posBel)}
        %\posBel \posBleq \mapa(\posAel) \quad \Leftrightarrow \quad \posAel \posAleq \mapb(\posBel).
    \end{equation}
    This is equivalent to ask for all~$\posAel\setin \posA$,~$\posBel\setin \posB$:
    \begin{equation}
        (\posAel \posAleq \mapb(\mapa(\posAel)))
        \booland  (\posBel \posBleq \mapa(\mapb(\posBel))).
    \end{equation}
\end{ctdefinition}

\todotextjira{405}{\bernina: @Gioele: GZ: Adjust given new flow.
    We don't know what this is yet.
}
Consider a boolean map~$d\colon \posA\op \times \posB \toinPos \Bool$.
We can define the maps that work on single functionality and resources:
%
\begin{equation}
    \begin{aligned}
        \theta\colon \posA & \to \posUB \\
        \posAel            & \mapsto \makeset{\posBel\setin \posB \colon d(\posAopel, \posBel) },
    \end{aligned}
\end{equation}
%
\begin{equation}
    \begin{aligned}
        \psi\colon \posB & \to \posLA \\
        \posBel          & \mapsto \makeset{\posAel\setin \posA \colon d(\posAopel, \posBel) }.
    \end{aligned}
\end{equation}
We can define the maps that work on multiple functionality and resources:
\begin{equation}
    \label{eq:galoisalfa}
    \begin{aligned}
        \alpha\colon \posLA & \to \posUB \\
        S                   & \mapsto \makeset{\posBel\setin \posB \colon \exists \posAel\setin S\colon \ d(\posAel,\posBel)},
    \end{aligned}
\end{equation}
Alternatively, we can write
\begin{equation}
    \begin{aligned}
        \alpha \colon \posLA & \to \posUB \\
        S                    & \mapsto \bigsetunion_{\posAel\setin S} \theta(\posAel).
    \end{aligned}
\end{equation}
%
\begin{equation}
    \label{eq:galoisbeta}
    \begin{aligned}
        \beta\colon \posUB & \to \posLA \\
        T                  & \mapsto \makeset{\posAel\setin \posA  \colon \exists \posBel\setin T\colon d(\posAel,\posBel)},
    \end{aligned}
\end{equation}
%
\noindent Alternatively, we can write
\begin{equation}
    \begin{aligned}
        \beta \colon \posUB & \to \posLA \\
        T                   & \mapsto \bigsetunion_{\posBel\setin T} \psi(\posBel).
    \end{aligned}
\end{equation}
%
\begin{equation}
    \label{eq:galoisdelta}
    \begin{aligned}
        \delta \colon \posLA & \to \posUB \\
        S                    & \mapsto \makeset{\posBel\setin \posB \colon \forall {\posAel\setin S}\colon d(\posAel,\posBel)},
    \end{aligned}
\end{equation}
Alternatively, we can write
\begin{equation}
    \begin{aligned}
        \delta\colon \posLA & \to \posUB \\
        S                   & \mapsto \bigsetintersection_{\posAel\setin S}\theta(\posAel).
    \end{aligned}
\end{equation}
%
\begin{equation}
    \label{eq:galoisgamma}
    \begin{aligned}
        \gamma \colon \posUB & \to \posLA \\
        T                    & \mapsto \makeset{\posAel\setin \posA \colon \forall {\posBel\setin T}\colon d(\posAel,\posBel)},
    \end{aligned}
\end{equation}
Alternatively, we can write
\begin{equation}
    \begin{aligned}
        \delta\colon \posUB & \to \posLA \\
        T                   & \mapsto \bigsetintersection_{\posBel\setin T}\psi(\posBel).
    \end{aligned}
\end{equation}
%
Properties of these maps are reported in \cref{tab:galoisproperties}.

\begin{table*}[h!]
    \centering
    \begin{tabular}{c|l|l|c|c|c|c|c}
        $\star$  & X                                   & Y        & $\star(\bot)$                             & $\star(\postop)$                           & $A\posleq_X B$                      & $\star(A\vee_X B)$ & $\star(A\wedge_X B)$ \\
        \hline
        $\alpha$ & $\posLA$                            & $\posUB$ & $\alpha(\Emptyset)=\Emptyset$             & $\alpha(\posA)\geq_{\posUB} \alpha(\cdot)$
                 & $\alpha(A)\geq_{\posUB} \alpha(B)$
                 & $\alpha(A)\vee_{\posLA}\alpha(B)$
                 & $\alpha(A)\wedge_{\posLA}\alpha(B)$ \\
        \hline
        $\beta$  & $\posUB$                            & $\posLA$ & $\beta(\posB)\geq_{\posLA}\beta(\cdot)$   & $\beta(\Emptyset)=\Emptyset$
                 & $\beta(A)\geq_{\posLA} \beta(B)$
                 & $\beta(A)\vee_{\posLA}\beta(B)$
                 & $\beta(A)\wedge_{\posLA}\beta(B)$ \\
        \hline
        $\delta$ & $\posLA$                            & $\posUB$ & $\delta(\Emptyset)=\posB$                 & $\delta(\posA)\geq_{\posUB}\delta(\cdot)$  & $\delta(A)\leq_{\posUB} \delta(B)$
                 & $\delta(A)\wedge_{\posUB}\delta(B)$
                 & $\delta(A)\vee_{\posUB}\delta(B)$ \\
        \hline
        $\gamma$ & $\posUB$                            & $\posLA$ & $\gamma(\posB)\leq_{\posLA}\gamma(\cdot)$ & $\gamma(\Emptyset)=\posA$                  & $\gamma(A) \leq_{\posLA} \gamma(B)$
                 & $\gamma(A)\wedge_{\posLA}\gamma(B)$
                 & $\gamma(A)\vee_{\posLA}\gamma(B)$
    \end{tabular}
    \caption{Properties of $\alpha,\beta,\delta,\gamma$}
    \label{tab:galoisproperties}
\end{table*}

\begin{lemma}
    \label{lem:deltagammamonotone}
    $\delta$ and $\gamma$ are monotone maps.
\end{lemma}
\begin{proof}
    We first prove that~$\delta$ is a monotone map.
    Given~$A,B\setin \posLA$ with~$A\setsubseteq B$, we have
    \begin{equation}
        \begin{aligned}
            \delta(A) & =\makeset{\posBel\setin \posB\colon \forall \posAel \setin A\colon d(\posAel,\posBel)} \\
                      & \setsupseteq \makeset{\posBel\setin \posB\colon \forall \posAel\setin B \colon d(\posAel,\posBel)} \\
                      & =\delta(B),
        \end{aligned}
    \end{equation}
    meaning that~$A\posleqof{\posLA} B \Imp \delta(A)\posleqof{\posUB} \delta(B)$.
    We now prove that~$\gamma$ is a monotone map.
    Given~$C,D\setin \posUB$, with~$C\setsupseteq D$, we have
    \begin{equation}
        \begin{aligned}
            \gamma(C) & =\makeset{\posAel\setin \posA\colon \forall \posBel \setin C\colon d(\posAel,\posBel)} \\
                      & \setsubseteq \makeset{\posAel\setin \posA\colon \forall \posBel \setin D \colon d(\posAel,\posBel)} \\
                      & =\gamma(D),
        \end{aligned}
    \end{equation}
    meaning that~$C\posleqof{\posUB} D \Imp \gamma(C)\posleqof{\posLA} \gamma(D)$.
\end{proof}

\begin{lemma}
    \label{lem:alfabetaantitone}
    $\alpha$ and $\beta$ are antitone maps.
\end{lemma}
\begin{proof}
    We first prove that~$\alpha$ is an antitone map.
    Given~$A,B\setin \posLA$, with~$A\setsubseteq B$, we have
    \begin{equation}
        \begin{aligned}
            \alpha(A) & =\makeset{ \posBel\setin \posB \colon \exists \posAel\setin A\colon d(\posAel,\posBel)} \\
                      & \setsubseteq \makeset{\posBel\setin \posB \colon \exists \posAel\setin B\colon d(\posAel,\posBel)} \\
                      & =\alpha(B),
        \end{aligned}
    \end{equation}
    meaning that~$A\posleqof{\posLA} B\Imp \alpha(A) \posgeq_{\posUB} \alpha(B)$.
    We now prove that~$\beta$ is an antitone map.
    Given~$C,D\setin \posUB$, with~$C\setsupseteq D$, we have
    \begin{equation}
        \begin{aligned}
            \beta(C) & =\makeset{\posAel\setin \posA\colon \exists \posBel\setin C\colon d(\posAel,\posBel)} \\
                     & \setsupseteq \makeset{\posAel\setin \posA\colon \exists \posBel\setin D \colon d(\posAel,\posBel)} \\
                     & =\beta(D),
        \end{aligned}
    \end{equation}
    meaning that~$C\posleqof{\posUB} D \Imp \beta(C)\posgeq_{\posUB} \beta(D)$.
\end{proof}

\begin{lemma}
    $(\delta, \gamma)$~forms a \textbf{monotone}
    Galois connection between~$\posLA$ and~$\posUB$.
\end{lemma}
\begin{proof}
    In~\cref{lem:deltagammamonotone} we proved that~$\delta$ and~$\gamma$ are monotone maps.
    We now need to show that for any lower set~$L\setsubseteq \posA$ of functionalities and upper set $U\setsubseteq \posB$ of resources, we have
    \begin{equation}
        L\setsubseteq\gamma(U) \iff \delta(L)\setsupseteq U
    \end{equation}
    The left-hand side says that if~$\posAel\setin L$, then for all~$\posBel \setin U$ we have $d(\posAel,\posBel)=\true$.
    The right-hand side says that if~$\posBel\setin U$ then for all~$\posAel \setin L$,~$d(\posAel,\posBel)=\true$.
    Both are equivalent to~$\forall \posAel\setin L,\posBel\setin U$: $d(\posAel,\posBel)=\true$, and hence to each other.
    In formulas:
    \begin{equation}
        \begin{aligned}
            L \setsubseteq \gamma(U) & \equiv L\setsubseteq \makeset{\posAel \setin \posA\colon \forall \posBel\setin U\colon d(\posAel,\posBel)} \\
                                     & \equiv \forall \posAel\setin L, \posBel\setin U \colon d(\posAel,\posBel)=\true \\
                                     & \equiv \forall \posBel\setin U, \posAel\setin L \colon d(\posAel,\posBel)=\true \\
                                     & \equiv U\setsubseteq \makeset{\posBel\setin \posB\colon \forall \posAel\setin L\colon d(\posAel,\posBel)=\true } \\
                                     & \equiv U\setsubseteq \delta(L).
        \end{aligned}
    \end{equation}
\end{proof}
% We need to prove that, for $a\setin F$, $b\setin R$:
% \begin{equation}
% \label{eq:gammadeltafirst}
%     a\leq_{LF} \gamma(\delta(a)),
% \end{equation}
% and
% \begin{equation}
% \label{eq:gammadeltasec}
% b\geq_{UR}\delta(\gamma(b))
% \end{equation}
% \begin{itemize}
%     \item Let's start from \cref{eq:gammadeltafirst}. We know that $a\leq_{LF} \gamma(\delta(a))$ means $a\setsubseteq \gamma(\delta(a))$. Assume this is not true, \ie  $\exists x\setin a \colon (x\setin a)\wedge (x \not\setin \gamma(\delta(a)))$. Following \cref{eq:galoisdelta}, we know that if $y\setin \delta(a)$, $d(x',y)=\true \ \forall x'\setin a$. Following \cref{eq:galoisgamma}, we know that if $w\setin \gamma(\delta(a))$, $d(w,y)=\true \ \forall y\setin \delta(a)$. But from before, we know that for each $y\setin \delta(a)$, we have $d(x',y)=\true$, for all $x'\setin a$, meaning that $\gamma(\delta(a))$ must include $x'$, $\forall x' \setin a$. This contradicts the initial assumption.
%     \item Let's continue with \cref{eq:gammadeltasec}. We know that $b\geq_{UR} \delta(\gamma(b))$ means $b \setsubseteq \delta(\gamma(b))$. Assume this is not true, \ie  $\exists x\setin b\colon (x\setin b)\wedge (x \not\setin \delta(\gamma(b)))$. From \cref{eq:galoisgamma}, we know that if $y \setin \gamma(b)$, $d(y,x')=\true$, for all $x'\setin b$. Following \cref{eq:galoisdelta}, we know that if $w\setin \delta(\gamma(b))$, $d(y,w)=\true$, for all $y\setin \gamma(b)$. But from before, we know that for each $y\setin \gamma(b)$, we have $d(y,x')=\true$, for all $x'\setin b$, meaning that $\delta(\gamma(b))$ must include $x'$, $\forall x' \setin b$. This contradicts the initial assumption.
% \end{itemize}

\begin{lemma}
    $(\alpha, \beta)$ does not form an \textbf{antitone}
    Galois connection between~$\posLA$ and~$\posUB$.
\end{lemma}
\begin{proof}
    In~\cref{lem:alfabetaantitone} we have proved that$\alpha$ and~$\beta$ are antitone maps.
    For~$L\setin \posA$,~$U\setin \posB$, we want to show that the following does not hold:
    \begin{equation}
        \label{eq:alfabetafirst}
        L\setsubseteq \beta(\alpha(L))
    \end{equation}
    and
    \begin{equation}
        \label{eq:alfabetasec}
        U\setsupseteq \alpha(\beta(U)).
    \end{equation}
    %

    \paragraph{Example}
    Consider~$d$ as the design problem which is always not feasible (the empty profunctor), which means~$d(\posAel,\posBel)=\false$,~$\forall \posAel\setin \posA,\posBel\setin \posB$.
    Take any~$L\setin \posA$.
    We know that~$\alpha(L)=\Emptyset$, and~$\beta(\alpha(L))=\beta(\Emptyset)=\Emptyset$.
    But~$L\setsubseteq \Emptyset$ is not true.
\end{proof}

