% !TEX root = chapter-standalone.tex


 \setboolean{debugimages}{false}

\section{\statusdraft{Putting things together}}

\begin{figure*}[p]
  \centering
%\includepdf[scale=0.8,pages={22-26},nup=1x3,frame,pagecommand={}]{ACT4E-09-design.pdf}
  \fbox{\includegraphics[trim=70 90 80 80,clip,height=0.9\textheight]{lego-patent-embed.pdf}}
  \caption{The 1961 Lego patent.}
\end{figure*}

The first encounter children have with composition is with toy blocks like Lego. It is a coincidence that there is a \emph{lego} in \emph{intellego};
the lego in Lego is a contraction from Danish \emph{leg godt}, which means \emph{to play well}.

Legos are compositional in this sense: when you put together two blocks, you can treat the ensemble as one block for the purpose of composing it with other blocks.


\begin{equation}
\prftree{
    \text{ingredient}
}{
    \text{ingredient}
}{
    \text{ingredient}
}{
    \text{result} \quad \quad \text{result}
}
\end{equation}

\begin{equation}
\prftree{\legob{red1}}{a}{b}
\end{equation}
\begin{equation}
\prftree{\legob{red1}}{\legob{white1}}{\legob{red1-white1}}
\end{equation}
%
\begin{equation}
\prftree{\legob{white1}}{\legob{red1}}{\legob{white1-red1}}
\end{equation}

\begin{equation}
\prftree{\legob{red1}}{\legob{white1}}{\legob{blue1}}{\legob{red1-white1-blue1}}
\end{equation}

\begin{equation}
\prftree{\legob{red1-white1-blue1}}{\legob{red1}\quad\legob{white1}\quad \legob{blue1} }
\end{equation}


\begin{equation}
\prftree{\legob{red1}\quad\legob{white1}\quad \legob{blue1}}{\legob{blue1}\quad\legob{red1}\quad \legob{white1} }
\end{equation}


\todographics{Here we need 3 symmetric bars... how to do it?}
\begin{equation}
\prftree{\legob{red1-white1-blue1}}{\legob{red1}\quad\legob{white1}\quad \legob{blue1} }
\end{equation}
\hrule
\begin{equation}
\prftree{\legob{blue1}}{\legob{red1}}{\legob{white1}}{\legob{blue1-red1-white1}}
\end{equation}

\begin{equation}
\prftree{\legob{red1-white1-blue1}}{\legob{blue1-red1-white1}}
\end{equation}

\begin{equation}
\prftree{\legob{red1}}{\legob{red1}}{\legob{red1}}{\legob{red1-red1-red1}}
\end{equation}

\begin{equation}
\prftree{\legob{red1-red1-red1}}{\legob{red1}\quad\legob{red1}\quad\legob{red1}}
\end{equation}

\begin{equation}
\prftree[double]{\legob{red1}}{\legob{red1}}{\legob{red1}}{\legob{red1-red1-red1}}
\end{equation}

\begin{equation}
\prftree{\legob{red1-red1-red1}}{\legob{red3}}
\end{equation}



\begin{equation}
\prftree[double]{\legob{red1}}{\legob{red1}}{\legob{red1}}{\legob{red3}}
\end{equation}


\begin{equation}
\prftree{\legob{blue1}}{\legob{red1}}{\legob{white1}}{\legob{grey3}}
\end{equation}


For example, you can take 3 blocks of dimension~$1/3 \times 2 \times 4$ and compose them together to obtain one block of dimension~$1 \times 2 \times 4$. This composed block works the same as one primitive ~$1 \times 2 \times 4 $ block:



lego purist

\begin{center}
\includesag{colors-purist}
\end{center}

mixing paint

\begin{center}
\includesag{colors-mixing}
\end{center}

RGB additivte

\begin{center}
\includesag{colors-additive}
\end{center}

Subtractive

\begin{center}
\includesag{colors-subtractive}
\end{center}

Paint over it

\begin{center}
\includesag{colors-paint-over}
\end{center}

Quoting

\includegraphics[width=0.5\textwidth]{quoting}


abstraction

\includegraphics[width=0.5\textwidth]{abstraction}

theorems

\includegraphics[width=0.5\textwidth]{theorems1}
\includegraphics[width=0.5\textwidth]{theorems2}

commutativity

\includegraphics[width=0.5\textwidth]{commutativity}


associativity

\includegraphics[width=0.5\textwidth]{associativity}

\includegraphics[width=0.5\textwidth]{associativity-lego}

summary table

\begin{center}
\includesag{colors-table}
\end{center}
%
%Example from slide 12:
%%\prflinethickness=3pt by adding this between proofs you can increase thickness, but somehow I cannot find a way to increase the middle one
%\begin{equation*}
%\prftree{\prftree{\stain{staincola}}{\stainfilled}}{\prftree{\stainfilled}{\stain{staincolf}}}{\prftree{\stain{staincola}}{\stain{staincolf}}}
%\end{equation*}

Example from slide 17:

\comma{\stain{staincola}}{\legob{grey2}}

\comma{\stain{staincolf}}{\legob{grey1}}

\begin{equation*}
\prfinterspace=1cm%
\prftree{\prftree{\stain{staincola}}{\stain{staincolf}}{\stainfilled}}
{\prftree{\legob{grey2}}{\legob{grey1}}\legob{grey3}}}
{\prfinterspace=1.5cm \prftree{\comma{\stain{staincola}}{\legob{grey2}}}{\comma{\stain{staincolf}}{\legob{grey1}}}{\comma{\stainfilled}{\legob{grey3}}}}
\end{equation*}

\subsection{Isomorphisms}


\begin{equation}
\prftree{\legob{red1}}{\legob{red1}}{\legob{red1-red1}}
\end{equation}


\begin{equation}
\prftree{\legob{white1}}{\legob{white1}}{\legob{white1-white1}}
\end{equation}


\begin{equation*}
\prftree{\rope{ropecola}{ropecolb}{2}{0}{0}{1}{$a$}}
{\rope{ropecola}{ropecolb}{2}{0}{0}{1}{$b$}}
{\rope{ropecola}{ropecolb}{4}{0}{0}{1}{$a+b$}}
\end{equation*}

\includegrpahics[width=0.3\textwidth]{account}

\begin{equation*}
\prftree{\rope{ropecola}{ropecolb}{2}{0}{0}{0.75}{$a+k$}}
{\rope{ropecola}{ropecolb}{2}{0}{0.25}{1}{$k+b$}}
{\rope{ropecola}{ropecolb}{4}{0}{0}{1}{$a+b$}}
\end{equation*}

\begin{equation*}
\prftree{\rope{ropecola}{ropecolb}{2}{0}{0.25}{0.75}{$k+a+k$}}
{\rope{ropecola}{ropecolb}{2}{0}{0.25}{0.75}{$k+b+k$}}
{\rope{ropecola}{ropecolb}{4}{0}{0.25}{0.75}{$k+a+b+k$}}
\end{equation*}


Do you know the game ``spot the 5 differences''? In this book we are going to play the opposite game, which is ``spot how different things are the same at some level of abstraction''.


Let~$\cordG{c}$ be an extension cord of length~$c$.

If you have an extension cord of length~$c$ and another of length~$d$, you can plug them together to get an extension cord of length~$c+d$.

\begin{equation}
  \label{eq:cords}
  \prftree{\cordG{c}}{\cordG{d}}{\cordG{c+d}}
\end{equation}

The rule for extension cords is similar to the rule for Lego blocks.
%
%\begin{equation}
%  \frac{\text{extension cord of length }\ c \qquad \text{extension cord of length }\ d }{%
%    \text{extension cord of length }\ (c+d)%
%  }
%\end{equation}


Extension cords are a bit more general: Lego blocks are constrainted to have a height that is a multiple of~$1/3$ of brick,  but extension cords can have any continuous value as length.

On the other hand, Lego blocks also have this other property of the horizontal section~$a \times b$.
We only gave rules for the connection of blocks of the same horizontal section.
What would be the equivalent for extension cords?


As you read this book and start to plan to visit Switzerland, at some point you need to buy some adapters.
Switzerland uses the connector of type~N (\cref{fig:TypeN}).
If you come from Ireland, your appliances use type~G (\cref{fig:TypeG}).

\begin{equation}
  \label{eq:irish-swiss}
  \prftree{\cord{\TypeIrish}{c}{\TypeIrish}}{\cord{\TypeIrish}{0}{\TypeSwiss}}{\cord{\TypeIrish}{c}{\TypeSwiss}}
\end{equation}

\begin{comment}
\devel{
  \begin{tikzpicture}
    \brick{4}{2}{cred}{0}{0}{0}{1}
  \end{tikzpicture}
  \hfill

  \begin{tikzpicture}
%\brick{3}{1}{yellow}{6}{0}{0}
%\brick{4}{2}{blue}{2}{0}{0}
%\brick{2}{4}{cred}{0}{0}{0}
%\brick{2}{4}{cred}{0}{1}{1}
    \brickcustom{4}{2}{pink}{4}{2}{0}{1}
    \brickcustom{4}{2}{blue}{4}{0}{0}{1}
    \brickcustom{4}{2}{green}{0}{2}{0}{1}
    \brickcustom{4}{2}{cred}{0}{0}{0}{0.33}
    \brickcustom{4}{2}{cwhite}{0}{0}{1}{0.33} % should be 0.33 instead of 1
    \brickcustom{4}{2}{cred}{0}{0}{2}{0.33} % should be 0.66 instead of 2
% 1) there is a problem with the pins
% GZ: yes, the problem arises because being dynamic with the heights, you need to be dynamic also with the pin positions. Now ajusted sith \weight, but still not optimal
% 2) can we make #6 absolute and not relative, so that it's x,y,z?
% GZ: can look into it, you want 0.33 instead of 1, with the same meaning as 7 right? (0.33 * \brickheight)
    \brickcustom{2}{4}{cwhite}{6}{0}{1}{1}

%\brickcustom{2}{4}{cred}{2}{0}{0}{6mm}
  \end{tikzpicture}
}

Here is one formal property of Lego: given two blocks of the same shape, you can always make a block of twice the shape.

More generally, to compose blocks in this way, you would only care about the lateral dimensions.
You can compose an~$a \times b \times c$ block with an ~$a \times b \times d$ block to obtain an~$a \times b \times( c + d)$ block.
Note that, for now,~$a$ and~$b$ are treated as labels, not as numbers.

We like to put this in formula as follows. We put the ingredients to the top, and the results at the bottom.

\begin{equation}
  \prftree{\text{block } a \times b \times c}{\text{block } a \times b \times d }{%
    \text{block } a \times b \times (c+d)
  }
\end{equation}

\paragraph{Extension cords}

It might have been a while since you played with Lego, but you are certainly familiar with plugs, sockets, and extension cords.



\begin{figure}
  \begin{center}
    \begin{tabular}{c@{\hskip 1cm}c@{\hskip 1cm}c@{\hskip 1cm}c@{\hskip 1cm}}
      \figplug{A} & \figplug{B} & \figplug{C} & \figplug{D} \\
      \figplug{E} & \figplug{F} & \figplug{G} & \figplug{H} \\
      \figplug{I} & \figplug{L} & \figplug{M} & \figplug{N}
    \end{tabular}
  \end{center}
  \caption{Plug/socket types used in the world}
  \label{fig:plugs}
\end{figure}
%
%\paragraph{Lego with colors}
%
%If you have legos of different colors, it becomes a bit more complicated. The rule now becomes:
%\begin{center}
%  \prftree{\begin{tikzpicture} \brickcustom{4}{2}{cred}{0}{0}{0}{0.33}\end{tikzpicture}}{\begin{tikzpicture} \brickcustom{4}{2}{cwhite}{0}{0}{0}{0.33}\end{tikzpicture}}{\begin{tikzpicture} \brickcustom{4}{2}{cblue}{0}{0}{0}{0.33}\end{tikzpicture}}
%  {\begin{tikzpicture}\brickcustom{4}{2}{cred}{0}{0}{0}{0.33}
%        \brickcustom{4}{2}{cwhite}{0}{0}{1}{0.33}
%        \brickcustom{4}{2}{cblue}{0}{0}{2}{0.33}\end{tikzpicture}}
%\end{center}
%
%\paragraph{Lego operations}
%
%There are also other ways you could compose the 3 blocks. You could slightly translate them, to create stairs.
%
%todographics{lego figure here: the 3 blocks composed in different ways, by some offset}
%
%You can also rotate them before composing.
%
%\todographics{lego figure here: the 3 blocks composed using rotations}
%
%What are the rules of this composition? Let's define a block as a solidly connected set of parallelipipedes (malformed cubes with different dimensions of the 3 sides). There are 3 kinds of faces: the faces pointing up, which have the pins, the faces pointing down, which have the holes for the pins, and the lateral faces.
%
%Connecting two blocks means that there should be at least one pin face of the lower block touching one hole face of the upper block; and, that there are no intersections of the solid blocks. Then, the ``interface'' of the blocks
%
%
%You can also put decorations; but if you do, you remove the possibility of connecting to all of them.
%
%\todographics{lego block with some decoration on top}
%
%  \section{Examples for Andrea}
%
\end{comment}



\devel{
  \begin{forslides}

    \begin{equation}
      \label{eq:lego-red1}
      \begin{tikzpicture}
        \brickcustom{4}{2}{cred}{0}{0}{0}{0.33} %<-- 7th argument for block height
      \end{tikzpicture}
    \end{equation}
    \begin{equation}
      \label{eq:lego-white1}
      \begin{tikzpicture}
        \brickcustom{4}{2}{cwhite}{0}{0}{0}{0.33} %<-- 7th argument for block height
      \end{tikzpicture}
    \end{equation}
    \begin{equation}
      \label{eq:lego-blue1}
      \begin{tikzpicture}
        \brickcustom{4}{2}{cblue}{0}{0}{0}{0.33} %<-- 7th argument for block height
      \end{tikzpicture}
    \end{equation}


    \begin{equation}
      \label{eq:lego-red1-white1}
      \begin{tikzpicture}
        \brickcustom{4}{2}{cred}{0}{0}{0}{0.33}
        \brickcustom{4}{2}{cwhite}{0}{0}{1}{0.33} % should be 0.33 instead of 1
      \end{tikzpicture}
    \end{equation}



    \begin{equation}
      \label{eq:lego-blue1-red1}
      \begin{tikzpicture}
        \brickcustom{4}{2}{cblue}{0}{0}{0}{0.33}
        \brickcustom{4}{2}{cred}{0}{0}{1}{0.33} % should be 0.33 instead of 1
      \end{tikzpicture}
    \end{equation}

    \begin{equation}
      \label{eq:lego-red1-red1}
      \begin{tikzpicture}
        \brickcustom{4}{2}{cred}{0}{0}{0}{0.33}
        \brickcustom{4}{2}{cred}{0}{0}{1}{0.33} % should be 0.33 instead of 1
      \end{tikzpicture}
    \end{equation}

    \begin{equation}
      \label{eq:lego-white1-white1}
      \begin{tikzpicture}
        \brickcustom{4}{2}{cwhite}{0}{0}{0}{0.33}
        \brickcustom{4}{2}{cwhite}{0}{0}{1}{0.33} % should be 0.33 instead of 1
      \end{tikzpicture}
    \end{equation}

    \begin{equation}
      \label{eq:lego-grey1-grey1}
      \begin{tikzpicture}
        \brickcustom{4}{2}{gray}{0}{0}{0}{0.33}
        \brickcustom{4}{2}{gray}{0}{0}{1}{0.33} % should be 0.33 instead of 1
      \end{tikzpicture}
    \end{equation}


    \begin{equation}
      \label{eq:lego-grey1}
      \begin{tikzpicture}
        \brickcustom{4}{2}{gray}{0}{0}{0}{0.33}
      \end{tikzpicture}
    \end{equation}


    \begin{equation}
      \label{eq:lego-grey3}
      \begin{tikzpicture}
        \brickcustom{4}{2}{gray}{0}{0}{0}{1}
      \end{tikzpicture}
    \end{equation}


    \begin{equation}
      \label{eq:lego-white1-red1}
      \begin{tikzpicture}
        \brickcustom{4}{2}{cwhite}{0}{0}{0}{0.33}
        \brickcustom{4}{2}{cred}{0}{0}{1}{0.33} % should be 0.33 instead of 1
      \end{tikzpicture}
    \end{equation}


    \begin{equation}
      \label{eq:lego-red1-white1-blue1}
      \begin{tikzpicture}
        \brickcustom{4}{2}{cred}{0}{0}{0}{0.33}
        \brickcustom{4}{2}{cwhite}{0}{0}{1}{0.33} % should be 0.33 instead of 1
        \brickcustom{4}{2}{cblue}{0}{0}{2}{0.33} % should be 0.66 instead of 2
      \end{tikzpicture}
    \end{equation}

    \begin{equation}
      \label{eq:lego-blue1-red1-white1}
      \begin{tikzpicture}
        \brickcustom{4}{2}{cblue}{0}{0}{0}{0.33}
        \brickcustom{4}{2}{cred}{0}{0}{1}{0.33} % should be 0.33 instead of 1
        \brickcustom{4}{2}{cwhite}{0}{0}{2}{0.33} % should be 0.66 instead of 2
      \end{tikzpicture}
    \end{equation}

    \begin{equation}
      \label{eq:lego-red1-red1-red1}
      \begin{tikzpicture}
        \brickcustom{4}{2}{cred}{0}{0}{0}{0.33}
        \brickcustom{4}{2}{cred}{0}{0}{1}{0.33} % should be 0.33 instead of 1
        \brickcustom{4}{2}{cred}{0}{0}{2}{0.33} % should be 0.66 instead of 2
      \end{tikzpicture}
    \end{equation}

    \begin{equation}
      \label{eq:lego-red3}
      \begin{tikzpicture}
        \brick{4}{2}{cred}{0}{0}{0}{1} %<-- 7th argument for block height
%  \brick{4}{2}{cred}{0}{0}{0.33}{0.33}
%  \brick{4}{2}{cred}{0}{0}{0.66}{0.33}
      \end{tikzpicture}
    \end{equation}


    \begin{equation}
      \label{eq:lego-gray3}
      \begin{tikzpicture}
        \brick{4}{2}{gray}{0}{0}{0}{1} %<-- 7th argument for block height
%  \brick{4}{2}{cred}{0}{0}{0.33}{0.33}
%  \brick{4}{2}{cred}{0}{0}{0.66}{0.33}
      \end{tikzpicture}
    \end{equation}
  \end{forslides}
}%\devel
