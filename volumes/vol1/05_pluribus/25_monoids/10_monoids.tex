% !TEX root = chapter-standalone.tex

\section{Monoids}
\label{sec:parallelism-monoids}
\linkvideo{spring2021-semi-mon-gro:monoids}

Algebraic structures are often defined in \emph{layers}.

For example, in the definition of  \SY{semigroup}, we start with a set~$\sgrpAset$ as a basic building block, and we add a layer of structure to it, namely a multiplication operation~$\mtimes \colon \sgrpAset \cartprod \sgrpAset \sto \sgrpAset$.
The multiplication operation for \SY{semigroups} was not only a new \emph{structure} which we added, but we also required this structure to obey a \emph{condition}, namely that it satisfies the \SY{associative law}.
One might also say that the multiplication operation was a new \emph{constituent} or a new \emph{datum}, and that satisfying the \SY{associative law} is a \emph{property}.

Mathematicians often use such words in an intuitive, non-rigorous way as a tool for structuring their thinking.
We will do the same.
For clarity, we will aim to stick with the words \emph{constituents} and \emph{conditions}.
Roughly speaking, we think of constituents as building blocks, and we think of conditions as rules for how those blocks fit together and behave.

Using the constituent \vs condition distinction we will, in particular, present some definitions in the following succinct, list-like fashion:

\todotextjira{454}{\bernina: Add more to submonoids subsection}
\begin{ctdefinition}[Monoid]
    \label{def:monoid}
    A \maindef{monoid}~$\monoidA$  is given by:
    \begin{body}
        \constit
        \begin{enumerate}
            \item A set~$\monoidAset$;
            \item A binary operation~$\mtimes  \colon \monoidAset \cartprod \monoidAset \sto \monoidAset$;
            \item A specified element~$\idmon \setin \monoidAset$, called \emph{neutral element}.
        \end{enumerate}
        \condit
        \begin{enumerate}
            \item Associative law:~$(\monela\mtimes  \monelb)\mtimes  \monelc=
                      \monela\mtimes  (\monelb\mtimes  \monelc) \quad  \forall \  \monela, \monelb, \monelc \setin \monoidAset$;
            \item Neutrality Laws:~$\idmon\mtimes \monela=\monela=\monela\mtimes  \idmon \quad  \forall \ \monela \setin \monoidAset $.
        \end{enumerate}
    \end{body}
\end{ctdefinition}

\begin{remark}
    The way that we presented the definition of a \SY{monoid} is certainly not unique.
    For example, we could have done the following.
    %
    \begin{quote}
        A \maindef{monoid}~$\monoidA$ is:
        \begin{body}
            \constit
            \begin{enumerate}
                \item a \SY{semigroup}~$\tup{\monoidAset, \mtimes}$;
                \item a specified element~$\idmon\setin \monoidAset$, called \emph{neutral element}.
            \end{enumerate}
            \condit
            \begin{enumerate}
                \item Neutrality laws:~$\idmon\mtimes \monela= \monela= \monela \mtimes \idmon$.
            \end{enumerate}
        \end{body}
    \end{quote}
    In this version, two constituents and one condition from \cref{def:monoid} are ``compressed'' into the information that we are using here a \SY{semigroup} as a constituent.
    This kind of ``compression'' has its pros and cons; depending on the context will use it to varying degrees.

    There is a similar dilemma when considering the software interfaces to describe these structures.
    In terms of software engineering, the two strategies are \emph{composition} (a \SY{monoid} has a \SY{semigroup} as a constituent) and \emph{inheritance} (a \SY{monoid} \emph{is} a \SY{semigroup} with additional data).

\end{remark}

\begin{remark}
    A \SY{monoid} is called \emph{commutative} (or: Abelian) if its underlying \SY{semigroup} is commutative.
\end{remark}

\subsection{Some examples}

\begin{example}
    Consider~$\tup{\reals,{{+}},0}$.
    This is a \SY{monoid}, since, for all~$\monela,\monelb, \monelc \setin \reals$, we have
    \begin{equation}
        (\monela+\monelb)
        +\monelc=\monela+(\monelb+\monelc),
    \end{equation}
    and
    \begin{equation}
        \monela+0=\monela=0+\monela.
    \end{equation}
    Similarly,~$\tup{\natnumbers, {{+}},0}$,~$\tup{\wnumbers, {{+}},0}$, and~$\tup{\ratnumbers, {{+}},0}$ are \SY{monoids}.
\end{example}

\begin{example}
    The set~$\wnumbers$, together with the operation of multiplication of whole numbers, forms a \SY{monoid}.
    The \SY{neutral element} is the number~$1$.
\end{example}

\begin{example}
    Given a set~\setA, the set~$\Endof\setA$ of functions from~\setA to~\setA comes ``naturally equipped'' with a \SY{monoid} structure: take \SY{monoid} composition to be function composition, and let the identity element be given by the identity function on~\setA.
\end{example}

\begin{example}
    \label{ex:bool_monoid}
    Consider~$\tup{\boolset,\booland}$ as in \cref{ex:bool_semigroup}, and consider~$\true$ as \SY{neutral element}.
    This forms a \SY{monoid}, since~$b\booland \true=b=\true \booland b$, for all~$b\setin \stylesets{B}$.
\end{example}

\begin{lemma}
    \label{lem:neut-el-unique}
    Let~$\tup{\sgrpAset, \mtimes}$ be a \SY{semigroup}.
    If there exists elements~$1 \setin \sgrpAset$ and~$1' \setin \sgrpAset$ such that~$\tup{\sgrpAset, \mtimes, 1}$ and~$\tup{\sgrpAset, \mtimes, 1'}$ are each \SY{monoids}, then~$1 = 1'$ must hold.
    In other words, the \SY{neutral element} of a \SY{monoid} is uniquely determined by the underlying \SY{semigroup} structure.
\end{lemma}

\begin{gradedexercise}[\exname{UniqueNeutralMonoid}]
    \label{ex:UniqueNeutralMonoid}
    Prove \cref{lem:neut-el-unique}.
\end{gradedexercise}

\solutionof{UniqueNeutralMonoid}

\begin{example}
    Consider~$\tup{\nonNegReals,\max,0}$.
    This is a \SY{monoid}, since, for all~$x,y\setin \nonNegReals$, we have:
    \begin{equation}
        \max(\max(\monela,\monelb),\monelc)=\max(\monela,\max(\monelb,\monelc)),
    \end{equation}
    and
    \begin{equation}
        \max(\monela,0)=\monela=\max(0,\monela).
    \end{equation}
\end{example}

\begin{remark}
    Note that in the above example, we could have just as well instead considered the set~$\reals_{\geq 7.5}$ of real numbers greater than $7.5$, together with ``$\max$'' as composition and~$7.5$ as \SY{neutral element}.
    In other words, we can choose any real number $a \setin \reals$ and obtain a  \SY{monoid}~$\tup{\reals_{\geq a},\max, a}$.
\end{remark}

\begin{example}
    $\tup{\natnumbers, \max,0}$ forms a \SY{monoid}.
\end{example}

\begin{definition}
    \label{def:set-of-lists}
    Let~\setA be a set.
    We denote by~$\listsof{\setA}$ the set of all lists of elements of~\setA.
\end{definition}

\begin{example}
    \label{exa:string-monoid}
    For any set~\setA, the set~$\listsof{\setA}$ of lists of elements of~\setA can naturally be equipped with a \SY{monoid} structure: composition is concatenation (just like in \cref{string-sgrp}), and the \SY{neutral element} is the empty list~$\maketypedlist{}{\setA}$.
    This \SY{monoid} is known as the \emph{free monoid} on the set~\setA.
\end{example}

%\section{Dynamical systems and monoids}
%
%\AC{in the end I would make this only a simple example of \SY{monoid} - no introduction of group etc.}
%\JL{inserting this here as an un-baked idea for a subsection. maybe it could be the first subsection of this chapter; that way idendity laws and associative laws can be introduced before talking about categories}
%\gray{
%  What are the simplest kinds of mathematical models of a dynamical system that we can think of?
%
%  One possible answer is something like this: we can describe a dynamical system as a set $S$ of possible states, together with a description of how states change over time.
%For the latter, consider time to be labeled by distinct ``points in time''.
%Then, we can just think in terms of time-steps, \eg  seconds, or we can think of points in time where \eg  an action is triggered and the system passes to a new state.
%
%  One thing we want to describe is how the state of our system changes over time, and in particular from one moment in time to the next.
%For any time step, we will not assume that we know what specific state the system is in, but rather we will describe, at once, all possible evolutions during that time step, \ie  we consider all possible initial conditions at once.
%Given two consecutive moments in time, we might describe the possible changes in the system by a function $T : S \rightarrow S$, which maps each state $s \setin S$ to a next state $T(s) \setin S$.
%This is a deterministic change of state: given $s$, the function $T$ determines the next state $T(s)$.
%The function $T$ is like a rule.
%Let's call $T$ an ``evolution operator'', because it describes how the system states might evolve over a time step.
%
%  We might want to consider various possible evolution operators.
%We could consider functions $T_a$, $T_b$, $T_c$, \etc.
%We can also compose these functions: given $T_a$ and $T_b$, we might have, over the course of two time steps, the change described by $T_a \circ T_b$.
%For simplicity, let's suppose we work with three evolution operations $T_a$, $T_b$, and $T_c$.

\subsection{Submonoids}

\todotext{\bernina: Add some text and some examples to this subsection}

\begin{definition}[Submonoids]\label{def:submonoids}
    Let~$\monoidA = \tup{\monoidAset, \mtimes, \idmon}$ be a \SY{monoid}.
    A \maindef{submonoid} of~$\monoidA$ is:

    \constit

    \begin{enumerate}
        \item A subset~$\monoidBset \setsubseteq \monoidAset$.
    \end{enumerate}

    \condit

    \begin{enumerate}
        \item The set~$\monoidBset$ is closed under the composition operation~$\mtimes$ from~$\monoidA$:
              \begin{equation}
                  \prfsemi{\monela \setin \monoidBset \quad \monelb \setin \monoidBset}{\monela \mtimes \monelb \setin \monoidBset}
              \end{equation}

        \item The \SY{neutral element}~$\idmon \setin \monoidAset$ is an element of~$\monoidBset$.
    \end{enumerate}
\end{definition}

\begin{example}
    $\tup{\natnumbers, +,0}$,~$\tup{\wnumbers, {{+}}, 0}$, and~$\tup{\ratnumbers, {{+}}, 0}$ are all submonoids of~$\tup{\reals, {{+}}, 0}$.
\end{example}

\begin{example}
    \natnumbers  is a \SY{submonoid} of~$\tup{\wnumbers, {{\cdot}}, 1}$.
\end{example}

\begin{example}
    $\makeset{ \ela \setin \natnumbers \mid \ela \text{ is even } }$ is a \SY{submonoid} of~$\tup{\natnumbers, {{+}}, 0}$, provided that~$0$ is considered an even natural number.
\end{example}

\section[Dynamical systems]{Dynamical systems and transition functions}

\todotext{\bernina: Split this section in its own file}

In this section we discuss an example of how \SY{monoids} are related to the evolution of a dynamical system in time.

\label{exa:transition-functions}
\begin{definition}[Continuous-time dynamical system]
    \label{def:ct-dynsyst}
    A dynamical system on~$\reals^n$ may be defined by a function
    \begin{equation}
        \mapa \colon \reals^n \sto \reals^n.
    \end{equation}
    A trajectory of a dynamical system is a function~$\stylemaps{x}\colon \reals \sto \reals^n$ such that
    \begin{equation}
        \dot{\stylemaps{x}}(t) = \mapa(\stylemaps{x}(t)).
    \end{equation}
    We use the notation~$\dot{\stylemaps{x}}$ to abbreviate~$\dd \stylemaps{x} / \dd t$.
\end{definition}

Suppose that we are dealing with dynamical systems such that for any point~$x_0$, there is exactly one trajectory beginning at~$x_0$.
(For this we need to put reasonable constraints on the function~$\mapa$.)
\todotextjira{554}{\alphubel: @Andrea: spell out some simple sufficient constraint (smooth?)}

We can then ask the following: given a point~$x$, where would its trajectory be after~$\delta$?
This question induces a family of functions~$\stylemaps{T_\delta}$, called transition functions.
For each particular~$\delta$, we have a function
\begin{equation}
    \stylemaps{T_{\delta}}\colon \reals^n \sto  \reals^n
\end{equation}
that maps a point to its position~$\delta$ in the future.

We can spot here a \SY{semigroup} structure.
Suppose we want to know the position of a point~$\delta_1 + \delta_2$
in the future.
We can take~$\stylemaps{T_{\delta_1}}$ and compose it with~$\stylemaps{T_{\delta_2}}$; or take directly~$\stylemaps{T_{\delta_1 + \delta_2}}$.
By construction, we will have that
\begin{equation}
    \label{eq:transition-property}
    \stylemaps{T_{\delta_1 + \delta_2}} = \stylemaps{T_{\delta_1}} \mtimes \stylemaps{T_{\delta_2}}.
\end{equation}
We can also easily prove associativity:
\begin{equation}
    \begin{aligned}
        \stylemaps{T_{\delta_1}}\mtimes (\stylemaps{T_{\delta_2}}\mtimes \stylemaps{T_{\delta_3}}) & =\stylemaps{T_{\delta_1}}\mtimes \stylemaps{T_{\delta_2+\delta_3}} \\
                                                                                                   & =\stylemaps{T_{\delta_1+\delta_2+\delta_3}} \\
                                                                                                   & =\stylemaps{T_{\delta_1+\delta_2}}\mtimes \stylemaps{T_{\delta_3}} \\
                                                                                                   & =(\stylemaps{T_{\delta_1}}\mtimes \stylemaps{T_{\delta_2}})\mtimes \stylemaps{T_{\delta_3}}.
    \end{aligned}
\end{equation}
%
This shows that the set of transition functions for a particular system with the operation of function composition form a \SY{semigroup}.

This \SY{semigroup} is a \SY{monoid} because there is an identity.
The identity is~$\stylemaps{T_0}$, the map that tells us what happens after~$0$ seconds.
That is~$\idmon_{\reals^n}$, the identity on~$\reals^n$.
To show that~$\stylemaps{T_0} = \idmon_{\reals^n}$ is an identity, we can fix any~$\delta$ and substituting in \cref{eq:transition-property} we have
\begin{equation}
    \begin{aligned}
        \stylemaps{T_{\delta + 0}} & = \stylemaps{T_{\delta}} \mtimes \stylemaps{T_{0}} \\
        =                          & \stylemaps{T_{\delta}}.
    \end{aligned}
\end{equation}

\showslides{
    \begin{forslides}
        \begin{equation}
            \label{eq:example-reals-plus}
            \realswithplusmonoid
        \end{equation}
        %
        \begin{equation}
            \label{eq:example-reals-mult}
            \tupp{\reals, \cdot}
        \end{equation}
        %
        \begin{equation}
            \label{eq:example-reals-min}
            \tupp{\reals, \min}
        \end{equation}
        %
        \begin{equation}
            \label{eq:example-reals-max}
            \tupp{\reals, \max}
        \end{equation}
        %
        \begin{equation}
            \label{eq:example-nats-plus}
            \tupp{\natnumbers, +}
        \end{equation}
        %
        \begin{equation}
            \label{eq:example-nats-mult}
            \tupp{\natnumbers, \cdot}
        \end{equation}
        %
        \begin{equation}
            \label{eq:example-nats-min}
            \tupp{\natnumbers, \min}
        \end{equation}
        %
        \begin{equation}
            \label{eq:example-nats-max}
            \tupp{\natnumbers, \max}
        \end{equation}
        %
        \begin{equation}
            \label{eq:example-nats21-plus}
            \tupp{ \makeset{x\setin\natnumbers: x \geq 2021 }, +}
        \end{equation}
        %
        \begin{equation}
            \label{eq:example-nats21-mult}
            \tupp{ \makeset{x\setin\natnumbers: x \geq 2021 }, \cdot}
        \end{equation}
        \begin{equation}
            \label{eq:example-nats21-min}
            \tupp{ \makeset{x\setin\natnumbers: x \geq 2021 }, \min}
        \end{equation}
        \begin{equation}
            \label{eq:example-nats21-max}
            \tupp{ \makeset{x\setin\natnumbers: x \geq 2021 }, \max}
        \end{equation}
        \begin{equation}
            \label{eq:example-nats22-plus}
            \tupp{ \makeset{x\setin\natnumbers: x \geq 2022 }, +}
        \end{equation}
        %
        \begin{equation}
            \label{eq:example-nats22-mult}
            \tupp{ \makeset{x\setin\natnumbers: x \geq 2022 }, \cdot}
        \end{equation}
        \begin{equation}
            \label{eq:example-nats22-min}
            \tupp{ \makeset{x\setin\natnumbers: x \geq 2022 }, \min}
        \end{equation}
        \begin{equation}
            \label{eq:example-nats22-max}
            \tupp{ \makeset{x\setin\natnumbers: x \geq 2022 }, \max}
        \end{equation}
        %
        \begin{equation}
            \label{eq:example-monoid-reals-plus-zero}
            \tupp{\reals, {{+}}, 0}
        \end{equation}
        %
        \begin{equation}
            \label{eq:example-monoid-reals-mult-one}
            \tupp{\reals, {{\cdot}}, 1}
        \end{equation}
        %
        \begin{equation}
            \label{eq:example-monoid-nats-plus-zero}
            \tupp{\natnumbers, {{+}}, 0}
        \end{equation}
        %
        \begin{equation}
            \label{eq:example-monoid-nats-mult-one}
            \tupp{\natnumbers, \cdot, 1}
        \end{equation}
        %
        \begin{equation}
            \label{eq:example-monoid-nats-max-zero}
            \tupp{\natnumbers, \max, 0}
        \end{equation}
    \end{forslides}
}
