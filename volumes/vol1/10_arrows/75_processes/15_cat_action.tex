% !TEX root = chapter-standalone.tex

\section{Semicategory actions}
\label{sec:action-of-a-category}

\linkvideo{spring2021-actions:semi-cat-actions} % Semi-category action

In this section we generalize from actions of a \SY{semigroup} to actions of a \SY{semicategory}, using the example of Moore machines acting on signal sequences.

To motivate our story, let us first consider Moore machines of the form
\begin{equation}
    \tup{\prinL,\prstL,\prinL,\prdyn,\prreadout,\prstart}
\end{equation}
where the input and output sets are equal.
In other words, we are considering the set~$\HomSet{\Moore}{\prinL}{\prinL}$, which is a \SY{semigroup} under morphism composition.

In \cref{sec:Moore-acting-on-sequences} we defined a standard action which associates to every morphism~$\mora \setin \HomSet{\Moore}{\prinL}{\prinL}$ a function
\begin{equation}
    \act_{\mora} \colon \streamsof{\prinL} \to \streamsof{\prinL}.
\end{equation}
This action defines a function
\begin{equation}
    \funmorspace{\act} \colon  \HomSet{\Moore}{\prinL}{\prinL} \to \End (\streamsof{\prinL})
\end{equation}
where
\begin{equation}
    \funmorspace{\act}(\mora) = \act_{\mora}.
\end{equation}
And this function~$\funmorspace{\act}$ is in fact a \SY{semigroup morphism}, and so a \SY{semigroup} action, since we proved in \cref{prop:moore-action-is-a-morphism} that
\begin{equation}
    \act_{\morab} = \act_\mora \mthen \act_\morb.
\end{equation}
(Compare with \cref{def:semigroup-cov-action} of \SY{semigroup} action.)

Now let us consider the general situation of Moore machines acting on signals.
Given any \SY{Moore machine} of the general form
\begin{equation}
    \mora = \tup{\prinL,\prstL,\proutL,\prdyn,\prreadout,\prstart}
\end{equation}
(the input and output spaces are no longer necessarily equal) we again have an associated function on signals
\begin{equation}
    \act_{\mora} \colon \streamsof{\prinL} \to \streamsof {\proutL}.
\end{equation}
We can assemble this data as a family of functions (all which we call~$\funmorspace{\act}$)
\begin{equation}
    \label{eq:moore-action-becoming-a-functor}
    \funmorspace{\act} \colon  \HomSet{\Moore}{\prinL}{\proutL} \to \HomSet{\Set}{\streamsof\prinL}{\streamsof\proutL},
\end{equation}
where~$\prinL$ and~$\proutL$ range over all objects of~$\Moore$.
Or, if you will,
\begin{equation}
    \funmorspace{\act} \colon \Mor_\Moore \to \Mor_\Set.
\end{equation}
From \cref{prop:moore-action-is-a-morphism} we have that this function is compatible with the composition operations in~$\Moore$ and~\Set:
\begin{equation}
    \label{eq:moore-action-functor-and-composition}
    \funmorspace{\act}(\morab) = \funmorspace{\act}(\mora) \mthen \funmorspace{\act}(\morb).
\end{equation}

Note that the sets~$\streamsof\prinL$ and~$\streamsof\proutL$ involved in the right-hand side of \cref{eq:moore-action-becoming-a-functor} depend on the objects~$\prinL$ and~$\proutL$ on the left-hand side.
We will encode this also with a function
\begin{equation}
    \defmapcomma{\funobspace{\act}}
    {\Obof{\Moore}}
    {\to}
    {\Obof{\Set}}
    {\prinL}
    {\streamsof\prinL}
\end{equation}
in which case \cref{eq:moore-action-becoming-a-functor} becomes
\begin{equation}
    \label{eq:moore-action-as-a-functor}
    \funmorspace{\act} \colon  \HomSet{\Moore}{\prinL}{\proutL} \sto \HomSet{\Set}{ \funobspace{\act}\prinL}{\funobspace{\act}\proutL}.
\end{equation}
%
In summary, we have reformulated \SY{Moore machine} actions as consisting of a pair of functions
\begin{equation}
    \funmorspace{\act} \colon \Mor_\Moore \sto \Mor_\Set \qquad \text{ and } \qquad \funobspace{\act} \colon \Obof{\Moore} \sto \Obof{\Set}
\end{equation}
which work together as in \cref{eq:moore-action-as-a-functor} and such that~$\funmorspace{\act}$ is compatible with composition as in \cref{eq:moore-action-functor-and-composition}.

Now we formalize this situation as a general definition.

\begin{ctdefinition}[Semicategory action]
    \label{def:semicategory-action}
    A \maindef{semicategory action} of a \SY{semicategory}~\CatC is

    \constit
    \begin{itemize}
        \item A map~$\funobspace{\act} \colon \Obof{\CatC} \sto \Obof{\Set}$;
        \item A map~$\funmorspace{\act} \colon \Mor_\CatC \sto \Mor_\Set$ such that
              \begin{equation}
                  \funmorspace{\act} \colon  \HomSet{\CatC}{\Obja}{\Objb} \to \HomSet{\Set}{ \funobspace{\act}(\Obja)}{\funobspace{\act}(\Objb)}
              \end{equation}
              for all objects~$\Obja, \Objb \setin \Obof{\CatC}$.
    \end{itemize}

    \condit

    \begin{itemize}
        \item For all composable morphisms $\mora$ and $\morb$ it holds that:
              \begin{equation}
                  \funmorspace{\act}(\morab) = \funmorspace{\act}(\mora) \mthen \funmorspace{\act}(\morb).
              \end{equation}
    \end{itemize}
\end{ctdefinition}

The compatibility of the action with composition is illustrated in \cref{fig:semicat_ac_comm}.

\begin{figure}[h!]
    \centering
    \includesag{semicat_ac_comm}
    \caption{}
    \label{fig:semicat_ac_comm}
\end{figure}

For reference, let us also fix the following definition.

\begin{definition}[Standard action of Moore machines]
    \label{def:moore-standard-action-on-sequences}
    The \maindef{standard action of Moore machines} on sequences is given by
    \begin{equation}
        \defmapcomma{\funobspace{\act}}
        {\Obof{\Moore}}
        {\to}
        {\Obof{\Set}}
        {\prinL}
        {\streamsof\prinL}
    \end{equation}
    on the level of objects, and on the level of morphisms, the functions
    \begin{equation}
        \funmorspace{\act} \colon  \HomSet{\Moore}{\prinL}{\proutL} \to \HomSet{\Set}{\streamsof\prinL }{\streamsof\proutL}
    \end{equation}
    are defined via the recursion equations
    \begin{equation}
        \begin{cases}
            \prsteln{k+1} = \prdyn_\mora(\prineln{k} \tupconcat \prsteln{k}) \\
            \prouteln{k}   = \prreadout_\mora(\prsteln{k})
        \end{cases}
    \end{equation}
    as in \cref{sec:Moore-acting-on-sequences}.
\end{definition}

\showslides{

    \begin{forslides}

        \begin{equation}
            \label{eq:cat-mora}
            \catacMor(\mora)
        \end{equation}
        \begin{equation}
            \label{eq:cat-morb}
            \catacMor(\morb)
        \end{equation}
        \begin{equation}
            \label{eq:cat-morab}
            \catacMor(\morab)
        \end{equation}
        \begin{equation}
            \label{eq:catC}
            \CatC
        \end{equation}
        \begin{equation}
            \label{eq:sets}
            \Set
        \end{equation}
        %
        \begin{equation}
            \label{eq:signal}
            \styleobj{s}
        \end{equation}
        %
        \begin{equation}
            \label{eq:signal-apply}
            \act(\mora, \styleobj{s})
        \end{equation}
        %
        \begin{equation}
            \label{eq:morab}
            \morab
        \end{equation}
        %
        \begin{equation}
            \label{eq:mora}
            \mora
        \end{equation}
        %
        \begin{equation}
            \label{eq:morb}
            \morb
        \end{equation}
        %
        \begin{equation}
            \label{eq:mora-prdyn}
            \prdyn_{\mora}
        \end{equation}
        %
        \begin{equation}
            \label{eq:mora-prst}
            \prst_{\mora}
        \end{equation}
        %
        \begin{equation}
            \label{eq:mora-prin}
            \prin_{\mora}
        \end{equation}
        %
        \begin{equation}
            \label{eq:mora-prout}
            \prout_{\mora}
        \end{equation}
        %
        \begin{equation}
            \label{eq:morb-prst}
            \prst_{\morb}
        \end{equation}
        %
        \begin{equation}
            \label{eq:morb-prin}
            \prin_{\morb}
        \end{equation}
        %
        \begin{equation}
            \label{eq:morb-prout}
            \prout_{\morb}
        \end{equation}
        %
        \begin{equation}
            \label{eq:morab-prst}
            \prst_{\morab}
        \end{equation}
        %
        \begin{equation}
            \label{eq:morab-prin}
            \prin_{\morab}
        \end{equation}
        %
        \begin{equation}
            \label{eq:morab-prout}
            \prout_{\morab}
        \end{equation}
        %
        \begin{equation}
            \label{eq:gen-prst}
            \prst
        \end{equation}
        %
        \begin{equation}
            \label{eq:gen-prin}
            \prin
        \end{equation}
        \begin{equation}
            \label{eq:gen-prout}
            \prout
        \end{equation}
        \begin{equation}
            \label{eq:moore-start}
            \prstart \setin \prst
        \end{equation}
        %
        \begin{equation}
            \label{eq:prgen-u}
            u\colon \natnumbers \to \prgen
        \end{equation}
        %
        \begin{equation}
            \label{eq:prgen-y}
            y\colon \natnumbers \to \prgen
        \end{equation}
        %
        \begin{equation}
            \label{eq:prgen-u-1}
            u\colon \natnumbers \to \prin
        \end{equation}
        %
        \begin{equation}
            \label{eq:prgen-y-1}
            y\colon \natnumbers \to \prout
        \end{equation}
        %
        \begin{equation}
            \label{eq:prgen-u-2}
            u\colon \prin
        \end{equation}
        %
        \begin{equation}
            \label{eq:Z}
            \stylesets{Z}
        \end{equation}
        %
        \begin{equation}
            \label{eq:Za}
            \catacOb{\stylesets{Z}}
        \end{equation}
        %
        \begin{equation}
            \label{eq:Ua}
            \catacOb{\prin}
        \end{equation}
        %
        \begin{equation}
            \label{eq:Ya}
            \catacOb{\prout}
        \end{equation}
        %
        \begin{equation}
            \label{eq:prgen-y-2}
            y\colon \listsof  \prout
        \end{equation}
        %
        \begin{equation}
            \label{eq:prgen}
            \prgen
        \end{equation}
        %
        \begin{equation}
            \label{eq:now1}
            \act(\morb, \act(\mora, \styleobj{s}))
        \end{equation}
        %
        \begin{equation}
            \label{eq:now2}
            \act(\morab, \styleobj{s})
        \end{equation}
        %
        \begin{equation}
            \label{eq:ev-sign}
            u\colon \listsof{(\natnumbers \cartprod \prin)}
        \end{equation}
        %
        \begin{equation}
            \label{eq:ev-sign2}
            y\colon \listsof{(\natnumbers \cartprod \prout)}
        \end{equation}
        \begin{equation}
            \label{eq:phi-moore}
            {\catacOb_{\Moore}}\colon{\Obja}\longmapsto{(\natnumbers \to \Obja)}
        \end{equation}
        \begin{equation}
            \label{eq:phi-more}
            {\catacOb_{\More}}\colon{\Obja}\longmapsto{\listsof \Obja}
        \end{equation}
    \end{forslides}
}
