% !TEX root = chapter-standalone.tex

\section{Semicategory actions}
\label{sec:action-of-a-category}

\linkvideo{spring2021-actions:semi-cat-actions} % Semi-category action

\todotextjira{59}{@Andrea: Enrich text, using descriptions from lecture}

In this section we generalize from actions of a semigroup to actions of a semicategory, using the example of Moore machines acting on signal sequences.

To motivate our story, let us first consider Moore machines of the form 
$$\tup{\prinL,\prstL,\prinL,\prdyn,\prreadout,\prstart}$$ 
where the input and output sets are equal. In other words, we are considering the set $\HomSet{\Moore}{\prinL}{\prinL}$, which is a semigroup under morphism composition.   

In \cref{sec:Moore-acting-on-sequences} we defined a standard action which associates to every morphism $\mora \in \HomSet{\Moore}{\prinL}{\prinL}$ a function 
\begin{equation}
\act_{\mora} \colon {\prinL}^\natnumbers \to {\prinL}^\natnumbers.
\end{equation}
This action defines a function 
\begin{equation}
\funmor{\act} \colon  \HomSet{\Moore}{\prinL}{\prinL} \to \End ({\prinL}^{\natnumbers})
\end{equation}
where 
$$
\funmor{\act}(\mora) = \act_{\mora}.
$$
And this function $\funmor{\act}$ is in fact a semigroup morphism, and so a semigroup action, since we proved in \cref{prop:moore-action-is-a-morphism} that
\begin{equation}
\act_{\mora \mthen \morb} = \act_\mora \mthen \act_\morb.
\end{equation}
(Compare with \cref{def:semigroup-cov-action} of semigroup action.)

Now let us consider the general situation of Moore machines acting on signals. Given any Moore machine of the general form 
$$\mora = \tup{\prinL,\prstL,\proutL,\prdyn,\prreadout,\prstart}$$ 
(the input and output spaces are no longer necessarily equal) we again have an associated function on signals
\begin{equation}
\act_{\mora} \colon {\prinL}^\natnumbers \to {\proutL}^\natnumbers.
\end{equation}
We can assemble this data as a family of functions (all which we call $\funmor{\act}$)
\begin{equation}
\label{eq:moore-action-becoming-a-functor}
\funmor{\act} \colon  \HomSet{\Moore}{\prinL}{\proutL} \to \HomSet{\Set}{\prinL^{\natnumbers}}{\proutL^{\natnumbers}},
\end{equation}
where $\prinL$ and $\proutL$ range over all objects of $\Moore$. Or, if you will, 
$$
\funmor{\act} \colon \Mor_\Moore \to \Mor_\Set.
$$
From \cref{prop:moore-action-is-a-morphism} we have that this function is compatible with the composition operations in $\Moore$ and $\Set$: 
\begin{equation}
\label{eq:Moore-action-functor-and-composition}
\funmor{\act}(\mora \then \morb) = \funmor{\act}(\mora) \then \funmor{\act}(\morb). 
\end{equation}
 

Note that the sets $\prinL^{\natnumbers}$ and $\proutL^{\natnumbers}$ involved in the right hand side of \cref{eq:Moore-action-becoming-a-functor} depend on the objects $\prinL$ and $\proutL$ on the left-hand side. We will encode this also with a function 
\begin{equation}
\funob{\act} \colon \Ob_{\Moore} \to \Ob_{\Set}, \prinL \mapsto \prinL^\natnumbers,
\end{equation}
in which case $\cref{eq:moore-action-becoming-a-functor}$ becomes
\begin{equation}
\label{eq:moore-action-as-a-functor}
\funmor{\act} \colon  \HomSet{\Moore}{\prinL}{\proutL} \to \HomSet{\Set}{ \funob{\act}(\prinL)}{\funob{\act}(\proutL)}.
\end{equation}

In summary, we have reformulated Moore machine actions as consisting of a pair of functions 
\begin{equation}
\funmor{\act} \colon \Mor_\Moore \to \Mor_\Set \qquad \text{ and } \qquad \funob{\act} \colon \Ob_{\Moore} \to \Ob_{\Set}
\end{equation}
which work together as in \cref{eq:moore-action-as-a-functor} and such that $\funmor{\act}$ is compatible with composition as in $\cref{eq:moore-action-functor-and-composition}$. 

Now we formalize this situation as a general definition. 

\begin{ctdefinition}[Semicategory action]
    \label{def:semicategory-action}
    A \emph{semicategory action} of a semicategory~$\CatC$ is
    
    \constit
    \begin{itemize}
        \item a map $\funob{\act} \colon \Ob_{\CatC} \to \Ob_{\Set}$,
        \item a map~$\funmor{\act} \colon \Mor_\CatC \to \Mor_\Set$ such that 
        \begin{equation}
\funmor{\act} \colon  \HomSet{\CatC}{\Obja}{\Objb} \to \HomSet{\Set}{ \funob{\act}(\Obja)}{\funob{\act}(\Objb)}
        \end{equation}
        for all objects $\Obja, \Objb \in \Ob_{\CatC}$. 
    \end{itemize}

    
    \condit
    
    \begin{itemize}
   \item for all composable morphisms $\mora$ and $\morb$ holds: 
   \begin{equation}
\funmor{\act}(\mora \then \morb) = \funmor{\act}(\mora) \then \funmor{\act}(\morb). 
    \end{equation}
    \end{itemize}
\end{ctdefinition}

The compatibility of the action with composition is illustrated in \cref{fig:semicat_ac_comm}. 

\begin{figure}[h!]
\label{fig:semicat_ac_comm}
    \begin{center}
        \includesag{semicat_ac_comm}
    \end{center}
    \caption{}
\end{figure}


\subsection{Different actions of Moore machines}

Let us discuss examples of actions of Moore machines that are different than the standard actions discussed in detail in \cref{sec:Moore-acting-on-sequences}. 

Recall that, given a Moore machine $\mora = \tup{\prinL_\mora,\prstL_\mora,\proutL_\mora,\prdyn_\mora,\prreadout_\mora,\prstart_\mora}$, the standard action defined a function 
\begin{equation}
{\prinL_\mora}^\natnumbers \to {\proutL_\mora}^\natnumbers
\end{equation}
via solving the recursion equations 
\begin{equation}
\label{eq:moore-recursion-once-again}
    \begin{cases}
        x_{k+1} = \prdyn_\mora(u_k, x_k) \\
        y_{k}   = \prreadout_\mora(x_{k}).
    \end{cases}
\end{equation}

One way define other actions is by changing \cref{eq:moore-recursion-once-again} to some other recipe. It is necessary then to check that the resulting action really satisfies the properties of \cref{def:semicategory-action}. 

For example, consider the recursion equations
\begin{equation}
\label{eq:moore-new-recursion-equations}
    \begin{cases}
        x_{k+1} = \prdyn_\mora(u_k, x_k) \\
        \tilde x_{k+1} = \prdyn_\mora(x_{k+1}, \tilde x_k) \\
        y_{k}   = \prreadout_\mora(\tilde x_{k}).
    \end{cases}
\end{equation}
Given  $\mora = \tup{\prinL_\mora,\prstL_\mora,\proutL_\mora,\prdyn_\mora,\prreadout_\mora,\prstart_\mora}$ we can use these to define an action of $\mora$ by interpreting the variables $x_k$ and $\tilde x_k$, with $k \in \natnumbers$, both as denoting elements of $\prstL$, and setting $x_0 = \tilde x_0 = \prstart_\mora$. The rest is analogous to how we defined the standard action: given a sequence $u = u_0, u_1, u_2, \dots$ we can iteratively compute from it sequences $x = x_0, x_1, x_2, \dots $ and $\tilde x = \tilde x_0, \tilde x_1, \tilde x_2, \dots$, and then the output sequence $y = y_0, y_1, y_2, \dots $ is defined by $y_{k}   = \prreadout_\mora(\tilde x_{k})$

\todotext{insert example here which links to the example given when first describing the standard action of a Moore machine}

\todotext{insert exercises here}




\

\

\


\showslides{

    \begin{forslides}

        \begin{equation}
            \label{eq:cat-mora}
            \catacMor(\mora)
        \end{equation}
        \begin{equation}
            \label{eq:cat-morb}
            \catacMor(\morb)
        \end{equation}
        \begin{equation}
            \label{eq:cat-morab}
            \catacMor(\mora\mthen\morb)
        \end{equation}
        \begin{equation}
            \label{eq:catC}
            \CatC
        \end{equation}
        \begin{equation}
            \label{eq:sets}
            \Set
        \end{equation}
        %
        \begin{equation}
            \label{eq:signal}
            \styleobj{s}
        \end{equation}
        %
        \begin{equation}
            \label{eq:signal-apply}
            \act(\mora, \styleobj{s})
        \end{equation}
        %
        \begin{equation}
            \label{eq:morab}
            \mora \mthen \morb
        \end{equation}
        %
        \begin{equation}
            \label{eq:mora}
            \mora
        \end{equation}
        %
        \begin{equation}
            \label{eq:morb}
            \morb
        \end{equation}
        %
        \begin{equation}
            \label{eq:mora-prdyn}
            \prdyn_{\mora}
        \end{equation}
        %
        \begin{equation}
            \label{eq:mora-prst}
            \prst_{\mora}
        \end{equation}
        %
        \begin{equation}
            \label{eq:mora-prin}
            \prin_{\mora}
        \end{equation}
        %
        \begin{equation}
            \label{eq:mora-prout}
            \prout_{\mora}
        \end{equation}
        %
        \begin{equation}
            \label{eq:morb-prst}
            \prst_{\morb}
        \end{equation}
        %
        \begin{equation}
            \label{eq:morb-prin}
            \prin_{\morb}
        \end{equation}
        %
        \begin{equation}
            \label{eq:morb-prout}
            \prout_{\morb}
        \end{equation}
        %
        \begin{equation}
            \label{eq:morab-prst}
            \prst_{\mora\mthen\morb}
        \end{equation}
        %
        \begin{equation}
            \label{eq:morab-prin}
            \prin_{\mora\mthen\morb}
        \end{equation}
        %
        \begin{equation}
            \label{eq:morab-prout}
            \prout_{\mora\mthen\morb}
        \end{equation}
        %
        \begin{equation}
            \label{eq:gen-prst}
            \prst
        \end{equation}
        %
        \begin{equation}
            \label{eq:gen-prin}
            \prin
        \end{equation}
        \begin{equation}
            \label{eq:gen-prout}
            \prout
        \end{equation}
        \begin{equation}
            \label{eq:moore-start}
            \prstart \setin \prst
        \end{equation}
        %
        \begin{equation}
            \label{eq:prgen-u}
            u\colon \natnumbers \to \prgen
        \end{equation}
        %
        \begin{equation}
            \label{eq:prgen-y}
            y\colon \natnumbers \to \prgen
        \end{equation}
        %
        \begin{equation}
            \label{eq:prgen-u-1}
            u\colon \natnumbers \to \prin
        \end{equation}
        %
        \begin{equation}
            \label{eq:prgen-y-1}
            y\colon \natnumbers \to \prout
        \end{equation}
        %
        \begin{equation}
            \label{eq:prgen-u-2}
            u\colon \prin
        \end{equation}
        %
        \begin{equation}
            \label{eq:Z}
            \stylesets{Z}
        \end{equation}
        %
        \begin{equation}
            \label{eq:Za}
            \catacOb{\stylesets{Z}}
        \end{equation}
        %
        \begin{equation}
            \label{eq:Ua}
            \catacOb{\prin}
        \end{equation}
        %
        \begin{equation}
            \label{eq:Ya}
            \catacOb{\prout}
        \end{equation}
        %
        \begin{equation}
            \label{eq:prgen-y-2}
            y\colon \listsof  \prout
        \end{equation}
        %
        \begin{equation}
            \label{eq:prgen}
            \prgen
        \end{equation}
        %
        \begin{equation}
            \label{eq:now1}
            \act(\morb, \act(\mora, \styleobj{s}))
        \end{equation}
        %
        \begin{equation}
            \label{eq:now2}
            \act(\mora\mthen\morb, \styleobj{s})
        \end{equation}
        %
        \begin{equation}
            \label{eq:ev-sign}
            u\colon \listsof{(\natnumbers \cartprod \prin)}
        \end{equation}
        %
        \begin{equation}
            \label{eq:ev-sign2}
            y\colon \listsof{(\natnumbers \cartprod \prout)}
        \end{equation}
        \begin{equation}
            \label{eq:phi-moore}
            {\catacOb_{\Moore}}\colon{\Obja}\longmapsto{(\natnumbers \to \Obja)}
        \end{equation}
        \begin{equation}
            \label{eq:phi-more}
            {\catacOb_{\More}}\colon{\Obja}\longmapsto{\listsof \Obja}
        \end{equation}
    \end{forslides}
}
