% !TEX root = chapter-standalone.tex

\section{Introduction to systems}
\todojira{624}{fill the whole part}

\todotext{Maybe include several examples throughout this intro to liven up the text and make it more concrete and engineering flavored}

The term ``system'' is not a precise mathematical term for us, but rather an intuitive concept that relates directly to modeling in engineering. We will think of systems as having input and output ports with which it can interact with other systems (or its broader environment), and that a system in some way establishes a relationship between input and output signals. This relationship might be a deterministic, causal relationship -- inputs determining outputs -- or it might be another form of lawfulness.

\subsection{External and internal points of view}

Sometimes we will think of systems as if they are ``black boxes": that is, as if we don't know anything about their inner workings, and all we care about is their external behavior in terms of which inputs are related to which outputs. Other times we will focus on the inner workings of systems and different ways to model these mathematically.

\subsection{Composing systems}

No matter whether we are looking `inside' of systems or are just considering their external behavior, a key feature of our understanding of the term system is that systems make be composed together. First of all, for serial composition, this means that the output of one system is taken as the input for the next systems. Furthermore, we will also formalize notions of parallel composition of systems, and of feedback.


\section{System behaviors}

\todotext{Talk here briefly about the distinction between formal specifications or parametrizations of systems versus behaviors of systems; perhaps use Moore machines as an example}

Recall from \cref{sec:moore-machines} that a Moore machine is specified by an input set $\prin$, an output set $\prout$, a state space set $\prst$, and two functions
\begin{equation}\label{eq:moore-specification}
    \begin{cases}
        \prdyn \colon \prin \cartprod \prst \sto \prst, \\
        \prreadout \colon \prst \sto \prout.
    \end{cases}
\end{equation}

In \cref{sec:action-of-a-category} we saw how, given an initial state $x_0 \in \prst$, a Moore machine acts on sequences of inputs, mapping these to sequences of outputs. 

For example, if $u_0, u_1, u_2, ... $ is a sequence of inputs, then the corresponding sequence of outputs $y_0, y_1, y_2, ... $ of \cref{eq:moore-specification} is dictated by the recursion relations
\begin{align}
x_{k+1} &= \prdyn(x_k, u_k) \\
y_{k+1} &= \prreadout(x_{k+1}),
\end{align}
with $k \in \natnumbers$. 

In other words, given $x_0 \in \prst$, we can map the Moore machine \label{eq:moore-again} to a function $\prin^\natnumbers \to \prout^\natnumbers$. We will think of this function as the `external behavior' of the Moore machine, because it encodes what is externally observable to us in terms of how the Moore machine related inputs to outputs. In other words, in a concrete application we might not know a precise model of a Moore machine of the form \cref{eq:moore-specification}, but we can still observe what it does when we feed it inputs. And sometimes this external behavior is all we care about, in which case we treat the Moore machine as a black box. 

\subsection{Modeling behavior}

We will now make a general-purpose formalization of system behaviors. 

In the example above with Moore machines, we said its behavior was a function $\prin^\natnumbers \to \prout^\natnumbers$. Here the set $\natnumbers$ played the role of time: each $k \in \natnumbers$ corresponded to a time step. In the following, we allow any model of time which is a totally ordered set: $\Time = \tup{\Time, \leq}$. 

Then, when want to talk about discrete-time signals, natural choices for $\Time$ might be $\Time = \natnumbers$ or $\Time = \wnumbers$. Similarly, if we want to talk about continuous time systems, we might choose $\Time = \reals$.
And when we want to talk about event-based systems, we can choose $\Time$ to consist of a set of possible events, ordered by their sequence of occurence.


Given a set $\Obja$, we will consider the set $\Obja^\Time$ of functions $\Time \to \Obja$ as the set of time-dependent signals taking values in the signal space $\Obja$. Then a system behavior is, for example, a function $\styleobj{U}^\Time \to \styleobj{Y}^\Time$. For more flexibility in our formalism, we will also allow behaviors which are \emph{relations} $\styleobj{U}^\Time \to \styleobj{Y}^\Time$. 

In other words, in general, the externally observable behavior of a system is a relation between input signals and output signals.

\begin{definition}
    Let $\Obja$ and $\Objb$ be sets.
    An \emph{input-output behavior}, with input signal space $\Obja$ and output signal space $\Objb$, is a relation
    \begin{equation}
        \relA \subseteq \Obja^\Time \times \Objb^\Time.
    \end{equation}
\end{definition}

\begin{definition}
    Fix a totally ordered set $\Time = \tup{\Time, \leq}$.
    The category $\textbf{Bh}_\Time$ of input-output behaviors is the category where:
    \begin{enumerate}
        \item Objects consist of all sets of the form $\Obja^\Time$, ranging over all sets $\Obja$.
        \item Morphisms from $\Obja^\Time$ to $\Objb^\Time$ are relations from $\Obja^\Time$ to $\Objb^\Time$:
              \begin{equation}
                  \HomSet{\textbf{Bh}_\Time}{\Obja^\Time}{\Objb^\Time} = \powerset (\Obja^\Time \times \Objb^\Time).
              \end{equation}
        \item The identity morphism at an object $\Obja^\Time$ is the usual identity relation from $\Obja^\Time$ to itself.
        \item Composition is the usual composition of relations.
    \end{enumerate}
\end{definition}

Sometimes we will wish to consider signal spaces $\Obja$ which are vector spaces over some field $\field$.
Then the set $\Obja^\Time$ naturally inherits a $\field$-vector space structure from $\Obja$, and we may consider input-output behaviors
\begin{equation*}
    \relA \subseteq \Obja^\Time \oplus \Objb^\Time
\end{equation*}
which are $\field$-linear relations.

\begin{definition}
    Fix a totally ordered set $\Time = \tup{\Time, \leq}$.
    The category $\textbf{LBh}_\Time$ of $\field$-linear input-output behaviors is the category where:
    \begin{enumerate}
        \item Objects consist of all $\field$-vector spaces of the form $\Obja^\Time$, ranging over all $\field$-vector spaces $\Obja$.
        \item Morphisms from $\Obja^\Time$ to $\Objb^\Time$ are linear subspaces of  $\Obja^\Time \oplus \Objb^\Time$.
        \item The identity morphism at an object $\Obja^\Time$ is the usual identity relation from $\Obja^\Time$ to itself (this is always $\field$-linear).
        \item Composition is the usual composition of relations.
    \end{enumerate}
\end{definition}

\subsection{Causal behaviors}

Given a signal $\ela \in \Obja^\Time$, we set the notation
\begin{equation}
    \ela \vert_{\leq t} :=  \ela \vert_{\{ s \in \Time \mid s \leq t\}}.
\end{equation}

\begin{definition}
    An input-output behavior $\relA \subseteq \Obja^\Time \times \Objb^\Time$ is \emph{causal} if for all~$\tup{\ela_1, \elb_1}$, $\tup{\ela_2, \elb_2} \in \relA$ holds:
    \begin{equation}
        \forall t \in \Time: \ela_1 \vert_{ \leq t} = \ela_2 \vert_{ \leq t} \  \Rightarrow \ \elb_1 \vert_{ \leq t} = \elb_2 \vert_{ \leq t}
    \end{equation}
\end{definition}

\todotext{Questions: If two composable input-output behaviors are causal, is their composition also causal?
    What if only one of them is causal?
    And various other related questions.
    .. }

\subsection{Time-invariance}

In this subsection we assume that $\Time = \tup{\Time, \leq}$ comes equipped with a semigroup structure $\tup{\Time, +}$ which is compatible with the total order: if $t \leq t'$ and $s \leq s'$, then $t + s \leq t' + s'$.

Fix an $s \in \Time$.
For any signal space $\Obja$, we define a shift function $\delta_s: \Obja^\Time \to \Obja^\Time$ by
\begin{equation}
    (\delta_s \ela)(t) := \ela(t + s).
\end{equation}

\begin{definition}
    An input-output behavior $\relA \subseteq \Obja^\Time \times \Objb^\Time$ is \emph{time-invariant} if
    \begin{equation}
        \forall s \in \Time: \tup{\ela, \elb} \in \relA  \ \Rightarrow \tup{\delta_s \ela, \delta_s \elb} \in \relA.
    \end{equation}
\end{definition}

\todotext{Questions: If two time-invariant input-output behaviors are causal, is their composition also causal?
    What if only one of them is causal?
    And various other related questions.
    .. }


\section{Specifying systems}

Let's consider some different examples of systems and ways of specifying them.

\subsection{Moore machines}



\subsection{Linear time-invariant dynamical systems}


\subsection{Linear time-invariant dynamical systems}


Typical a linear time-invariant dynamical system is typically specified by an input vector space $\prin$ and output set $\prout$


\subsection{Descriptor systems}

